# OpenSSL 拒绝服务漏洞（CVE-2022-0778）&&OpenSSL 跨大版本升级 - 往事已成昨天 - 博客园

> 原文：[`www.cnblogs.com/cherishthepresent/p/16806119.html`](https://www.cnblogs.com/cherishthepresent/p/16806119.html)

# OpenSSL 拒绝服务漏洞（CVE-2022-0778）&&OpenSSL 跨大版本升级

原创 demo 高 Console 2022-03-23 16:41**点击上方蓝字  关注我们**![图片](img/9aab169f78f627fe16df3c10d6e6a7a1.png)

### 【漏洞通告】OpenSSL 拒绝服务漏洞（CVE-2022-0778）

**一、漏洞描述**

### 漏洞综述(发布时间 2022-03-15)

| CVE   ID | CVE-2022-0778 | 时    间 | 2022-03-15 |
| 类    型 | Dos | 等    级 | 高危 |

### 01 漏洞详情

3 月 15 日，OpenSSL 官方发布安全公告，修复了 OpenSSL 版本 1.0.2、1.1.1 和 3.0 中的拒绝服务漏洞（CVE-2022-0778）。

 由于证书解析时使用的 BN_mod_sqrt() 函数存在一个错误，它会导致在非质数的情况下永远循环。可通过生成包含无效的显式曲线参数的证书来触发无限循环。由于证书解析是在验证证书签名之前进行的，因此任何解析外部提供的证书的程序都可能受到拒绝服务攻击。此外，当解析特制的私钥时(包含显式椭圆曲线参数)，也可以触发无限循环。

因此易受攻击的情况如下：

*   使用服务器证书的 TLS 客户端

*   使用客户端证书的 TLS 服务器

*   托管服务提供商从客户处获取证书或私钥

*   证书颁发机构解析来自订阅者的认证请求

*   任何其他解析 ASN.1 椭圆曲线参数的程序

此外，任何使用 BN_mod_sqrt()的其他应用程序，如果可以控制参数值，也会受到此漏洞影响。需要注意的是，任何需要证书中公钥的操作都会触发无限循环，特别是自签名的证书，在验证证书签名时会触发循环。

**影响范围**

OpenSSL 版本 1.0.2：1.0.2-1.0.2zc

OpenSSL 版本 1.1.1：1.1.1-1.1.1m

OpenSSL 版本 3.0：3.0.0、3.0.1

### 02 安全建议

目前此漏洞已经修复，建议受影响用户及时升级更新：

OpenSSL 1.0.2 用户应升级至 1.0.2zd（已停止支持）

OpenSSL 1.1.1 用户应升级至 1.1.1n

OpenSSL 3.0 用户应升级至 3.0.2

下载链接：

https://www.openssl.org/source/

ps：OpenSSL 1.0.2 和 OpenSSL 1.1.0 已停止支持（所以 1.0.2 系列请升级到 1.1.1n，本人 1.0.2k 与 1.0.2zc—>3.0.2 升级均失败）!

### 03 参考链接

https://www.openssl.org/news/secadv/20220315.txt

### 04 版本信息

| 版本 | 日期 | 修改内容 |
| V1.0 | 2022-03-16 | 首次发布 |

《秒针》DJ&圈妹&Boom boom：偷梦藏身如笨钟，我两手空空音乐：宝藏挖掘机![](img/6202f44b498b2d7e87c5f1eef5466c42.png)**二、漏洞升级**

## 01 查看 openssl 版本

openssl version

![图片](img/6078276cec694ab8a5e76c28112514f1.png)

## 02 下载指定版本的 openssl 软件并安装

OpenSSL 官网地址：https://www.openssl.org/source/

这里下载 openssl-1.1.1n 版本

https://www.openssl.org/source/openssl-1.1.1n.tar.gz

![图片](img/189ee54cee2c7b5f69d23ed50c94171c.png)

tar zxvf openssl-1.1.1n.tar.gz

cd openssl-1.1.1n

./config --prefix=/usr/local/openssl

make && make install  

mv /usr/bin/openssl /usr/bin/openssl.old

mv /usr/include/openssl /usr/include/openssl.old

ln -s /usr/local/openssl/bin/openssl/usr /bin/openssl

ln -s /usr/local/openssl/include/openssl /usr/include/openssl

echo "/usr/local/openssl/lib">>/etc/ld.so.conf  

ldconfig -v 

openssl version -a

![图片](img/e8269e3de265a2be8a3319e030eba01b.png)

ps：重启主机 ssh 连接正常！

** 往期推荐**

[内卷时代，IT 人求偶有多难？](http://mp.weixin.qq.com/s?__biz=MzUzODA4NjI0Mw==&mid=2247485066&idx=1&sn=87d9abebba0ba57203199082fa4f286e&chksm=fadc5886cdabd1904254e12b19a3c6b749da5971f6a36e425725380efbd505e1723243372570&scene=21#wechat_redirect)

[MySQL 集群之双主多从、读写分离项目](http://mp.weixin.qq.com/s?__biz=MzUzODA4NjI0Mw==&mid=2247484907&idx=1&sn=2eea833689e57522271fac35a99960c2&chksm=fadc5be7cdabd2f1a620787a8a6013489acf4b56d33e45dada60280c7730888ec0b1b275e707&scene=21#wechat_redirect)

[一次死锁导致 CPU 异常飘高的整个故障排查过程](http://mp.weixin.qq.com/s?__biz=MzUzODA4NjI0Mw==&mid=2247484698&idx=1&sn=28b5a2c448a4d84fd2ef371c3ced0621&chksm=fadc5b16cdabd200e5589449f236c5a4f5a52c92ce64cd9d71e5403215fa0e583751cdea6428&scene=21#wechat_redirect)

[“东数西算”是什么?](http://mp.weixin.qq.com/s?__biz=MzUzODA4NjI0Mw==&mid=2247485050&idx=1&sn=03f73c32277510145fcf2197313c32fa&chksm=fadc5876cdabd160c0091bd7371a789173566ce7f8597d96bc758b5ce839f2d22a62ef464bda&scene=21#wechat_redirect)

[男性结扎后，精液去了哪里？（蛋蛋会撑爆吗）](http://mp.weixin.qq.com/s?__biz=MzUzODA4NjI0Mw==&mid=2247484860&idx=1&sn=2eef2bac498f9745b5bda167980dbc67&chksm=fadc5bb0cdabd2a64da0b960ef5e183febebddb75cb3e375bbc1ef966c1e810fa0fa9674db01&scene=21#wechat_redirect)

【微语】

所有的好事发生之前，一定会有糟糕的经历先来折磨你。没有山穷水尽，哪来柳暗花明，没有万念俱灰，哪来绝处逢生。

![图片](img/35689886d368a8e0358e12b3e14f67a3.png)

点分享

点收藏

点点赞

点在看

文章已于 2022-03-23 修改阅读 53![](img/ab86fb49ee233a02783ae7ff25a2ec63.png)Console61 篇原创内容写下你的留言精选留言

*   ![](img/7e0bfc16ed1a8ce472a0c928c204ce69.png)䶮置顶明天试试，谢谢博主![[玫瑰]](../Images/e56861eac890bd80b0f6b96fc38ca072.png)![[愉快]](../Images/e56861eac890bd80b0f6b96fc38ca072.png)![](img/21f298e2bf0bfc854ff66105cd297723.png)Console(作者)客气了，祝试验成功！

已无更多数据