# Linux Polkit 权限提升漏洞预警（CVE-2021-4034） - 杨灏 - 博客园

> 原文：[`www.cnblogs.com/HByang/p/16422548.html`](https://www.cnblogs.com/HByang/p/16422548.html)

一、概要

　　近日，国外安全研究团队披露在 polkit 的 pkexec 程序中存在一处权限提升漏洞（CVE-2021-4034，亦称 PwnKit），攻击者通过在其默认配置中利用此漏洞实现用任何非特权用户获取易受攻击主机的完全 root 权限，目前漏洞 POC/EXP 已公开，风险较高。

　　Polkit（PolicyKit）是一个用于在类 Unix 操作系统中控制系统范围权限的组件。pkexec 是 Polkit 框架中的一部分，执行具有提升权限的命令，是 sudo 的替代方案。

参考链接：[`www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt`](https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt)

二、威胁级别

　　威胁级别：【严重】

　　（说明：威胁级别共四级：一般、重要、严重、紧急）

三、漏洞影响范围

　　影响版本：

　　漏洞影响 2009 年 5 月至今的所有 polkit 版本

　　由于 polkit 是系统的预装工具，所有存在 polkit 的 linux 系统均受影响（如：CentOS、Ubuntu、Debian、Redhat、Fedora、Gentoo、Mageia 等）

安全版本：

CentOS 系列：

*   CentOS 6：polkit-0.96-11.el6_10.2
*   CentOS 7：polkit-0.112-26.el7_9.1
*   CentOS 8.0：polkit-0.115-13.el8_5.1
*   CentOS 8.2：polkit-0.115-11.el8_2.2
*   CentOS 8.4：polkit-0.115-11.el8_4.2

Ubuntu 系列：

*   Ubuntu 21.10：policykit-1-0.105-31ubuntu0.1
*   Ubuntu 20.04 LTS：policykit-1-0.105-26ubuntu1.2
*   Ubuntu 18.04 LTS：policykit-1-0.105-20ubuntu0.18.04.6
*   Ubuntu 16.04 ESM：policykit-1-0.105-14.1ubuntu0.5+esm1
*   Ubuntu 14.04 ESM：policykit-1-0.105-4ubuntu3.14.04.6+esm1

Debian 系列：

*   Debian stretch：policykit-1 0.105-18+deb9u2
*   Debian buster：policykit-1 0.105-25+deb10u1
*   Debian bullseye：policykit-1 0.105-31+deb11u1
*   Debian bookworm,bullseye：policykit-1 0.105-31.1

四、漏洞处置

1、目前 RedHat、Ubuntu、Debian、SUSE 等各大 Linux 厂商均已发布补丁版本修复了该漏洞，请受影响的用户升级到安全版本：

　　RedHat；Ubuntu：USN-5252-1、USN-5252-2；Debian；SUSE；Fedora

　　手动升级命令参考如下，

　　Centos：

```
yum clean all && yum makecache

yum update polkit –y
```

　　升级完成后运行命令 rpm -qa polkit 查看版本信息

　　Ubuntu：

```
sudo apt-get update

sudo apt-get install policykit-1
```

　　升级完成后运行 dpkg -l policykit-1 查看版本信息

　　SUSE:

　　zypper restart polkit

　　2、若系统没有可用的补丁，可通过将 pkexec 中的 SUID-bit 删除进行临时规避，命令如：# chmod 0755 /usr/bin/pkexec