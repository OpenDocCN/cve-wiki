# Docker 容器逃逸漏洞 (CVE-2020-15257) - 渊渟岳 - 博客园

> 原文：[`www.cnblogs.com/dennyLee2025/p/14074613.html`](https://www.cnblogs.com/dennyLee2025/p/14074613.html)

## 漏洞详情

Docker 发布一个容器逃逸漏洞，攻击者利用该漏洞可以实现容器逃逸，提升特权并破坏主机。 containerd 使用的抽象套接字仅使用 UID 做验证，即任意 UID 为 0 的进程均可访问此 API。

当使用 docker run --net=host 拉起一个容器时，容器将获取宿主机的网络权限，此时可以访问 containerd 的 API，执行危险操作。

## 影响范围

containerd 1.2.x

containerd < 1.4.3

containerd < 1.3.9

可能还会有其他版本

## 修复方案

注意：安装升级前，请做好数据备份、快照和测试工作，防止发生意外

1\. 升级 containerd 至最新版本。

containerd >= 1.4.3

containerd >= 1.3.9

2\. 通过添加如 deny unix addr=@**的 AppArmor 策略禁止访问抽象套接字。

## 参考链接

[`research.nccgroup.com/2020/11/30/technical-advisory-containerd-containerd-shim-api-exposed-to-host-network-containers-cve-2020-15257/`](https://sctrack.sendcloud.net/track/click/eyJuZXRlYXNlIjogImZhbHNlIiwgIm1haWxsaXN0X2lkIjogMCwgInRhc2tfaWQiOiAiIiwgImVtYWlsX2lkIjogIjE2MDY4OTczMzQ1NTVfNjIwXzE5NTY5XzIwMTMuc2MtMTBfOV82M18xNjEtaW5ib3VuZDAkODk1ODgzODMyQHFxLmNvbSIsICJzaWduIjogIjBhNzI5MTI0YTgxYTFhMGNjNTNmMmI4NDk2ODFlZjU5IiwgInVzZXJfaGVhZGVycyI6IHt9LCAibGFiZWwiOiAwLCAidHJhY2tfZG9tYWluIjogInNjdHJhY2suc2VuZGNsb3VkLm5ldCIsICJyZWFsX3R5cGUiOiAiIiwgImxpbmsiOiAiaHR0cHMlM0EvL3Jlc2VhcmNoLm5jY2dyb3VwLmNvbS8yMDIwLzExLzMwL3RlY2huaWNhbC1hZHZpc29yeS1jb250YWluZXJkLWNvbnRhaW5lcmQtc2hpbS1hcGktZXhwb3NlZC10by1ob3N0LW5ldHdvcmstY29udGFpbmVycy1jdmUtMjAyMC0xNTI1Ny8iLCAib3V0X2lwIjogIjEwNi43NS4yLjUyIiwgImNvbnRlbnRfdHlwZSI6ICIwIiwgInVzZXJfaWQiOiA2MjAsICJvdmVyc2VhcyI6ICJmYWxzZSIsICJjYXRlZ29yeV9pZCI6IDE3ODA1N30=.html)