# 【Vulfocus解题系列】Tomcat任意写入文件漏洞(CVE-2017-12615) - 4andao - 博客园

> 原文：[https://www.cnblogs.com/4andao/p/14220015.html](https://www.cnblogs.com/4andao/p/14220015.html)

> 2021年的第一天，决定水一篇文章。。

# 漏洞简介

1.  CVE-2017-12615漏洞
    这个漏洞被称之为Tomcat PUT方法任意写文件漏洞，类似IIS的PUT上传漏洞。该漏洞可以利用HTTP的PUT方法直接上传webshell到目标服务器，从而获取权限。该漏洞是高危漏洞，在Tomcat的web.xml默认情况下不存在该漏洞，但是一单开发者或者运维人员手动讲web.xml中的readonly设置为false，可以通过 PUT / DELETE 进行文件操控。
2.  漏洞成因
    漏洞的核心错误配置是web.xml中的readonly
    ![](../Images/1cfe95c746ec01eb1c5a166da4314fcf.png)

# 题目环境

在[vulfocus演示环境](http://vulfocus.fofa.so/)自行搜索。

# 解题思路

打开环境，发现是Tomcat 8.5.19。
![](../Images/115edec1e059e919ec76829c5a69f169.png)

本来想假装不知道是PUT漏洞的，先进行一波漏洞搜索的。算了不啰嗦，直接解题。
![](../Images/cd1492090451f47e5ea5c40a76463d94.png)

在上传文件名后缀名的后面加/，即可绕过限制、上传文件。
![](../Images/6a2dbc9b5e72a4a8d8cd800b70bde819.png)

# 解题过程

根据上述的思路，解题就很简单了：上传一句话Jsp马，然后直接执行命令即可。
![](../Images/2cfb26a104c1cdbee655eb6817fa4201.png)
![](../Images/8e6adf9e34825fab58ba5cb7981d21f6.png)

执行命令反弹shell也是可以的：
![](../Images/3323aa2148353cef3fc87ed1cdc94a7d.png)

# Flag

动态flag。

# 总结

Tomcat任意写入文件漏洞(CVE-2017-12615)

## 1\. 影响版本：

*   Apache Tomcat 7.0.0 - 7.0.7
*   本次测试的环境是Tomcat 8.5.19，其他版本未测试。

## 2\. 利用方法：

利用PUT方法，上传Jsp木马。