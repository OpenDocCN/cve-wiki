# 关于 CVE-2020-0796 - 我要变超人 - 博客园

> 原文：[`www.cnblogs.com/sup3rman/p/12611226.html`](https://www.cnblogs.com/sup3rman/p/12611226.html)

漏洞介绍：系统用户的 SMBv3 远程代码执行漏洞，现在已出现本地提权 exp

本地提权 exp 下载地址：[`github.com/danigargu/CVE-2020-0796`](https://github.com/danigargu/CVE-2020-0796 "https://github.com/danigargu/CVE-2020-0796")    exe 版

[`github.com/ZecOps/CVE-2020-0796-LPE-POC`](https://github.com/ZecOps/CVE-2020-0796-LPE-POC)    py 版

#### 根本原因

漏洞发生在 srv2.sys 中,由于 SMB 没有正确处理压缩的数据包,在解压数据包的时候使用客户端传过来的长度进行解压时,并没有检查长度是否合法.最终导致整数溢出。

[`xz.aliyun.com/t/7440`](https://xz.aliyun.com/t/7440)

### 修复方案

1】设置-更新和安全-Windows 更新-检查更新
或直接下载对应补丁进行安装（KB4551762）
[`www.catalog.update.microsoft.com/Search.aspx?q=KB4551762`](https://www.catalog.update.microsoft.com/Search.aspx?q=KB4551762)
2】regedit HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters 建立一个名为 DisableCompression 的 DWORD，值为 1，禁止 SMB 的压缩功能。
或 powershell
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" DisableCompression -Type DWORD -Value 1 -Force
3】封 445 端口