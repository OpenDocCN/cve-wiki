# vulfocus 复现 CVE-2015-2208 - 琼玉 - 博客园

> 原文：[`www.cnblogs.com/dlddqya/p/15753069.html`](https://www.cnblogs.com/dlddqya/p/15753069.html)

# phpmoadmin 命令执行漏洞

描述：描述: phpMoAdmin 是一个用 PHP 开发的在线 MongoDB 管理工具，可用于创建、删除和修改数据库和索引，提供视图和数据搜索工具，提供数据库启动时间和内存的统计，支持 JSON 格式数据的导入导出。 moadmin.php 开头检查 POST 是否传输了 object，随后内包含的 if 进行判断，这个过程即调用了当前类的 saveObject 方法，POST 传入 object 参数的值带入 eval 后就造成了代码执行。

漏洞简介：moadmin.php 脚本中的‘saveObject’函数存在安全漏洞。远程攻击者可借助‘object’参数中的 shell 元字符利用该漏洞执行任意命令。

范围：v1.1.2

利用方式：curl http://访问地址 /moadmin.php -d 'object=1;system("ls /tmp");'

好耶，水完了，我太菜了，玩不明白代码审计，不过弟弟以后一定会学的。