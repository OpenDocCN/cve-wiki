# （CVE-2022-23131）ZABBIX 绕过 SAML SSO 身份验证 - 追得上的梦想 - 博客园

> 原文：[`www.cnblogs.com/KHZ521/p/15937754.html`](https://www.cnblogs.com/KHZ521/p/15937754.html)

### 0x01 前言

Zabbix Sia Zabbix 是拉脱维亚 Zabbix SIA（Zabbix Sia）公司的一套开源的监控系统。该系统支持网络监控、服务器监控、云监控和应用监控等。

Zabbix Frontend 存在安全漏洞，该漏洞源于在启用 SAML SSO 身份验证（非默认）的情况下，恶意行为者可以修改会话数据，因为存储在会话中的用户登录未经过验证。未经身份验证的恶意攻击者可能会利用此问题来提升权限并获得对 Zabbix 前端的管理员访问权限。

### 0x02 Fofa

```
app="ZABBIX-监控系统" && body="saml" 
```

![](img/b5c2a5db7f440c2b7d1db00ad256d8e0.png)

### 0x03 POC

下载地址

```
https://github.com/Mr-xn/cve-2022-23131 
```

利用方式

```
python cve-2022-23131.py <target> <Username> # 默认 Username 为 Admin 
```

### 0x04 漏洞利用

1.使用 POC 对网站发起请求，获得 zbx_signed_session 字段的 cookie
![](img/3b871673ac01bcd2aca296600f1e67f9.png)
2.Firefox 中更换请求 Cookie，将刚刚获取到的 zbx_signed_session 替换掉当前请求中的 zbx_session（只替换 Value，KEY`zbx_session`不需要替换），替换之后点击`Sign in with Single Sign-On (SAML)`
![](img/a62724198505a46b42f204409ab75ef3.png)
3.成功重定向到主页面
![](img/cc17fd082caf03e069559fee16d46195.png)

### 0x05 参考连接

[`mp.weixin.qq.com/s/zFejCrQU37DlJhMhOrPYPA`](https://mp.weixin.qq.com/s/zFejCrQU37DlJhMhOrPYPA)