# 2022-Spring Cloud Gateway 远程代码执行漏洞（CVE-2022-22947） - 逆向菜狗 - 博客园

> 原文：[`www.cnblogs.com/0x200/p/16110448.html`](https://www.cnblogs.com/0x200/p/16110448.html)

2022-Spring Cloud Gateway 远程代码执行漏洞（CVE-2022-22947）

2022 年 4 月 6 日

22:38

今年 spring 爆出来的漏洞还不少，先从 22947 开始：

漏洞成因：

Spring 官方博客发布了一篇关于 Spring Cloud Gateway 的 CVE 报告，据公告描述，当启用和暴露 Gateway Actuator 端点时，使用 Spring Cloud Gateway 的应用程序可受到代码注入攻击。攻击者可以发送特制的恶意请求，从而远程执行任意代码。

影响的版本：

3.1.0

3.0.0 至 3.0.6

Spring Cloud Gateway 其他已不再更新的版本

修复方案：

修复方案有：

3.1.x 版本用户应升级到 3.1.1+ 版本，3.0.x 版本用户应升级到 3.0.7+ 版本。在不影响业务的前提下，通过将配置选项 management.endpoint.gateway.enabled 设置为 false 禁用 gateway actuator endpoint。

搭建好环境：

![](img/48e00dbb8af84b92aa47b2a4ba5eaff1.png)

·

之后使用相关 exp 反弹 shell 即可：

exp 的位置：

E:\A-note-note\漏洞复现\2022-Spring Cloud Gateway 远程代码执行漏洞（CVE-2022-22947）

现在本地起一个 nc：

![](img/82ce900eb5c4b3be94645bdf9748ab6c.png)

这里可以使用官方带的 poc 让路由执行下 poc，或者使用这个工具 CVE-2022-22947-POC：

![](img/0995357f0168ce0b0610c16454a9640c.png)

之后可以使用 exp 进行反弹 shell，首先生成反弹 shell：

![](img/cd57352c95c5b22f72da4a6f8f789264.png)

之后攻击机执行，返回 root 权限：

![](img/d05800b5a8aa5473817126ee6ae338c0.png)