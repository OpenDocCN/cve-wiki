# 【漏洞通告】Apache Struts2 远程代码执行漏洞（CVE-2021-31805） - study_goup - 博客园

> 原文：[`www.cnblogs.com/my-first-blog-lgz/p/16158680.html`](https://www.cnblogs.com/my-first-blog-lgz/p/16158680.html)

转至：https://www.venustech.com.cn/new_type/aqtg/20220413/23713.html

### 0x00 漏洞概述

| CVE   ID | CVE-2021-31805 | 时    间 | 2022-04-12 |
| 类    型 | RCE | 等    级 | 高危 |
| 远程利用 | 是 | 影响范围 | Apache Struts 2.0.0-2.5.29 |
| 攻击复杂度 |   | 用户交互 |   |
| PoC/EXP |   | 在野利用 |   |

### 0x01 漏洞详情

Apache Struts2 是一个基于 MVC 设计模式的流行的 Web 应用程序框架。

4 月 12 日，Apache Struts2 发布安全公告（S2-062），修复了 Apache Struts2 中的一个远程代码执行漏洞（CVE-2021-31805）。

由于对 CVE-2020-17530 的修复不完整，在 Apache Struts 2.0.0-2.5.29 中，如果开发人员使用 %{...} 语法应用强制 OGNL 解析，标签的某些属性仍然可被二次解析。当对标签属性中未经验证的原始用户输入进行解析时可能会导致远程代码执行。

**影响范围**

Apache Struts 2.0.0-2.5.29

### 0x02 安全建议

目前此漏洞已经修复，建议受影响用户及时升级更新到 Apache Struts 2.5.30 或更高版本。

下载链接：

https://cwiki.apache.org/confluence/display/WW/Version+Notes+2.5.30

缓解措施：

避免对不受信任或未经验证的用户输入使用强制 OGNL 解析。

### 0x03 参考链接

https://cwiki.apache.org/confluence/display/WW/S2-062

https://www.mail-archive.com/announce@apache.org/msg07237.html

### 0x04 版本信息

| 版本 | 日期 | 修改内容 |
| V1.0 | 2022-04-13 | 首次发布 |

### 0x05 附录

**公司简介**

启明星辰公司成立于 1996 年，并于 2010 年 6 月 23 日在深交所中小板正式挂牌上市，是国内极具实力的、拥有完全自主知识产权的网络安全产品、可信安全管理平台、安全服务与解决方案的综合提供商。

公司总部位于北京市中关村软件园，在全国各省、市、自治区设有分支机构，拥有覆盖全国的渠道体系和技术支持中心，并在北京、上海、成都、广州、长沙、杭州等多地设有研发中心。

多年来，启明星辰致力于提供具有国际竞争力的自主创新的安全产品和最佳实践服务，帮助客户全面提升其 IT 基础设施的安全性和生产效能，为打造和提升国际化的民族信息安全产业领军品牌而不懈努力。

**关于我们**

启明星辰安全应急响应中心主要针对重要安全漏洞的预警、跟踪和分享全球最新的威胁情报和安全报告。

关注以下公众号，获取全球最新安全资讯：

搜索

复制