# CVE-2022-0847 漏洞复现及修复建议 - 合天网安实验室 - 博客园

> 原文：[`www.cnblogs.com/hetianlab/p/15990480.html`](https://www.cnblogs.com/hetianlab/p/15990480.html)

　　声明：**本文仅限于技术讨论与分享，严禁用于非法途径。若读者因此作出任何危害网络安全行为后果自负，与本号及原作者无关。**

#### *　　漏洞描述*

　　CVE-2022-0847 是 Linux 内核的本地提权漏洞。原理类似于 Dirty Cow linux 提权。目前该漏洞的 EXP 已经公开，且处于在野利用。

#### *　　影响版本*

　　Linux kernel>=5.8

#### *　　漏洞复现*

　　这里利用的 linux 内核版本为 5.9，因为之前 ubuntu 的内核版本为 4.5.0

![图片 1.png](img/e4c6a890c831e02e44f57cf8b874b5db.png)

所以需要对 linux 的内升级

　　wget -c [`kernel.ubuntu.com/~kernel-ppa/mainline/v5.9/amd64/linux-headers-5.9.0-050900_5.9.0-050900.202010112230_all.deb`](https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.9/amd64/linux-headers-5.9.0-050900_5.9.0-050900.202010112230_all.deb) 

　　wget -c [`kernel.ubuntu.com/~kernel-ppa/mainline/v5.9/amd64/linux-headers-5.9.0-050900-generic_5.9.0-050900.202010112230_amd64.deb`](https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.9/amd64/linux-headers-5.9.0-050900-generic_5.9.0-050900.202010112230_amd64.deb) 

　　wget -c [`kernel.ubuntu.com/~kernel-ppa/mainline/v5.9/amd64/linux-image-unsigned-5.9.0-050900-generic_5.9.0-050900.202010112230_amd64.deb`](https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.9/amd64/linux-image-unsigned-5.9.0-050900-generic_5.9.0-050900.202010112230_amd64.deb) 

　　wget -c [`kernel.ubuntu.com/~kernel-ppa/mainline/v5.9/amd64/linux-modules-5.9.0-050900-generic_5.9.0-050900.202010112230_amd64.deb`](https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.9/amd64/linux-modules-5.9.0-050900-generic_5.9.0-050900.202010112230_amd64.deb) 

　　下载完毕后安装

　　sudo dpkg -i *.deb

　　之后重启虚拟机即可，如果中间报错的话，需要重新下载依赖进行安装，这里升级依赖可参考

[`blog.csdn.net/qq_50598558/article/details/119063124`](https://blog.csdn.net/qq_50598558/article/details/119063124)

　　重启之后内核版本成功升级为 5.9.0

![图片 2.png](img/ea9691eb1a64ce3167e0f9c5713e0733.png)

利用 exp 进行提权,编译提权脚本

　　gcc -o exploit exploit.c

![图片 3.png](img/9b2861d1285319f3ee9458dd6ca1eb3c.png)

　　./exploit

![图片 4.png](img/e665dce9fcd3db7516ffcf8b58d4c757.png)

　　临时目录/tmp 下生成了一个 passwd 的备份文件

![图片 5.png](img/8b35ab1a143efa76c5c0ab0ee63c7e2d.png)

　　这个时候需要利用低权限用户将原来的 passewd 文件进行覆盖

　　mv /tmp/passwd.bak /etc/passwd

![图片 6.png](img/338c06c2916b53f7d8aadf389547b310.png)

　　这个时候已成功提权，利用密码为**aaron**对 root 用户进行登录

![图片 7.png](img/3e80b5927b1831e69268d7643939b211.png)

#### *　　修复建议*

　• 建议将 linux 内核升级为安全版本，目前在 Linux 5.10.102、5.15.25 和 5.16.11 版本已修复。

　• 存在问题终端或者服务器不要映射在公网上。

　　**更多漏洞挖掘的在线实操练习，[请点击这里>>](https://www.hetianlab.com/)**