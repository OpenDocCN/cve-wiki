# CVE-2018-8174漏洞复现（IE浏览器远程代码执行漏洞） - 冲田总司cc - 博客园

> 原文：[https://www.cnblogs.com/tsimfeiwan/p/11990565.html](https://www.cnblogs.com/tsimfeiwan/p/11990565.html)

**漏洞介绍：**CVE-2018-8174这个漏洞是针对IE浏览器的一个远程代码执行漏洞，是Windows VBScript Engine 代码执行漏洞，由于VBScript脚本执行引擎（vbscript.dll）存在代码执行漏洞，攻击者可以将恶意的VBScript嵌入到office文件或者网站中，一旦用户不小心点击，远程攻击者可以获取当前用户权限执行脚本中的恶意代码。

**受影响产品：**Windows 7, Windows Server 2012 R2, Windows RT 8.1, Windows Server 2008, Windows Server 2012, Windows 8.1, Windows Server 2016, Windows Server 2008 R2, Windows 10, Windows 10 Servers

**复现过程**

环境：kali[192.168.86.132]  + （win7+IE）[192.168.86.130]

step1、去Github下载exp到kali上

（下载地址：[https://github.com/Sch01ar/CVE-2018-8174_EXP](https://github.com/Sch01ar/CVE-2018-8174_EXP)）

![](../Images/25a220a634cdf11ae28612ccfd1f0891.png)

 进入文件目录

![](../Images/d15c100c31657073da8e0ae4f645a6cb.png)

 然后生成payload

python CVE-2018-8174.py -u payload的url -o rtf文件的名字 -i ip地址 -p 端口

然后就能看到生成了两个文件：一个HTML、一个rtf文件

将HTML文件复制到nginx的网站

![](../Images/50bb3a71f861caf2e4e91786addf1306.png)

 step2、关闭apache服务、重启Nginx（现在的kali是自带安装好了apache和nginx了）

![](../Images/00aa5b6cdd946f5ba8879a02435a3ed2.png)

step3、启动nc监听刚刚设置好的端口，等待对方打开网站

![](../Images/4311e6d46e6330a2d06a0578e5096c98.png)

 step4、用win7的IE浏览器打开url地址

IE浏览器打开网页，虽然没有正常显示这个页面，但是已经攻击成功了，攻击机上没有发觉什么异样情况

![](../Images/02b68f2841fe8adbe3d93ac2090f8b7c.png)

 step5、返回kali看看，已经反弹一个shell了

![](../Images/349e42d81d69f9dfd54cf38798ec292c.png)

over！！！（今天复现了一个漏洞，写了个笔记发在这里啦！）