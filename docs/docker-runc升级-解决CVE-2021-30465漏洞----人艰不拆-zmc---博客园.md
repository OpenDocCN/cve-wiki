# docker runc 升级（解决 CVE-2021-30465 漏洞） - 人艰不拆 _zmc - 博客园

> 原文：[`www.cnblogs.com/zhangmingcheng/p/14863148.html`](https://www.cnblogs.com/zhangmingcheng/p/14863148.html)

一、背景：

2021 年 5 月 31 日，阿里云应急响应中心监测到国外安全研究人员披露 CVE-2021-30465 runc 符号链接挂载与容器逃逸漏洞。1、漏洞描述 runc 是容器 Runtime 的一个实现，主要作用是使用 Linux Kernel 提供的如 namespaces 等进程隔离机制，构建供容器运行的隔离环境。CVE-2021-30465 中，攻击者可通过创建恶意 POD 及 container，利用符号链接以及条件竞争漏洞，可挂载宿主机目录至 container 中，并最终可能导致容器逃逸。阿里云应急响应中心提醒 runc 用户尽快采取安全措施阻止漏洞攻击。2、漏洞评级 CVE-2021-30465 runc 符号链接挂载与容器逃逸漏洞-高危 3、影响版本 runc <= 1.0.0-rc944、安全版本 runc 1.0.0-rc955、安全建议升级 runc 至安全版本 6、修复链接[`github.com/opencontainers/runc/security/advisories/GHSA-c3xm-pvg7-gh7r`](https://github.com/opencontainers/runc/security/advisories/GHSA-c3xm-pvg7-gh7r "https://github.com/opencontainers/runc/security/advisories/GHSA-c3xm-pvg7-gh7r")二、docker runc 升级

1、下载安全版本的 runc 到本地电脑

下载地址：

```
https://github.com/opencontainers/runc/releases/download/v1.0.0-rc95/runc.amd64
```

2、 将下载好的 runc.amd64 文件上传到服务器、修改文件名并赋权

```
mv runc.amd64 runc && chmod +x runc
```

3、 备份原有的 runc

```
mv /usr/bin/runc /home/runcbak
```

4、停止 docker

```
systemctl stop docker
```

5、替换新版本 runc

```
cp runc /usr/bin/runc
```

6、 启动 docker

```
systemctl start docker
```

7 、检查 runc 是否升级成功

执行 docker version 命令，发现 runc Version 为 1.0.0-rc95 代表 runc 升级成功。

![](img/0b0f918edfa52be085c743388860c75d.png)