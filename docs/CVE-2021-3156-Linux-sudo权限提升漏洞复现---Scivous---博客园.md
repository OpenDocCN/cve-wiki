# CVE-2021-3156 Linux sudo 权限提升漏洞复现 - Scivous - 博客园

> 原文：[`www.cnblogs.com/scivous/p/14361448.html`](https://www.cnblogs.com/scivous/p/14361448.html)

前言：

　　现在最火的莫不过是这个 linux sudo 权限提升漏洞了，sudo 命令可以说是在 linux 中十分出名的命令了，在运维时很多时候都需要用到 sudo 命令，通过此漏洞，可以对具有一定权限的普通用户，无需知道 root 密码的情况下，获得 root 权限。所以，这是一个提权漏洞，而在整个渗透测试流程中，提权这一步是至关重要的，它决定了你对整个资产的可利用程度。所以这个漏洞现在是比较火的，诸多大佬都已经复现了，那么现在跟随大佬的脚步，继续复现一下

验证 poc：

　　在 linux 下，输入 sudoedit -s /

　　如果出现 sudoedit: /: not a regular file，则表示该漏洞存在

　　![](https://img2020.cnblogs.com/blog/2095541/202102/2095541-20210202131753028-394990445.png)

影响的版本：

　　sudo 1.8.2-1.8.31p2

　　sudo 1.9.0-1.9.5p1

受影响的系统：

　　Ubuntu 20.04 等

　　Debian 10 等

　　Fedora 33 等

漏洞 exp：

　　https://github.com/blasty/CVE-2021-3156

流程：

　　下载漏洞 exp，上传到漏洞靶机处，这次的靶机为 Ubuntu 18.0.4.1

![](https://img2020.cnblogs.com/blog/2095541/202102/2095541-20210202131142602-2112428282.png)

　　从上图中，可看到当前用户为普通用户，无法查看/etc/shadow

　　进入 CVE-2021-3156 文件夹，依次执行：

```
make
./sudo-hax-me-a-sandwich
根据选项选择数字 0-2 ./sudo-hax-me-a-sandwich 0
```

![](https://img2020.cnblogs.com/blog/2095541/202102/2095541-20210202131500388-1916037506.png)

![](https://img2020.cnblogs.com/blog/2095541/202102/2095541-20210202131511115-52473291.png)

　　可看到，执行后，可在#号后，执行 root 权限命令，可查看/etc/shadow

　　whoami 后为 root 用户

　　![](https://img2020.cnblogs.com/blog/2095541/202102/2095541-20210202131636094-935197869.png)

　　使用 exit 退出

　　![](https://img2020.cnblogs.com/blog/2095541/202102/2095541-20210202131850349-368382595.png)