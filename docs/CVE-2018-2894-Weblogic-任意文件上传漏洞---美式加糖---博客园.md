# CVE-2018-2894 Weblogic 任意文件上传漏洞 - 美式加糖 - 博客园

> 原文：[`www.cnblogs.com/peace-and-romance/p/15738122.html`](https://www.cnblogs.com/peace-and-romance/p/15738122.html)

### 0X00-引言

![呦](img/9f9373cb15352bf453f3e7ecba499649.png)

甲方就是上帝，唯甲方主义，淦

### 0X01-环境搭建

* * *

靶机：CentOS Linux 7

攻击机：windows server 2016 && Kail

环境：vulhub

项目地址：[`github.com/vulhub/vulhub`](https://github.com/vulhub/vulhub)

搭建 vulhub 请访问：[空白 centos7 64 搭建 vulhub(详细)](https://www.cnblogs.com/peace-and-romance/p/15621658.html)

### 0X02-漏洞描述

* * *

Oracle 7 月更新中，修复了 Weblogic Web Service Test Page 中一处任意文件上传漏洞，Web Service Test Page 在“生产模式”下默认不开启，所以该漏洞有一定限制。

利用该漏洞，可以上传任意 jsp 文件，进而获取服务器权限。

### 0X03-漏洞复现

* * *

`http://192.168.234.128:7001/console/login/LoginForm.jsp`

![image-20211227213622181](img/d3ba861906e874def07b4d3145b9ee56.png)

##### 01-登录

渗透从弱口令开始，这次我们直接查看密码

查看登录密码`docker-compose logs | grep password`

![image-20211227213713920](img/7fb026906f99634fb800c994d808d2e0.png)

登录-点击 base-domain-点击高级-启用 web 服务测试页-点击保存

![image-20211227214124893](img/11094ff847dbe535655b09e588e33975.png)

![image-20211227214248959](img/443b9e817908abef56f8db5e418f76a0.png)

##### 02-上传马(getshell)

访问`http://192.168.234.128:7001/ws_utc/config.do`

更改当前工作目录为以下

```
/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css 
```

![image-20211227214759542](img/ccac98e8d87c7de6b35a08de8bceaa0b.png)

点击安全-添加木马文件(我的是哥斯拉的马)

![image-20211227215315417](img/07025e26385fa0d630f1700d83ca064a.png)

抓包

![image-20211227215518052](img/273172eabe9a62a27aca16451a1f72cf.png)

连接-路径为以下-图中红圈为时间戳和文件名

`http://192.168.234.128:7001/ws_utc/css/config/keystore/1640613219615_shell.jsp`

![image-20211227220400462](img/87b00b192438d423a88c883b3feb8c9e.png)

### 0X04-漏洞防御

* * *

升级版本

隐藏管理控制页面同时修改默认密码

禁止访问 config.do 页面

使用安全设备进行防御

### 0X05-免责声明

* * *

仅供学习使用

### 0X06-参考

* * *

[【vulhub】Weblogic（CVE-2018-2894）漏洞复现](https://blog.csdn.net/qq_45300786/article/details/115579631)

[`vulhub.org/#/environments/weblogic/CVE-2018-2894/`](https://vulhub.org/#/environments/weblogic/CVE-2018-2894/)