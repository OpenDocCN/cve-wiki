# CVE-2020-1472 | Netlogon 特权提升漏洞预警 - micr067 - 博客园

> 原文：[`www.cnblogs.com/micr067/p/13677467.html`](https://www.cnblogs.com/micr067/p/13677467.html)

# CVE-2020-1472 | Netlogon 特权提升漏洞预警

## 0x01 简介

CNVD:[`www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202008-548`](http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202008-548)

`NetLogon 组件` 是 Windows 上一项重要的功能组件，用于用户和机器在域内网络上的认证，以及复制数据库以进行域控备份，同时还用于维护域成员与域之间、域与域控之间、域 DC 与跨域 DC 之间的关系。

当攻击者使用 Netlogon 远程协议 (MS-NRPC) 建立与域控制器连接的易受攻击的 Netlogon 安全通道时，存在特权提升漏洞。成功利用此漏洞的攻击者可以在网络中的设备上运行经特殊设计的应用程序。

## 0x02 影响版本

*   Windows Server 2008 R2 for x64-based Systems Service Pack 1
*   Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)
*   Windows Server 2012
*   Windows Server 2012 (Server Core installation)
*   Windows Server 2012 R2
*   Windows Server 2012 R2 (Server Core installation)
*   Windows Server 2016
*   Windows Server 2016 (Server Core installation)
*   Windows Server 2019
*   Windows Server 2019 (Server Core installation)
*   Windows Server, version 1903 (Server Core installation)
*   Windows Server, version 1909 (Server Core installation)
*   Windows Server, version 2004 (Server Core installation)

## 0x03 漏洞演示截图：

![](img/c85cb953bb5f99773345d201e8896997.png)

## poc

[`github.com/SecuraBV/CVE-2020-1472`](https://github.com/SecuraBV/CVE-2020-1472)

**python3 zerologon_tester.py 计算机名 目标 IP**

![](img/0b792cfff3f24c0a9eb029f9ecfed249.png)

## exp

exp 目前已经公布，地址为
[`github.com/blackarrowsec/redteam-research`](https://github.com/blackarrowsec/redteam-research)
![](img/32bd3ec4375c5426b5406726c15a774a.png)

### 修复建议：

微软已经发布了该漏洞的补丁程序，可以直接通过 windows 自动更新解决以上问题，也可以手动下载更新补丁程序进行安装。

[`portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1472`](https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1472)

#### 注意：

**只要给域控打补丁即可，成员服务器不需要打补丁**

参考：[`social.technet.microsoft.com/Forums/zh-CN/01102e21-b3ee-413b-8295-9a1cdd16286e/cve20201472-netlogon-293052643525552213192843127934?forum=windowsserversystemzhchs`](https://social.technet.microsoft.com/Forums/zh-CN/01102e21-b3ee-413b-8295-9a1cdd16286e/cve20201472-netlogon-293052643525552213192843127934?forum=windowsserversystemzhchs)