# CVE-2019-1388： Windows UAC 提权 - 20181234 - 博客园

> 原文：[https://www.cnblogs.com/ZYX-bk-412/p/14747042.html](https://www.cnblogs.com/ZYX-bk-412/p/14747042.html)

# CVE-2019-1388： Windows UAC 提权

# 漏洞简介

该漏洞位于Windows的UAC（User Account Control，用户帐户控制）机制中。

默认情况下，Windows会在一个单独的桌面上显示所有的UAC提示——Secure Desktop。

这些提示是由名为consent.exe的可执行文件产生的，该可执行文件以NT AUTHORITY\SYSTEM权限运行，完整性级别为System。

因为用户可以与该UI交互，因此对UI来说紧限制是必须的。否则，低权限的用户可能可以通过UI操作的循环路由以SYSTEM权限执行操作。

即使隔离状态的看似无害的UI特征都可能会成为引发任意控制的动作链的第一步。事实上，UAC会话中含有尽可能少的点击操作选项。

利用该漏洞很容易就可以提升权限到SYSTEM

我的通俗理解就是：微软自己的问题，为了方便管理，在系统内存在consent.exe这个程序是默认用system用户运行，然后我们又可以利用低权限用户来去跟这个程序的UI界面进行交互。几经操作就可能提权。

# 影响范围

SERVER

> Windows 2008r2 7601 ** link OPENED AS SYSTEM **
> Windows 2012r2 9600 ** link OPENED AS SYSTEM **
> Windows 2016 14393 ** link OPENED AS SYSTEM **
> Windows 2019 17763 link NOT opened

WORKSTATION

> Windows 7 SP1 7601 ** link OPENED AS SYSTEM **
> Windows 8 9200 ** link OPENED AS SYSTEM **
> Windows 8.1 9600 ** link OPENED AS SYSTEM **
> Windows 10 1511 10240 ** link OPENED AS SYSTEM **
> Windows 10 1607 14393 ** link OPENED AS SYSTEM **
> Windows 10 1703 15063 link NOT opened
> Windows 10 1709 16299 link NOT opened

# 环境搭建

Windows 7 x64 sp1

# 漏洞复现

## 实验前

![](../Images/377b98a00ae9b94b73ae4ea5252d2327.png)

## 开始实验

### 以管理员权限运行 HHUPD.EXE

### 显示详细信息

### ![](../Images/77f632ae6a9e8ffdbbbb0eb3d9adf56f.png)

### 显示有关此发布者的证书信息

 ![](../Images/7161790ac19343987fb8c91d6b2f8b42.png)

### 点击颁发者右侧的超链接

![](../Images/91f8a61966e60eca6e360d6a4252a0de.png)

### 等待一段时间ie浏览器自动运行，并访问该链接，这时出现404或链接无法访问（此时浏览器以system权限运行)

![](../Images/139027d33b64b709beb76792e7223673.png)

### 将该网页直接另存为文件

![](../Images/2a4f5b5c110ba66ad8069e7bcceffabb.png)

### 选择位置 C:\Windows\System32\*.*

![](../Images/f2f83a0998dae9cc80eca9c5af7948a5.png)

### 选择 cmd.exe 并运行
![](../Images/1abb1d5f762f9080c3a55b51fc6e67ae.png)

### 此时查看权限，已经是system权限

![](../Images/6b87355a8ad7419b8e14f0d19bcf064d.png)

# 修复建议

### https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1388