# 服务器容器漏洞-nginx 文件名逻辑漏洞(CVE-2013-4547) - 挖洞 404 - 博客园

> 原文：[`www.cnblogs.com/wd404/p/17345416.html`](https://www.cnblogs.com/wd404/p/17345416.html)

[Nginx 文件名逻辑漏洞(CVE-2013-4547) - FreeBuf 网络安全行业门户](https://www.freebuf.com/vuls/284531.html)

1、介绍

名称：nginx 文件名逻辑漏洞

编号：CVE-2013-4547

原理：当请求如下 URI 时：/test[0x20]/…/admin/index.php，这个 URI 不会匹配上 location 后面的/admin/，也就绕过了其中的 IP 验证；但最后请求的是/test[0x20]/…/admin/index.php 文件，也就是/admin/index.php，成功访问到后台。（这个前提是需要有一个目录叫 test：这是 Linux 系统的特点，如果有一个不存在的目录，则即使跳转到上一层，也会爆文件不存在的错误，Windows 下没有这个限制）。

应用：nginx

版本：

```
Nginx 0.8.41 ~ 1.4.3
Nginx 1.5.0 ~ 1.5.7
```

2、漏洞复现

2.1 靶场搭建

![](img/0d7ea444cf99844c4dd5c7a6e9928c3f.png)

![](img/65947789e0537b348c293c5a6b87e9e4.png)

![](img/bf4cd80adb8e8976f9980776f0ec02da.png)

2.2 上传文件

![](img/51a9369fe0d68753d928a32e715578b9.png)

burp 拦截，文件名添加空格。

![](img/605b02490449027f7988cf0eea651da0.png)

![](img/cd3bf12fe50702e6bbf0d8e8ed6c809b.png)

2.3 连接

http://192.168.0.15:8080/uploadfiles/1.jpg...php

![](img/37176c4fea5df0aa4917063108a8b0c8.png)

![](img/45e81fea291de88f995a12b5e26fbd4d.png)

![](img/bd7dbc76cb952a0097362a009c26cbd9.png)

![](img/03ec72ed9eab97f1a9424d6e5a1fbd9b.png)

3、漏洞防护

将 Nginx 升级到 1.5.7 之后