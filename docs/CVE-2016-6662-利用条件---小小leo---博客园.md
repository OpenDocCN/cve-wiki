# CVE-2016-6662 利用条件 - 小小 leo - 博客园

> 原文：[`www.cnblogs.com/xiaoxiaoleo/p/5880634.html`](https://www.cnblogs.com/xiaoxiaoleo/p/5880634.html)

首先执行 SET GLOBAL 需要超级用户权限，所以利用条件要么用户本身是超级用户要么用户有 trigger 权限，通过创建 trigger，由超级用户触发 SET GLOBAL。

然而 MYsql 有个通过 file 权限提权的漏洞一直没修，可通过写 TRG 文件创建 Trigger 方法,参考 https://www.exploit-db.com/exploits/23077/,http://www.cnblogs.com/xiaoxiaoleo/p/5886207.html。

三种条件：

0.  普通用户+select 权限+file 权限

 1\. 普通用户+select 权限+file 权限+trigger 权限

 2\. 超级用户(比如 root)

加固方法：

禁止普通用户 file 权限