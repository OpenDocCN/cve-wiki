# Apache Shiro 认证绕过漏洞（CVE-2020-1957） - dustfree - 博客园

> 原文：[`www.cnblogs.com/dustfree/p/17580924.html`](https://www.cnblogs.com/dustfree/p/17580924.html)

# 漏洞简介

Apache Shiro 是一款开源安全框架，提供身份验证、授权、密码学和会话管理。Shiro 框架直观、易用，同时也能提供健壮的安全性。

在 Apache Shiro 1.5.2 以前的版本中，在使用 Spring 动态控制器时，攻击者通过构造…;这样的跳转，可以绕过 Shiro 中对目录的权限限制。

# 漏洞复现

开启 vulhub 靶场环境，确保 shiro 正常运行

```
cd vulhub-master/shiro/CVE-2020-1957/
docker-compose up -d
docker ps -a
docker logs 58a9  #你的容器名称
```

![](img/fef5602dc867d0ea75db67ddb859df18.png)

![](img/39832d451a84fc2cf8c3d1999f4dd7e4.png)

浏览器访问[`192.168.8.139:8080/`](http://192.168.8.139:8080/)

![](img/90d34cd7077d3632738832b2c2a4c66b.png)

先将正常登录流程操作一遍：点击 Login 或者 Account info 按钮，输入账户密码

![](img/44701acba99ac17b4030f94bb4ccd238.png)

![](img/1de9e7a211e82fff540109fbd553f7d3.png)

![](img/ae318e83d200fc39f838499022a7e81d.png)

顺便抓包查看 shiro 的流量特征

![](img/1065ae6caf1a4027c07b70a669428794.png)

 直接访问 http://192.168.8.139:8080/admin/，跳转到 http://192.168.8.139:8080/login.html，提示需要登录认证

![](img/f486528e1866ad3f6d6cc22196d657be.png)

![](img/57f8c6bd75a4bc15621a6bc6542a8256.png)

抓包查看跳转过程

![](img/2e15f0d24485410631c0eaafc5d9e1a8.png)

此时构造恶意请求/xxx/…;/admin/，即可绕过权限校验，访问到管理页面。即绕过了刚才通过输入账户密码的正常登录操作才能看到的界面。

![](img/90a01eb1bd7828e8fea6b094b9637da0.png)

偶尔出现 404 界面，忽略即可（可能是 vulhub 靶场环境的 bug）。此时已经进入了 admin 的管理页面。

![](img/568f51f0ba2431c77790a48bdd190fe5.png)

![](img/b92df1b60fc27a80913c9e01bdbab0cd.png)