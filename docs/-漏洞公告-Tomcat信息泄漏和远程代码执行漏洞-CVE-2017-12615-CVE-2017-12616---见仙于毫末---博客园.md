# 【漏洞公告】Tomcat 信息泄漏和远程代码执行漏洞：CVE-2017-12615/CVE-2017-12616 - 见仙于毫末 - 博客园

> 原文：[`www.cnblogs.com/j-star/p/7561191.html`](https://www.cnblogs.com/j-star/p/7561191.html)

2017 年 9 月 19 日，Apache Tomcat 官方确认并修复了两个高危漏洞，漏洞 CVE 编号:CVE-2017-12615 和 CVE-2017-12616,该漏洞受影响版本为 7.0-7.80 之间，在一定条件下，攻击者可以利用这两个漏洞，获取用户服务器上 JSP 文件的源代码，或是通过精心构造的攻击请求，向用户服务器上传恶意 JSP 文件，通过上传的 JSP 文件 ，可在用户服务器上执行任意代码，从而导致数据泄露或获取服务器权限，存在高安全风险。

**漏洞编号:**

CVE-2017-12615

CVE-2017-12616

**漏洞名称:**

CVE-2017-12615-远程代码执行漏洞

CVE-2017-12616-信息泄露漏洞

**官方评级:**

高危

**漏洞描述:**

*   CVE-2017-12616：信息泄露漏洞

    当 Tomcat 中启用了 VirtualDirContext 时，攻击者将能通过发送精心构造的恶意请求，绕过设置的相关安全限制，或是获取到由 VirtualDirContext 提供支持资源服务的 JSP 源代码，从而造成代码信息泄露。

*   CVE-2017-12615：远程代码执行漏洞

    当 Tomcat 运行在 Windows 操作系统时，且启用了 HTTP PUT 请求方法（例如，将 readonly 初始化参数由默认值设置为 false），攻击者将有可能可通过精心构造的攻击请求数据包向服务器上传包含任意代码的 JSP 文件，JSP 文件中的恶意代码将能被服务器执行。导致服务器上的数据泄露或获取服务器权限。

通过以上两个漏洞可在用户服务器上执行任意代码，从而导致数据泄露或获取服务器权限，存在高安全风险。

**漏洞利用条件和方式:**

*   CVE-2017-12615 漏洞利用需要在 Windows 环境，且需要将 readonly 初始化参数由默认值设置为 false，经过实际测试，Tomcat 7.x 版本内 web.xml 配置文件内默认配置无 readonly 参数，需要手工添加，默认配置条件下不受此漏洞影响。
*   CVE-2017-12616 漏洞需要在 server.xml 文件配置 VirtualDirContext 参数，经过实际测试，Tomcat 7.x 版本内默认配置无 VirtualDirContext 参数，需要手工添加，默认配置条件下不受此漏洞影响。

**漏洞影响范围:**

*   CVE-2017-12616 影响范围：Apache Tomcat 7.0.0 - 7.0.80
*   CVE-2017-12615 影响范围： Apache Tomcat 7.0.0 - 7.0.79

**漏洞检测:**

开发人员检查是否使用受影响范围内的 Apache Tomcat 版本

**漏洞修复建议(或缓解措施):**

*   根据业务评估配置 readonly 和 VirtualDirContext 值为 Ture 或注释参数，临时规避安全风险；
*   目前官方已经发布了[7.0.81 版本](http://tomcat.apache.org/download-70.cgi?spm=5176.bbsr536282.0.0.uCIPzO&file=download-70.cgi "7.0.81 版本")修复了两个漏洞，建议用户尽快升级到最新版本。

**情报来源:**

*   [`tomcat.apache.org/security-7.html`](https://tomcat.apache.org/security-7.html)
*   [`tomcat.apache.org/security-7.html#Fixed_in_Apache_Tomcat_7.0.81`](http://tomcat.apache.org/security-7.html#Fixed_in_Apache_Tomcat_7.0.81)