# glibc CVE-2015-7547 漏洞的分析和修复方法【转】 - 请给我倒杯茶 - 博客园

> 原文：[`www.cnblogs.com/zzb-Dream-90Time/p/8087483.html`](https://www.cnblogs.com/zzb-Dream-90Time/p/8087483.html)

本文转载自：[`blog.csdn.net/tengxy_cloud/article/details/50764370`](http://blog.csdn.net/tengxy_cloud/article/details/50764370)

漏洞概述

glibc 中处理 DNS 查询的代码中存在栈溢出漏洞，远端攻击者可以通过回应特定构造的 DNS 响应数据包导致 glibc 相关的应用程序 crash 或者利用栈溢出运行任意代码。应用程序调用使用 getaddrinfo 函数将会收到该漏洞的影响。

CVE 编号

[CVE-2015-7547](https://access.redhat.com/security/cve/CVE-2015-7547)

受影响的系统

CentOS6 所有版本
CentOS7 所有版本
SUSE Linux Enterprise Server 11 SP3
SUSE Linux Enterprise Server 12
Ubuntu Server 14.04.1 LTS 32 位
Ubuntu Server 14.04.1 LTS 64 位
Ubuntu Server 12.04 LTS 64 位
Ubuntu Server 12.04 LTS 64 位（Docker）
Debian8.2 32 位
Debian8.2 64 位
Debian7.8 32 位
Debian7.8 64 位
Debian7.4 64 位
CoreOS717.3.0 64 位

如何修复该漏洞

腾讯云提供的基础操作系统镜像 CentOS 系列、Ubuntu 系列、Debian 系列都已修复该问题，新创建的云服务器不存在该漏洞。腾讯云提供的更新源已经提供了修改该漏洞的 glibc 版本，对于已经运行的云服务器可以通过手动更新 glibc 修复。

步骤一：（更新 glibc 版本）

CentOS6 系列：
yum -y update glibc-2.12-1.166.el6_7.7 glibc-common-2.12-1.166.el6_7.7 glibc-devel-2.12-1.166.el6_7.7 glibc-headers-2.12-1.166.el6_7.7 glibc-static-2.12-1.166.el6_7.7 glibc-utils-2.12-1.166.el6_7.7 nscd-2.12-1.166.el6_7.7

Centos7 系列：
yum -y update glibc-2.17-106.el7_2.4 glibc-common-2.17-106.el7_2.4 glibc-devel-2.17-106.el7_2.4 glibc-headers-2.17-106.el7_2.4 glibc-static-2.17-106.el7_2.4 glibc-utils-2.17-106.el7_2.4 nscd-2.17-106.el7_2.4

Ubuntu Server 14.04.1 LTS 系列：
1.修改/etc/apt/sources.list 添加如下内容：
deb http://mirrors.tencentyun.com/ubuntu-security trusty-security main
2.执行 apt-get update 命令：
3.执行 apt-get install libc6; apt-get install libc-bin 命令；

Ubuntu Server 12.04 LTS 系列：
1.修改/etc/apt/sources.list 添加如下内容：
deb http://mirrors.tencentyun.com/ubuntu-security precise-security main
2.执行 apt-get update 命令：
3.执行 apt-get install libc6;

Debian6 系列：
1.修改/etc/apt/sources.list 添加如下内容：
deb http://mirrors.tencentyun.com/debian squeeze-lts main non-free contrib
deb http://mirrors.tencentyun.com/debian-security squeeze/updates main
2.执行 apt-get update 命令：
3.执行 apt-get install libc6 更新 libc

Debian7 系列：
1.修改/etc/apt/sources.list 添加如下内容：
deb http://mirrors.tencentyun.com/debian-security wheezy/updates main
2.执行 apt-get update 命令：
3.执行 apt-get install libc6 更新 libc

Debian8 系列：
1.修改/etc/apt/sources.list 添加如下内容：
deb http://mirrors.tencentyun.com/debian-security jessie/updates main
2.执行 apt-get update 命令：
3.执行 apt-get install libc6;apt-get install libc-bin 命令

步骤二：（重启服务）

由于本次漏洞为 glibc 的漏洞，涉及多种应用程序，最安全并且推荐的修复方法是重启系统生效。
如果你的系统无法重启，请执行如下命令查询仍然在使用老版本 glibc 的程序。
lsof +c0 -d DEL | awk ‘NR==1 || /libc-/ {print $2,$1,$4,$NF}’ | column -t
根据查询的结果, 识别哪些是对外提供服务的程序，重启对应的服务。

FAQ

1.使用 SELINUX 可以规避这个漏洞吗?
合适的 SELINUX 规则可以限制系统被攻破后的影响，但是由于 DNS 被系统很多基础服务使用，所以 SELINUX 并不能完全规避该漏洞，建议及时进行更新。

2.静态链接的可执行程序是否收到该漏洞的影响?
是的。如果二进制使用存在漏洞版本的 glibc 进行了静态链接，则对应的程序需要使用新版本 glibc 进行重新编译。