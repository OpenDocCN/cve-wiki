# 使用 namp 验证 SSL/TSL 相关漏洞 CVE-2015-2808,CVE-2013-2566,CVE-2014-3566,CVE-2016-2183,CVE-2015-4000,瞬时 Diffie-Hellman 公共密钥过弱 等 - 迪克推多 0 - 博客园

> 原文：[`www.cnblogs.com/zcg-cpdd/p/15573841.html`](https://www.cnblogs.com/zcg-cpdd/p/15573841.html)

一、漏洞说明:

SSL/TLS 受诫礼(BAR-MITZVAH)攻击漏洞(CVE-2015-2808)【原理扫描】--使用了不安全的 RC4 算法

SSL/TLS RC4 信息泄露漏洞(CVE-2013-2566)【原理扫描】                      --使用了不安全的 RC4 算法

SSL/TSL 协议信息泄露(CVE-2016-2183)【原理扫描】                               --使用了不安全的 DES/3DES 算法

SSL/TSL LogJam 中间人安全限制绕过漏洞(CVE-2015-4000)【原理扫描】--使用了不安全的 EXPORT/EXP 算法

SSL 3.0 POODLE 攻击信息泄露漏洞(CVE-2014-3566)【原理扫描】          --使用了不安全的 SSL 3.0 协议

SSL 3.0 降级加密协议 Openssl Padding Oracle 漏洞(CVE-2016-2107)         --使用了不安全的 SSL 3.0 加密协议

SSL/TSL 瞬时 Diffie-Hellman 公共密钥过弱【原理扫描】                           --使用了<=1024 位的 DH 公共密钥

DROWN 跨协议攻击 TLS 漏洞(CVE-2016-0800）                                         --使用了不安全的 SSL 2.0 加密协议及 EXPORT 加密算法

漏洞修复可参考另一篇:

[`www.cnblogs.com/zcg-cpdd/p/14504490.html`](https://www.cnblogs.com/zcg-cpdd/p/14504490.html)

二、安装 Nmap

1.下载 nmap
官网地址：[`nmap.org/download.html`](https://nmap.org/download.html/).

![](img/bb15041437d6492e69b65b3f74c26357.png)

 2.下载的.exe 文件，一路 next 安装。

安装完成之后，将 nmap.exe 执行程序所在的路径添加至环境变量中即可在命令行使用

 ![](img/37ebf998f16e56ac76f742302690c7bd.png)

![](img/6d41aa39a7a5d3e60786c0ce3c6a20d5.png)

 ![](img/6f5d06c5041ca09642c2fedb1dae7c55.png)

三、漏洞验证

以上所有漏洞都可以用以下命令验证

```
nmap -sV --script ssl-enum-ciphers 端口 IP

```

![](img/cc30ad94c35e8f584562c04da25a07e4.png)

可以看到，输出了 443 端口运行的服务 nginx,使用的协议 TSL1.0,TSL1.1,TSL1.2 以及使用的加密算法 DHE,RSA 等。Warnings 处会报出存在的漏洞，此端口没有使用 RC4,DES/3DES,EXP 等弱加密算法及 SSL 弱加密协议，但是存在 dh 1024，所以存在 SSL/TSL 瞬时 Diffie-Hellman 公共密钥过弱【原理扫描】漏洞。

![](img/eb68b620e6680e52a941c489873ec2f8.png)

 可以看到 8000 端口运行了 Tornado 框架编写的服务，使用了 3DES 算法，所以存在 SWEET32 attack，即 SSL/TSL 协议信息泄露(CVE-2016-2183)【原理扫描】漏洞。

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

针对具体的漏洞也可以使用针对性的 nmap 脚本去验证:

比如 验证 SSL/TSL 瞬时 Diffie-Hellman 公共密钥过弱【原理扫描】和 SSL/TSL LogJam 中间人安全限制绕过漏洞(CVE-2015-4000)【原理扫描】可以使用

```
nmap -sV -Pn --script ssl-dh-params 端口 IP
```

验证低安全的 SSHv1，sslv2 协议可以使用

```
nmap -sV -Pn --script sshv1,sslv2-params 端口 IP
```

验证 CVE-2014-0224 ssl-ccs-injection 可以使用

```
nmap -sV -Pn --script ssl-ccs-injection 端口 IP
```

 验证 ssl-cert 证书问题可以使用

```
nmap -sV -Pn --script ssl-cert 端口 IP

```

验证 SSL 证书的有限期可以使用

```
nmap -sV -Pn --script ssl-date 端口 IP

```

验证 Debian OpenSSL keys 可使用

```
nmap -sV -Pn --script ssl-known-key 端口 IP

```

验证 CVE-2014-0160 OpenSSL Heartbleed bug 可使用

```
nmap -sV -Pn --script ssl-heartbleed 端口 IP

```