# windows RDP 远程代码执行 _CVE-2019-0708 漏洞复现 - 雨中落叶 - 博客园

> 原文：[`www.cnblogs.com/yuzly/p/11197021.html`](https://www.cnblogs.com/yuzly/p/11197021.html)

windows RDP 远程代码执行 _CVE-2019-0708 漏洞复现

**一、漏洞概述**

2019 年 5 月 14 日微软官方发布安全补丁,修复了 windows 远程桌面服务的远程代码执行漏洞,该漏洞影响了某些旧版本的 Windows 系统。此漏洞是预身份验证且无需用户交互,这就意味着这个漏洞可以通过网络蠕虫的方式被利用。利用此漏洞的任何恶意软件都可能从被感染的计算机传播到其他易受攻击的计算机。

**二、漏洞影响版本**

Windows 7

Windows server 2008 R2

Windows server 2008

Windows 2003

Windows xp

注:Windows 8 和 windows10 以及之后的版本不受此漏洞影响

**三、漏洞环境搭建**

目标机:windows 7  IP:192.168.10.171

攻击机:kali 系统、另一台 win7(安装 python3 环境,安装 impacket 模块)

条件:目标机开启 3389 端口,关闭防火墙

**四、漏洞复现**

1、 目标 3389 端口,关闭防火墙(或者在防火墙策略中放行 3389 端口)

2、 使用 msf 中相应的模块验证是否存在漏洞

2.1、升级 msf 版本

     apt-get update

     apt-get install metasploit-framework

     注意:不升级 msf,使用 msf v4 版本加载第三方脚本,会报错,可能只因为 cve-2019-0708 的脚本只兼容最新的 msf 版本(msf v5)

2.2、启动 msf,可以看到 msf 当前的版本

　　![](img/e36bd18f837d8e7bc1da2cbf0e96c460.png)

2.3、搜索 cve-2019-0708 脚本

　　![](img/d98cc9dfec23d1534ee6ccc743ffd247.png)

 2.4、使用脚本,设置参数

　　![](img/4c14e53e6236e5b935a17ced55c11fc8.png)

2.5、开始攻击,下图说明目标存在漏洞

　　![](img/9d516e56b85282b7d49c721dd9906c96.png)

3、win7 攻击机安装 python3.6，安装 impacket 模块

　　![](img/b6b3390017a6d1905372c83bec55433b.png)

4、下载 POC，然后运行 POC

　　POC 下载地址: [`github.com/n1xbyte/CVE-2019-0708`](https://github.com/n1xbyte/CVE-2019-0708)

　　![](img/7c3b1874dd811f31f2f5fad9e343eb83.png)

5、 POC 运行之后,目标机器蓝屏了

　　![](img/f25574ef34466231e0efa57d871f706b.png)

6、下载补丁,安装补丁,补丁下载地址: [`portal.msrc.microsoft.com/zh-cn/security-guidance/advisory/CVE-2019-0708`](https://portal.msrc.microsoft.com/zh-cn/security-guidance/advisory/CVE-2019-0708)

　　![](img/df08e85a307c4800b3cf4c6e6a7f8270.png)

　　![](img/1c35ece24b29fc52d4140f9c0e294f93.png)

7、安装完补丁之后,需要重启电脑,补丁才能生效,再次验证目标机,下图可以看到目标不存在漏洞了　![](img/539d2173377134e4e6628209b8a1b165.png)

**五、漏洞防御**

1、 关闭远程桌面、开启防火墙

2、 更新系统

------------------------------------------------------------------------------------------------

Windows CVE-2019-0708 EXP:[`www.cnblogs.com/yuzly/p/11485316.html`](https://www.cnblogs.com/yuzly/p/11485316.html)