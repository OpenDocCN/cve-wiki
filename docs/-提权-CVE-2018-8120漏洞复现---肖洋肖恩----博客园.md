# [提权]CVE-2018-8120 漏洞复现 - 肖洋肖恩、 - 博客园

> 原文：[`www.cnblogs.com/-mo-/p/11404598.html`](https://www.cnblogs.com/-mo-/p/11404598.html)

### 0x01 漏洞名称

Windows 操作系统 Win32k 的内核提权漏洞

### 0x02 漏洞编号

CVE-2018-8120

### 0x03 漏洞描述

部分版本 Windows 系统 win32k.sys 组件的 NtUserSetImeInfoEx()系统服务函数内部未验证内核对象中的空指针对象,普通应用程序可利用该空指针漏洞以内核权限执行任意代码

### 0x04 影响版本

以下软件版本受到影响。未列出的版本要么超过其支持生命周期，要么不受影响。要确定软件版本或版本的支持生命周期，请查阅 Microsoft 支持生命周期。

```
Windows 7 for 32-bit Systems Service Pack 1   
Windows 7 for x64-based Systems Service Pack 1      
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for 32-bit Systems Service Pack 2
Windows Server 2008 for Itanium-Based Systems ServicePack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 for x64-based Systems Service Pack 2
Windows Server 2008 R2 for Itanium-Based Systems ServicePack 1
Windows Server 2008 R2 for x64-based Systems ServicePack 1
Windows Server 2008 R2 for x64-based Systems ServicePack 1 
```

### 0x05 样本来源

分析环境：分析和调试的过程将在 Windows 7 x64 为基础的环境中进行

样本来源：[`github.com/unamer/CVE-2018-8120`](https://github.com/unamer/CVE-2018-8120)
优化后的样本：[`github.com/alpha1ab/CVE-2018-8120`](https://github.com/alpha1ab/CVE-2018-8120)

### 0x06 漏洞利用

```
CVE-2018-8120.exe "whoami" 
```

![](img/1f2c43a1db57631e9a9da0efd0fe1855.png)

### 0x07 修复建议

目前微软在 2018 年五月的安全更新中已经包含了针对该漏洞的补丁程序，安装使用即可避免受到该漏洞的影响。

漏洞修复程序下载地址:

[`portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8120`](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8120)

### 0x08 参考链接

[关于 CVE-2018-8120 的最新 Windows 提权漏洞分析](https://www.freebuf.com/vuls/174183.html)

[CVE-2018-8120 漏洞复现](https://mp.weixin.qq.com/s?__biz=MzUyMTAyODYwNg==&mid=2247485419&idx=1&sn=d05f79ac32b1166fdc9458b8eadcf8ac&chksm=f9e0117ace97986cb14ef1396c197d438da8af7d7fc2491d0bd195c9f22baa070bcad485305b&mpshare=1&scene=23&srcid=&sharer_sharetime=1566620897514&sharer_shareid=d32981e13d51bf06188894426d2a54e5#rd)