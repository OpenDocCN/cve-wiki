# OpenSSH CBC 模式 弱加密算法漏洞(CVE-2008-5161) - -小-白- - 博客园

> 原文：[`www.cnblogs.com/xiongty/p/16051018.html`](https://www.cnblogs.com/xiongty/p/16051018.html)

​

**1、简述**

      OpenSSH 是一种开放源代码的 SSH 协议的实现，初始版本用于 OpenBSD 平台，现在已经被移植到多种 Unix/Linux 类操作系统下，系统默认会选择 CBC 的加密模式。
      OpenSSH 没有正确的处理分组密码加密算法的 SSH 会话所出现的错误，当在密码块链接 (CBC) 模式下使用块密码算法时，使远程攻击者更容易通过未知向量从 SSH 会话中的任意密文块中恢复某些明文数据。

**2、查看加密算法**
我们可以查看目前 sshd 支持的加密算法：man ssh_config

![](img/215216145f8c29fbe52edaf6a01afb8b.png)![](img/9b4630182a9d8e09019b3e59d93b30c5.png "点击并拖拽以移动")​

 首先查看当前加密算法都有哪些

使用 nmap

```
nmap --script "ssh2*" ip 地址
```

![](img/9b4630182a9d8e09019b3e59d93b30c5.png "点击并拖拽以移动")

我们会看到当前系统默认支持的所有加密算法，包括弱加密算法

![](img/11ef4037f16c5adfb39669aac12f3ea3.png)![](img/9b4630182a9d8e09019b3e59d93b30c5.png "点击并拖拽以移动")​

** 3、解决**

处理办法是在 sshd_config 中指定加密算法，把默认的 CBC 加密模式改成 CTR，然后重启 sshd 服务

```
[root@localhost ~]# echo 'Ciphers aes128-ctr,aes192-ctr,aes256-ctr' >> /etc/ssh/sshd_config 
[root@localhost ~]# systemctl restart sshd
```

![](img/9b4630182a9d8e09019b3e59d93b30c5.png "点击并拖拽以移动")

再查看一下目前系统支持的加密算法

![](img/27ef8fcebca147804cae0e80e1d627e2.png)![](img/9b4630182a9d8e09019b3e59d93b30c5.png "点击并拖拽以移动")​

​