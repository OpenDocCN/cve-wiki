# Linux 中 OpenSSH 输入验证错误漏洞(CVE-2019-16905) 修复解决方案 - 四海骄阳 - 博客园

> 原文：[`www.cnblogs.com/zhoading/p/13949353.html`](https://www.cnblogs.com/zhoading/p/13949353.html)

[`www.o6c.com/java/2020/11/01/1432.html`](https://www.o6c.com/java/2020/11/01/1432.html)

 https://blog.csdn.net/sunmenggmail/article/details/42526117

https://blog.csdn.net/baidu_36209638/article/details/109121765

https://blog.csdn.net/asdfrt8686/article/details/101692580?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.pc_relevant_is_cache&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.pc_relevant_is_cache

[江风成](https://www.o6c.com/author/jiangfengcheng)  2020-11-01 02:11 评论 0 阅读 84 　

![Linux 中 OpenSSH 输入验证错误漏洞(CVE-2019-16905) 修复解决方案-上流阁](img/b8c3e850e9085342ac8f98f16efd9794.png)

解决方案：

redhat6、7 与 centos6、7 版本升级到 openssh8.1 版本与 openssl-1.1.1 自动化脚本，解决 linuxOpenSSH 输入验证错误漏洞(CVE-2019-16905)

解决步骤：

1、附件

[`www.o6c.com/wp-content/uploads/2020/11/漏洞修补文件命令.rar`](https://www.o6c.com/wp-content/uploads/2020/11/%E6%BC%8F%E6%B4%9E%E4%BF%AE%E8%A1%A5%E6%96%87%E4%BB%B6%E5%91%BD%E4%BB%A4.rar)

2、解压升级包
tar --no-same-owner -zxvf zlib-1.2.11.tar.gz
tar --no-same-owner -zxvf openssh-8.3p1.tar.gz
tar --no-same-owner -zxvf openssl-1.1.1g.tar.gz
3、编译安装 zlib

cd zlib-1.2.11
./configure --prefix=/usr/local/zlib
make && make install
4、编译安装 openssl

cd openssl-1.1.1g
./config --prefix=/usr/local/ssl -d shared
make && make install
echo '/usr/local/ssl/lib' >> /etc/ld.so.conf
ldconfig -v
5、安装 openssh

cd openssh-8.3p1
./configure --prefix=/usr/local/openssh --with-zlib=/usr/local/zlib --with-ssl-dir=/usr/local/ssl
make && make install
6、sshd_config 文件修改

echo 'PermitRootLogin yes' >>/usr/local/openssh/etc/sshd_config
echo 'PubkeyAuthentication yes' >>/usr/local/openssh/etc/sshd_config
echo 'PasswordAuthentication yes' >>/usr/local/openssh/etc/sshd_config
7、备份原有文件，并将新的配置复制到指定目录

复制代码
mv /etc/ssh/sshd_config /etc/ssh/sshd_config.bak
cp /usr/local/openssh/etc/sshd_config /etc/ssh/sshd_config

mv /usr/sbin/sshd /usr/sbin/sshd.bak
cp /usr/local/openssh/sbin/sshd /usr/sbin/sshd

mv /usr/bin/ssh /usr/bin/ssh.bak
cp /usr/local/openssh/bin/ssh /usr/bin/ssh

mv /usr/bin/ssh-keygen /usr/bin/ssh-keygen.bak
cp /usr/local/openssh/bin/ssh-keygen /usr/bin/ssh-keygen

mv /etc/ssh/ssh_host_ecdsa_key.pub /etc/ssh/ssh_host_ecdsa_key.pub.bak
cp /usr/local/openssh/etc/ssh_host_ecdsa_key.pub /etc/ssh/ssh_host_ecdsa_key.pub
复制代码
8、启动 sshd

service sshd restart
9、查看信息版本

ssh -V
10、升级完成后 sftp 登录后瞬间断开问题

修改/etc/ssh/sshd_config 文件中 sftp 路径，改为
Subsystem sftp /usr/libexec/sftp-server