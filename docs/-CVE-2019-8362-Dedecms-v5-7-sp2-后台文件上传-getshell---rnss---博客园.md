# （CVE-2019-8362）Dedecms v5.7 sp2 后台文件上传 getshell - rnss - 博客园

> 原文：[https://www.cnblogs.com/rnss/p/13740764.html](https://www.cnblogs.com/rnss/p/13740764.html)

# 漏洞分析

dede/album_add.php

![](../Images/3fea3478c7787274cbab1e1c8048fa65.png)

 175行将'jpg|png|gif'作为第二个参数传入GetMatchFiles函数，跟进

![](../Images/a370df10237c901d37cedbd3b031f5ea.png)

 161行只匹配了前面传入的三种后缀，也就是说只要文件名包含这三种后缀其中之一即合法

那么我们可以构造1.jpg.php的文件名，即可getshell

# 漏洞复现

首先创建一个1.jpg.php文件，内容为 <?php phpinfo(); ?> 

然后将它压缩为zip文件

![](../Images/3670522863b5318e72566b6a5644bc77.png)

 ![](../Images/b0d87705f1bae209cac3d157b33469e9.png)

 ![](../Images/5f6ce941a53f2a83721271bce472304e.png)

 将压缩包上传到soft目录下

![](../Images/7e59a5efd1ac930f8347bd9395187043.png)

 接着访问dede/album_add.php，选择从 从ZIP压缩包中解压图片（提前创建一个图片集栏目）

![](../Images/d818cbc0e88da8dcc1d18c1dccb9b24a.png)

 确定后选择预览文档

![](../Images/85cdcda4c20947aecdbecc5b91d83fc4.png)

 ![](../Images/a51cc32de179f57a170fc29b2c8bfd03.png)