# （CVE-2019-8362）Dedecms v5.7 sp2 后台文件上传 getshell - rnss - 博客园

> 原文：[`www.cnblogs.com/rnss/p/13740764.html`](https://www.cnblogs.com/rnss/p/13740764.html)

# 漏洞分析

dede/album_add.php

![](img/3fea3478c7787274cbab1e1c8048fa65.png)

 175 行将'jpg|png|gif'作为第二个参数传入 GetMatchFiles 函数，跟进

![](img/a370df10237c901d37cedbd3b031f5ea.png)

 161 行只匹配了前面传入的三种后缀，也就是说只要文件名包含这三种后缀其中之一即合法

那么我们可以构造 1.jpg.php 的文件名，即可 getshell

# 漏洞复现

首先创建一个 1.jpg.php 文件，内容为 <?php phpinfo(); ?> 

然后将它压缩为 zip 文件

![](img/3670522863b5318e72566b6a5644bc77.png)

 ![](img/b0d87705f1bae209cac3d157b33469e9.png)

 ![](img/5f6ce941a53f2a83721271bce472304e.png)

 将压缩包上传到 soft 目录下

![](img/7e59a5efd1ac930f8347bd9395187043.png)

 接着访问 dede/album_add.php，选择从 从 ZIP 压缩包中解压图片（提前创建一个图片集栏目）

![](img/d818cbc0e88da8dcc1d18c1dccb9b24a.png)

 确定后选择预览文档

![](img/85cdcda4c20947aecdbecc5b91d83fc4.png)

 ![](img/a51cc32de179f57a170fc29b2c8bfd03.png)