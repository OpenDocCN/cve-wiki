# 微软漏洞 CVE-2015-1635(MS15-034)补丁 KB3042553 无法安装及安装之后还被扫到漏洞的排查过程 - 迪克推多 0 - 博客园

> 原文：[`www.cnblogs.com/zcg-cpdd/p/14503780.html`](https://www.cnblogs.com/zcg-cpdd/p/14503780.html)

一、KB3042553 补丁提示不能安装的解决办法

windows server 2012 R2 Standard x64 安装 KB3042553 补丁，报出 “此更新不适用于您的计算机”。

通常情况下，以下情况可能会出现更新不适用的报错信息：
1\. 缺少必要更新。
根据“MS15-034：HTTP.sys 中的漏洞可能允许远程执行代码：2015 年 4 月 14 日”中的描述，提示 WS 2012 R2 安装 KB3042553 需要先决\必要更新 KB2919355:
[`support.microsoft.com/zh-cn/help/3042553/ms15-034-vulnerability-in-http-sys-could-allow-remote-code-execution-a`](https://support.microsoft.com/zh-cn/help/3042553/ms15-034-vulnerability-in-http-sys-could-allow-remote-code-execution-a)

KB 2919355:
[`support.microsoft.com/zh-cn/help/2919355/windows-rt-8-1--windows-8-1--and-windows-server-2012-r2-update-april-2`](https://support.microsoft.com/zh-cn/help/2919355/windows-rt-8-1--windows-8-1--and-windows-server-2012-r2-update-april-2)

2\. 已经安装了取代更新。
可以在 Windows Update Catalog 网站查询到 KB3042553 的具体信息，包括取代更新。打开以下链接，单击“Windows Server 2012 R2 安全更新程序（KB3042553）“，打开”Package Details“标签，可以查看替代更新：
[`www.catalog.update.microsoft.com/Search.aspx?q=3042553`](https://www.catalog.update.microsoft.com/Search.aspx?q=3042553)

3\. 已经安装了该更新。
通过以下 PowerShell 命令列出已安装的更新：
Get-hotfix

然后确认该更新，或者其替换更新是否已经安装。

4\. 下载的更新安装包不适用于当前系统。
请访问以下链接，重新下载并安装 KB3042553 – 选择适用于系统的语言版本，然后单击下载：
[`www.microsoft.com/en-us/download/details.aspx?id=46500`](https://www.microsoft.com/en-us/download/details.aspx?id=46500)二、安装此补丁之后，在补丁列表里能查到，但是还是能被扫描出来可能有以下几种情况:1.首先确定安装的补丁与操作系统匹配，在补丁列表能查到。并且安装补丁之后需要重启系统。2.补丁安装列表显示安装成功，实际上补丁文件并未更新生效。1)首先查找对应 MS 漏洞在微软官网的说明，找到对应 windows 版本的知识库文章：比如 MS15-034，到微软官网查找此漏洞的安全公告：*http://technet.microsoft.com/security/bulletin/MS15-034*

***从公告中点击进去汇总的知识库文章(公告顶部的蓝色字体链接，有知识库文章字样)，找到对应操作系统此漏洞更新的文件信息(看文件版本及日期)。
MS15-034 这个漏洞只更新了 http.sys 文件，检查此文件就行。其他漏洞可能会看到更新的文件有很多，可以重点查找下 srv.sys 等文件（微软补丁大多数会对此文件更新，如果某个补丁没有更新此文件，那么按照此方法在更新文件列表中任意挑选一个去对比系统中的文件是否更新成功）***

***![](img/6e3c7ea1e188485afea4501f15cfcf2e.png)***

***![](img/830254c0e412be95978ee4dda9f25472.png)
2)进入目标机 c:\windows\system32\drivers\,查看漏洞更新的主文件信息。如 http.sys,右键->属性->详细信息，将目标机文件信息与微软提供的漏洞更新文件信息对比，如果低于微软提供的文件版本及日期，可以确定此补丁没有更新成功。***

***![](img/1a2330bc2e53a90211f0a5fcf87c36fb.png)
3)解决方法:卸载原补丁，重新安装，重启电脑，再去检查文件版本是否更新。如果更新成功再去扫描问题解决。***

 *****3.按以上步骤操作完了，重新安装补丁并且重启了，但是文件版本还是没有改变。*****

1)一般这种情况是因为没有安装此补丁的前置补丁造成的，比如可以在网上搜索"KB3042553 补丁提示不能安装的解决办法",找到此补丁的前置补丁号，对比目标机是否安装，如果没安装则先安装前置补丁，重启，再安装此补丁，查看版本信息是否已经更新。
2)安装前置补丁失败，就再用同样的方法找到前置补丁的前置补丁，逐一安装，重启，直至最终需要安装的补丁成功(文件信息更新).

注:CVE-2015-1635 此漏洞的补丁安装顺序为 KB2919442->KB2919355->kb3042553.