# 13.Weblogic 任意文件上传漏洞（CVE-2018-2894）复现 - bmjoker - 博客园

> 原文：[`www.cnblogs.com/bmjoker/p/9825497.html`](https://www.cnblogs.com/bmjoker/p/9825497.html)

##### **Weblogic 任意文件上传漏洞（CVE-2018-2894）复现**

**漏洞背景**

> WebLogic 管理端未授权的两个页面存在任意上传 getshell 漏洞，可直接获取权限。两个页面分别为/ws_utc/begin.do，/ws_utc/config.do。

**影响范围**

> Oracle WebLogic Server，版本 10.3.6.0，12.1.3.0，12.2.1.2，12.2.1.3。

**漏洞详情**

[`www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html#AppendixFMW`](http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html#AppendixFMW)

**漏洞复现**本次漏洞环境是用 docker 搭建的，环境启动后，访问 Weblogic 控制台：![](img/110f75a5c396ad27fdfebcd22721eb35.png)

应为是本地搭建环境，所以在登陆日志中寻找登陆密码：``docker-compose logs | grep password``
![](img/c56cdf351902a77a60deeb4ef7fc160f.png)

可得登陆用户名密码为：weblogic/eZh6Cefm

正常的环境是判断是否存在 weblogic 弱口令，或者根据版本信息来读取敏感文件，比如，或者后台用户密文与密钥文件，或者就像登陆日志 logs 之类的，来得到登陆密码。得到用户名密码后，我们尝试登陆后台页面，点击 base_domain 的配置，在“高级”中开启“启用 Web 服务测试页”选项:![](img/d4b26cdb3525002ccf71c75bd1210aaa.png)

保存配置

访问 http://192.168.0.132:7001/ws_utc/config.do ，设置 Work Home Dir 为

/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css。

我将目录设置为 ws_utc 应用的静态文件 css 目录，访问这个目录是无需权限的，这一点很重要。

![](img/8612bd93e8f084bfa75c4c9542d20492.png)

然后点击安全 -> 增加，然后上传 webshell：

![](img/d87a165ea8f7bcd234e8cce066a9e29c.png)

点击提交之后,可是使用 Burpsuite 拦截返回的数据包来寻找返回的时间戳 ID

![](img/d628e7799e36b02f73fc14c16811ccaf.png)

也可以通过浏览器的调试台来寻找返回的时间戳 ID。F12 打开调试台。

![](img/9def1fce6482f9a727a0a96945961fba.png)

刷新可看到的确上传成功

![](img/5a5a594d48d822b7e63b8f2b232ff75e.png)

然后访问：http://your-ip:7001/ws_utc/css/config/keystore/[时间戳]_[文件名]，即可执行 webshell

![](img/65bbb16eff43091a02292df0c09cde40.png)

![](img/549aee74ab75b773b82e0f48d1f99460.png)

成功 get webshell

**漏洞需要满足条件：**

*   需要知道部署应用的 web 目录
*   ws_utc/config.do 在开发模式下无需认证，在生产模式下需要认证。具体可见 Oracle® Fusion Middleware Administering Web Services

**参考链接：**

[`www.seebug.org/vuldb/ssvid-97423`](https://www.seebug.org/vuldb/ssvid-97423)

[`github.com/vulhub/vulhub/tree/master/weblogic/CVE-2018-2894`](https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2018-2894)