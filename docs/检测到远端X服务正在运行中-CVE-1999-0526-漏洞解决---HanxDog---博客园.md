# 检测到远端 X 服务正在运行中(CVE-1999-0526)漏洞解决 - HanxDog - 博客园

> 原文：[`www.cnblogs.com/mgds/p/15765681.html`](https://www.cnblogs.com/mgds/p/15765681.html)

检测到远端 X 服务正在运行中(CVE-1999-0526)，
详细描述:
X11 协议是一种基于客户端/服务器模型的协议。X Server 监听在 6000/TCP 端口，接受客户端发来的各种命令请求，服务器执行完命令后将事件返回给客户端。
如果允许从任意 IP 连接 X Server 的话，攻击者可能登录 X Server 并记录使用同一 X Server 的其它 X Client 的所有击键操作，这将包括帐号、密码等敏感信息。
方案一：切换系统运行级别
　　查看默认的 target
　　 # systemctl get-default
　　  　　graphical.target
　　开机以命令模式启动，设置系统的默认运行级别为 3
　　 # systemctl set-default multi-user.target
　　　　Removed symlink /etc/systemd/system/default.target.
　　　　Created symlink from /etc/systemd/system/default.target to /usr/lib/systemd/system/multi-user.target.
注意！！！需要重启服务器生效，重启后再次进行安全扫描就不会出现次高危项
　　查看当前系统的运行级别
　　[root@apenglinux ~]# runlevel
　　3 5

方案二：通过防火墙禁用 6000 端口，适用于 redhat7.x linux7.x centos7.x

　　#启动防火墙
　　#systemctl start firewalld
　　#开启 6000 端口
　　#firewall-cmd --zone=public --add-port=6000/tcp –permanent
　　#移除 6000 端口
　　#firewall-cmd --zone=public --remove-port=6000/tcp --permanent

　　#重启防火墙
　　#firewall-cmd --reload
　　#查看已开放的端口
　　#firewall-cmd --list-ports

方案三：kill 掉 X 服务，禁用 X 服务的脚本监听

　　查看系统对外开放的端口
　　#netstat –tunlp
　　#kill -9 监听 6000 端口的 pid

　　#type -a startx

　　　　**startx is /usr/bin/startx**

**　　#vim /bin/startx**

****将脚本中的*serverargs=“”替换为*　　serverargs=“-nolisten tcp”****
　　#vim /usr/bin/startx
　　将脚本中的*serverargs=“”替换为*　　serverargs=“-nolisten tcp”**** 

**方案四：关闭 x 服务**

**service gdm3 stop 或者 systemctl stop gdm 命令关闭 x 服务**