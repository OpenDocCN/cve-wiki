# 漏洞复现 - Tomcat任意文件上传漏洞（CVE-2017-12615） - Sally_Zhang - 博客园

> 原文：[https://www.cnblogs.com/sallyzhang/p/12341711.html](https://www.cnblogs.com/sallyzhang/p/12341711.html)

**漏洞原理**

Tomcat配置文件web.xml中，servlet配置了readonly=fasle时，会引发任意文件上传漏洞。

readonly参数默认是true，即不允许delete和put操作，所以通过XMLHttpRequest对象的put或者delete方法访问就会报告http 403错误。但很多时候为了支持REST服务，会设置该属性为false。 

**复现环境**

在ubuntu 16.04虚拟机中用vulhub靶场提供的docker容易来复现

jdk版本1.7

Tomcat版本8.5.19

****复现过程****

1\. 进入vulhub目录：tomcat/CVE-2017-12615

2.启动docker容器，tomcat页面正常访问：

![](../Images/17aa00fe1ca269697666b87ee0ae7d3f.png)

进入容器查看一下web.xml的readonly配置：

![](../Images/a9b2e13bed56cfe6eafc74d44ca9244d.png)

3\. 抓包，尝试上传jsp木马，没成功，不能直接传jsp文件

![](../Images/645fdcf3e27e5f9596b2350d8ffe0214.png)

4.绕过以下，再次上传(其他类型的文件也可以上传的，传jsp文件是方便执行jsp中的代码)：

![](../Images/be4e7cfc4f3a639dc67de4a9c04b4c72.png)

5.进入docker容器内部查看上传文件：

![](../Images/f7d4fea39fc71a670401b1ae8a9d1382.png)

6.访问该文件，执行成功：

![](../Images/f57e2273cd5698dba978768e2d7b36ee.png)

**防御实验**

将readonly参数改为false，在发一次PUT请求：

![](../Images/9c92fbedc638fce45094d38f1eda1ce9.png)

![](../Images/0821d1691f935e42e3b761ed22755e97.png)

****本文仅用于技术学习和交流，严禁用于非法用途，否则产生的一切后果自行承担。****