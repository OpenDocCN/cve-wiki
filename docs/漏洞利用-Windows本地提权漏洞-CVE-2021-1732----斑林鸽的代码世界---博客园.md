# 漏洞利用：Windows 本地提权漏洞(CVE-2021-1732) - 斑林鸽的代码世界 - 博客园

> 原文：[`www.cnblogs.com/mutudou/p/16202490.html`](https://www.cnblogs.com/mutudou/p/16202490.html)

## 0x00 简介

2021 年 2 月 10 日，微软每月的例行补丁包中修复了一个 Windows 系统本地提权漏洞，本地攻击者可以利用此漏洞提升到 system 权限，据称此漏洞被用于定向攻击活动。

## 0x01 漏洞概述

该漏洞由函数 win32kfull!xxxCreateWi ndowEx 对应用层回调返回数据校验不严导致，本地用户执行漏洞利用程序获取系统权限。

## 0x02 影响范围

Windows Server, version 20H2 (Server Core Installation)

Windows 10 Version 20H2 for ARM64-based Systems

Windows 10 Version 20H2 for 32-bit Systems

Windows 10 Version 20H2 for x64-based Systems

Windows Server, version 2004 (Server Core installation)

Windows 10 Version 2004 for x64-based Systems

Windows 10 Version 2004 for ARM64-based Systems

Windows 10 Version 2004 for 32-bit Systems

Windows Server, version 1909 (Server Core installation)

Windows 10 Version 1909 for ARM64-based Systems

Windows 10 Version 1909 for x64-based Systems

Windows 10 Version 1909 for 32-bit Systems

Windows Server 2019 (Server Core installation)

Windows Server 2019

Windows 10 Version 1809 for ARM64-based Systems

Windows 10 Version 1809 for x64-based Systems

Windows 10 Version 1809 for 32-bit Systems

Windows 10 Version 1803 for ARM64-based Systems

Windows 10 Version 1803 for x64-based Systems

## 0x03 环境搭建

1，首先下载我们本次的复现环境的系统，地址：[`msdn.itellyou.cn/`](https://link.zhihu.com/?target=https%3A//msdn.itellyou.cn/)

 ![](img/3d1af71141a60ceb549922f188b18585.png)

2，然后我们选择 windows10 的 1909 版本

 ![](img/be6c1ff47c8b7b7179a2872005648570.png)

3，然后我们在虚拟机里面安装这个 windows10 的版本，这里安装过程我们省略，可以自行百度

 ![](img/e1acd6f1a4e6fcca1babd21eb6056c1a.png)

## 0x04 漏洞复现

1，首先我们下载漏洞复现的 exp

地址：[`github.com/shanfenglan/test/blob/master/cve-2021-1732.exe`](https://link.zhihu.com/?target=https%3A//github.com/shanfenglan/test/blob/master/cve-2021-1732.exe)

 ![](img/95bdbfb00568b1093f880c782971ef7d.png)

2，创建一个普通用户 test

![](img/20dcd86191d95f62ae9105afaeee5954.png)

3，然后运行 exp

 ![](img/d2e6f2ed92db911824112da8556af772.png)

4，可以运行添加一下用户

 ![](img/91a03f8d67e342b97ca12d9705c8242b.png)

 自此提权完成