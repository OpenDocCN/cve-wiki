# BUUCTF-Web-Warm Up(CVE-2018-12613) - ch0bits - 博客园

> 原文：[https://www.cnblogs.com/echoDetected/p/12346669.html](https://www.cnblogs.com/echoDetected/p/12346669.html)

**题目（虽然是Warm up，但一点也不简单）：**
![](../Images/2684fda5b9f5b7630c3f7b7e24ec0832.png)

**打开只有图片，源码里面提示了source.php**

![](../Images/b7d7496d584bf1c2ab60bd2b045a73ac.png)

**查看source.php：**

![](../Images/a8a57b6c495719fa76d5c7eae968d346.png)

![](../Images/baa30bf4711d2246f0db1a74969e8f27.png)

**php代码里又提到了hint，去查看一下：**

![](../Images/6c00409b910cd8cca64ffd9efd194850.png)

**提示flag在如上图文件名里面**

**尝试用?file=ffffllllaaaagggg查看，返回false**

![](../Images/1f3350457a5a74e39bcb79e8b03338f3.png)

* * *

**php代码只学过点入门，只看懂基本的，查看其他人的WP，发现是一个存在的公共漏洞：[https://www.cnblogs.com/leixiao-/p/10265150.html](https://www.cnblogs.com/leixiao-/p/10265150.html)（CVE-2018-12613）**

**拿去百度源码，查看漏洞原理：**

![](../Images/8d30f66f3959c72b3ddcb4865103e3c5.png)

![](../Images/5916ee53f41d222bedbb1b0c5ac7b0e9.png)

* * *

![](../Images/a552fcc7110412bb946c87d2a3f1fcbc.png)

**顺着漏洞文件包含，构造如下payload，造成目录穿越：**

**其中'%253f'进行了二次UrlEncode，它其实就是'?'**

```
http://05916a47-5af7-4b86-8bb0-76d29ec0390b.node3.buuoj.cn/?file=hint.php%253f/../../../../../../../../../ffffllllaaaagggg
```

**返回flag：**

![](../Images/c9b7a51a4d05f2d1e2cbb007141a0e03.png)