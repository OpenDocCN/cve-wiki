# 【漏洞复现系列】超详细复现过程 _CVE-2021-2109_Weblogic Server 远程代码执行漏洞复现 _JDK 版本对比 - 4andao - 博客园

> 原文：[`www.cnblogs.com/4andao/p/14317388.html`](https://www.cnblogs.com/4andao/p/14317388.html)

# 0x00 前言与备注

前言：网上已经有很多关于 CVE-2021-2109 漏洞的复现文章了，本人对此漏洞的修复方案比较感兴趣，所以就有了此（shui）文。网上流传的修复建议说明 JDK 6u201、7u191、8u182、11.0.1 版本或以上的 weblogic 不受此漏洞的影响，见下图。特此测试一下。
![](img/7e99b9bcbe6044cba7c2da731114eedd.png)

备注：由于偷懒没有自己搭建环境，找的是网上公开靶场，所以对比的是 JDK 7 和 8 两个版本下的 weblogic。根据修复方案的说明，其中 7u80 是受影响的，8u202 是不受影响的。如果能搭建两个 JDK 大版本一致、小版本不一致的环境，效果会更好，比如 7u80、7u191。
P.S. 影响版本
WebLogic 10.3.6.0.0
WebLogic 12.1.3.0.0
WebLogic 12.2.1.3.0
WebLogic 12.2.1.4.0
WebLogic 14.1.1.0.0

# 0x01 环境和工具

*   靶场：找公开靶场或自行搭建，推荐 vulhub 的 CVE-2020-14882 靶场。搭建命令：

```
git clone https://github.com/vulhub/vulhub.git
cd vulhub/weblogic/CVE-2020-14882
docker-compose up -d 
```

*   攻击机：以下过程使用了两台攻击机，其实本地复现的话，一台机器就行。
*   工具：JNDI-Injection-Exploit-1.0-SNAPSHOT-all。github 搜索就能找到。
*   PoC 来自：[`mp.weixin.qq.com/s/ls9Qo4uBE-V0zaNx6_TLuA。感谢渗透 Xiao 白帽师傅。`](https://mp.weixin.qq.com/s/ls9Qo4uBE-V0zaNx6_TLuA%E3%80%82%E6%84%9F%E8%B0%A2%E6%B8%97%E9%80%8FXiao%E7%99%BD%E5%B8%BD%E5%B8%88%E5%82%85%E3%80%82)

# 0x02 在 7u80 的环境

靶场环境
![](img/49add2c1f282dcac3c649d7d2ff5d16d.png)

攻击机 1 起 JNDI 服务
![](img/5c8c197bd2b3debc0b61cc644e3fb8aa.png)
攻击机 2 执行 PoC
![](img/f127db18b4b4ac3f2ed43bdba670779c.png)

成功执行命令
![image-20211221092140728](img/f8d66780aab46aa2045bb74535ea5ad2.png)

# 0x04 在 8u202 的环境

靶场环境
![](img/823ebad0e4da7aceb034fbc27f05a9d9.png)

攻击机 1 起 JNDI 服务
![](img/d1a12ba67ada4ee59d527a473bd980f3.png)

攻击机 2 执行 PoC
![](img/305084d75dc4b79a26f092d24b2b64d5.png)

执行命令失败
![](img/6d7033502730691a5d451e6b30a4e354.png)

# 0x05 总结

JDK 6u201、7u191、8u182、11.0.1 版本或以上不受 CVE-2021-2109 漏洞的影响，至于原因，图片也已经说明清楚，不再赘述。
![](img/bd1b09260b337367291b73b314d6f709.png)