# Apache HTTPD 换行解析漏洞（CVE-2017-15715） - 不愿透露姓名的汤姆猫 - 博客园

> 原文：[https://www.cnblogs.com/wenyoudo/p/14372802.html](https://www.cnblogs.com/wenyoudo/p/14372802.html)

**0x00介绍**

* * *

apache 2.4.0~2.4.29版本中存在一个解析漏洞，在解析PHP时，1.php\x0A将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。

**0x01复现过程**

* * *

上传3.php被拦截

![](../Images/570d3717ccdf2fd13bd758c291e1aa3b.png)

![](../Images/4bafd04d12305e84852e8d4d3f152e1b.png)

提交文件，抓包修改数据包。在3.php（名称可自定义）后面插入一个\x0A（注意，不能是\x0D\x0A，只能是一个\x0A。其中\x0D为\r的16进制，为回车符；\x0A为\n的16进制，为换行符），不再拦截

在十六进制符php（70）后面插入字节0a

![](../Images/1f12561fae1a5b3ff614396a4be881f5.png)

![](../Images/279b5ad74f1f1be2ee39eca8bb151b66.png)

 成功上传，访问刚才提交的文件

 ![](../Images/a91b6b0d02f852ba1d6e58441dcac94d.png)

 0x02漏洞防御

* * *

1、升级到最新版本
2.、或将上传的文件重命名为为时间戳+随机数+.jpg的格式并禁用上传文件目录执行脚本权限