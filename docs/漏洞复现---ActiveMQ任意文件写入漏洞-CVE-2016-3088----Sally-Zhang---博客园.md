# 漏洞复现 - ActiveMQ任意文件写入漏洞（CVE-2016-3088） - Sally_Zhang - 博客园

> 原文：[https://www.cnblogs.com/sallyzhang/p/12302540.html](https://www.cnblogs.com/sallyzhang/p/12302540.html)

**漏洞原理**

fileserver是Apache ActiveM提供的一个RESTful API接口，可通过GET、PUT、DELETE等HTTP请求对文件进行读写操作，设计目的是为了弥补消息队列操作不能传输、存储二进制文件的缺陷，在文件操作过程中出现了任意文件读写漏洞。

**影响版本**

5.12.x之前的版本。

**复现环境**

将ActiveMQ部署在MAC上，使用版本为apache-activemq-5.11.1，JDK版本为1.7

**复现过程**

启动ActiveMQ，并尝试上传jsp木马，返回401，上传时失败。。。

![](../Images/46367f8c21081d3923a121858ab0a2d9.png)

把文件名后缀改为txt，再上传，返回204，上传成功(网上有些文章直接上传jsp也能传上去，我这里是传不上去的，原因不明。。。)

![](../Images/2cc5ba7bf53e05a6cb3bc3edd8d8fceb.png)

在apache-activemq-5.11.1/webapps/fileserver文件夹下可以找到刚才上传的文件：

![](../Images/18107df84bd761c528919deeefc685f6.png)

此时的jsp木马是无法执行的，原因有二：1.文件名后缀是txt，2.fileserver目录无法执行jsp。所以需要将该文件后缀改为jsp，然后移动到可以执行jsp的文件夹内。

查看activemq的绝对路径：[http://IP:8161/admin/test/systemProperties.jsp](http://192.168.101.9:8161/admin/test/systemProperties.jsp)，将木马传到webapps/api下面：

![](../Images/d6eadc4698142864491324dedd6fc633.png)

![](../Images/2a798f5dc0863e3c7c12f86a168bddbb.png)

访问上传的木马，执行ls命令成功：

![](../Images/17a43713dde9a7d1aa366a8e18294e03.png)

****本文仅用于技术学习和交流，严禁用于非法用途，否则产生的一切后果自行承担。****