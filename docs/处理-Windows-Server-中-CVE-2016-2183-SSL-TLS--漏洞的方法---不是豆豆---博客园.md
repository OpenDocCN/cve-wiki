# 处理 Windows Server 中 CVE-2016-2183(SSL/TLS) 漏洞的方法 - 不是豆豆 - 博客园

> 原文：[`www.cnblogs.com/xwgli/p/15407311.html`](https://www.cnblogs.com/xwgli/p/15407311.html)

转自：[`www.cnblogs.com/xyb0226/p/14205536.html`](https://www.cnblogs.com/xyb0226/p/14205536.html "https://www.cnblogs.com/xyb0226/p/14205536.html")

运行 gpedit.msc，打开“本地组策略编辑器”-“计算机配置”-“管理模板”-“网络”-“SSL 配置设置”， 在“SSL 密码套件顺序”选项上，右键“编辑”。

选择“已启用”，在右侧说明页中找到“TLS 1.2 SHA256 and SHA384 cipher suites”和“TLS 1.2 ECC GCM cipher suites”复制下面的选项，然后以逗号分隔的形式形成一整串字符串，填至左侧输入框中。

如下：

```
TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P521,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P521,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_RSA_WITH_AES_128_GCM_SHA256,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P384,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P521,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384_P256,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384_P384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384_P521,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256_P256,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256_P384,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256_P521,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384_P384,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384_P521,TLS_DHE_DSS_WITH_AES_128_CBC_SHA256,TLS_DHE_DSS_WITH_AES_256_CBC_SHA256,TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_DHE_RSA_WITH_AES_256_CBC_SHA
```

更改完成后重启电脑即可。

也许可以顺便解决 SSL 相关的其它漏洞。

**新增验证方法：**

下载 nmap 工具：[`nmap.org/download.html`](https://nmap.org/download.html)

执行脚本：

```
nmap -p 3389 --script ssl-enum-ciphers localhost
```

可根据实际需要修改 3389 为所需端口，localhost 为所需地址

执行结果均为 - A 则表明使用算法等级为最高，若有其它 - C 等，则需要进行修改

结果示例：

```
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-28 10:58
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00s latency).
Other addresses for localhost (not scanned): ::1 rDNS record for 127.0.0.1: view-localhost

PORT     STATE SERVICE 1433/tcp open  ms-sql-s | ssl-enum-ciphers: |   TLSv1.0: | ciphers: |       TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (secp384r1) - A |       TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (ecdh_x25519) - A |       TLS_RSA_WITH_AES_256_CBC_SHA (rsa 2048) - A |       TLS_RSA_WITH_AES_128_CBC_SHA (rsa 2048) - A |       TLS_RSA_WITH_3DES_EDE_CBC_SHA (rsa 2048) - C | compressors: | NULL | cipher preference: server | warnings: |       64-bit block cipher 3DES vulnerable to SWEET32 attack |   TLSv1.1: | ciphers: |       TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (secp384r1) - A |       TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (ecdh_x25519) - A |       TLS_RSA_WITH_AES_256_CBC_SHA (rsa 2048) - A |       TLS_RSA_WITH_AES_128_CBC_SHA (rsa 2048) - A |       TLS_RSA_WITH_3DES_EDE_CBC_SHA (rsa 2048) - C | compressors: | NULL | cipher preference: server | warnings: |       64-bit block cipher 3DES vulnerable to SWEET32 attack |   TLSv1.2: | ciphers: |       TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (secp384r1) - A |       TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (ecdh_x25519) - A |       TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 (dh 2048) - A |       TLS_DHE_RSA_WITH_AES_128_GCM_SHA256 (dh 2048) - A |       TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 (secp384r1) - A |       TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 (ecdh_x25519) - A |       TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (secp384r1) - A |       TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (ecdh_x25519) - A |       TLS_RSA_WITH_AES_256_GCM_SHA384 (rsa 2048) - A |       TLS_RSA_WITH_AES_128_GCM_SHA256 (rsa 2048) - A |       TLS_RSA_WITH_AES_256_CBC_SHA256 (rsa 2048) - A |       TLS_RSA_WITH_AES_128_CBC_SHA256 (rsa 2048) - A |       TLS_RSA_WITH_AES_256_CBC_SHA (rsa 2048) - A |       TLS_RSA_WITH_AES_128_CBC_SHA (rsa 2048) - A |       TLS_RSA_WITH_3DES_EDE_CBC_SHA (rsa 2048) - C | compressors: | NULL | cipher preference: server | warnings: |       64-bit block cipher 3DES vulnerable to SWEET32 attack |_  least strength: C

Nmap done: 1 IP address (1 host up) scanned in 0.94 seconds
```

参考：http://hare0204.blogspot.com/2018/07/sslcipherfor3389port.html