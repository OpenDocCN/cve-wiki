# Spring Framework 远程命令执行漏洞（CVE-2022-22965） - mt0u - 博客园

> 原文：[`www.cnblogs.com/mt0u/p/16096018.html`](https://www.cnblogs.com/mt0u/p/16096018.html)

**Spring Framework 远程命令执行漏洞**

**（CVE-2022-22965）**

　近日，Spring 官方 GitHub issue 中提到了关于 Spring Core 的远程命令执行漏洞，该漏洞广泛存在于 Spring 框架以及衍生的框架中。

**漏洞形成原因：**

　　Spring core 是 Spring 系列产品中用来负责发现、创建并处理 bean 之间的关系的一个工具包，是一个包含 Spring 框架基本的核心工具包，Spring 其他组件都要使用到这个包。

　　未经身份验证的攻击者可以使用此漏洞进行远程任意代码执行。 该漏洞广泛存在于 Spring 框架以及衍生的框架中，JDK 9.0 及以上版本会受到影响。使用旧 JDK 版本的产品不受影响。建议存在该漏洞的企业在防火墙处阻止带有特殊字符串的请求，以免受到该漏洞的攻击。

**影响版本限制：**

使用 Apache Tomcat 作为 Servlet 容器

使用传统 WAR 部署

基于 spring-webmvc 或 spring-webflux

Spring 框架版本为 5.3.0 至 5.3.17,5.2.0 至 5.2.19，或更早版本

JDK 9.0 及以上版本会受到影响

**FOFA 搜索:**

app="APACHE-Tomcat" || app="vmware-SpringBoot-framework" || app="vmware-SpringBoot-framework" || app="vmware-Spring-Batch" || app="vmware-Spring-framework" || app="vmware-Spring-Security"

**漏洞复现：**

首先搭建好复现靶场

通过 exploit 工具直接命令执行

![](img/d88afbdb5e5d57b0eb76f4a49d0ed2a1.png)

 ![](img/e97a377e973a654b56035a8a0e6b85d4.png)

工具来源于 Github 

**漏洞修复：**

升级 Spring Framework 版本

```
`Spring Framework == 5.3.18 
Spring Framework == 5.2.20` 
```

**临时防御方案：**

1、 WAF 防御。

可以在 WAF 中添加以下规则对特殊输入的字符串进行过滤：

```
Class.*
class.*
*.class.*
*Class.*
```

2、通过黑名单策略进行防护。

您可在受影响产品代码中搜索@InitBinder 注解，判断方法体内是否有 dataBinder.serDisallowerFields 方法，若发现存在该方法，则在黑名单中添加如下过滤规则：

```
Class.*
class.*
*.class.*
*Class.*
```

![](img/57ca0650a0109ba8c29f618a1ec4838f.png)