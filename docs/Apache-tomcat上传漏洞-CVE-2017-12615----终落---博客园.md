# Apache tomcat上传漏洞（CVE-2017-12615） - 终落 - 博客园

> 原文：[https://www.cnblogs.com/twlr/p/12989985.html](https://www.cnblogs.com/twlr/p/12989985.html)

## Apache tomcat 上传漏洞

### 0x00 漏洞简述

　　Windows上的Apache Tomcat如果开启PUT方法(默认关闭)，则存在此漏洞，攻击者可以利用该漏洞上传JSP文件，从而导致远程代码执行。

### 0x01 漏洞分析

　　因为漏洞需要开启put方法，默认情况下开启readonly是拒绝put方法的，所以我们要关闭readonly在执行上传漏洞

　　readonly存在于/conf/web.xml中，打开web.xml可发现readonly处于true就会 拒绝put方法的使用

　　![](../Images/c0df17e256274b33a505d473139ef6eb.png)

### 0x02 漏洞复现

 　　我们需要使readonly=false，在源码114行添加：

```
    <init-param>
        <param-name>readonly</param-name>
        <param-value>false</param-value>
    </init-param>
```

　　然后访问tomcat：

　　![](../Images/b8aaea2cb6332fada2e0d28386606e4f.png)

 　　通过burp抓包，修改数据包，进行上传；

　　通过Tomcat的conf/web.xml配置，可知当后缀为.jsp或者.jspx的时候，铜鼓哦JspSevlet处理请求；而DefaultServlet存在漏洞，他处理静态资源，所以我们需要绕过这个限制，在文件名后面添加空格即可。

　　![](../Images/b0c448d33d809ede2a4a767de9962878.png)

 　　访问url：

　　![](../Images/dec07c3a7713c271f61d3b1aca2428b8.png)

 　　上传成功！

### 0x03 修复建议

　　1、禁用put方法

　　2、更新官方补丁