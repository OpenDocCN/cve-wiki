# weblogic 任意文件上传(CVE-2018-2894) - 学安全的小白 - 博客园

> 原文：[`www.cnblogs.com/pursue-security/p/17029519.html`](https://www.cnblogs.com/pursue-security/p/17029519.html)

# 漏洞描述

Weblogic 管理端未授权的两个页面存在任意文件上传漏洞，通过这两个页面可以获取到服务器权限。这两个页面分别是/ws_utc/begin.do，/ws_utc/config.do。利用这两个页面可以上传任意 jsp 文件,从而获取到服务器权限。

# 漏洞影响范围

Weblogic 10.3.6.0Weblogic 12.1.3.0Weblogic 12.2.1.2Weblogic 12.2.1.3

# 漏洞利用条件

需要知道部署应用的 web 目录；ws_utc/config.do 在开发模式下无需认证，在生产模式下需要认证。

# 漏洞复现

靶场环境为：vulhub weblogic CVE-2018-2894 使用 docker-compose logs | grep password 命令查看管理员用户名和密码![0](img/8313d3ffa71665eae0456c89d1b71c86.png)访问 http://192.168.116.133:7001/console，进入后台管理员登录界面，使用管理员用户名、密码进行登录。用户名为 weblogic![0](img/e972db997d521d1e5d426c46c7abe3f3.png)登录后台页面，点击 base_domain 的配置，在“高级”中勾选‘启用 web 服务测试页’选项，然后保存配置。![0](img/3fd471681f837fd782aadc3d64e85c7b.png)访问[`192.168.116.133:7001/ws_utc/config.do`](http://192.168.116.133:7001/ws_utc/config.do)，设置 Work Home DIR 的值为

```
/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css
```

访问这个目录是无需权限的，这一点很重要![0](img/be524f6aed2e5b107fe482d07d5df887.png)然后点击 ‘安全’ -> ‘添加’ ，然后上传 jsp 大马或者上传 cmd 马。![0](img/2f8dd61e42de21b2332172391f1bfaee.png)F12，审查元素，查看时间戳为 1648023588544，文件名为 test.jsp。![](img/a95d353f150b88396157344997953181.png)访问[`your_ip:7001/ws_utc/css/config/keystore/时间戳 _ 文件名，即可执行 webshell。`](http://your_ip:7001/ws_utc/css/config/keystore/%E6%97%B6%E9%97%B4%E6%88%B3_%E6%96%87%E4%BB%B6%E5%90%8D%EF%BC%8C%E5%8D%B3%E5%8F%AF%E6%89%A7%E8%A1%8Cwebshell%E3%80%82)![0](img/d76c00bc16759438cfb9098812e62146.png)菜刀、蚁剑、冰蝎连接即可。![0](img/3726cec5a6e9ec4a8cee77830e176880.png)

# 漏洞防御

升级到官方的最新版本设置 config.do,begin.do 页面登录授权后访问