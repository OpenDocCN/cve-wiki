# 360 众测考试，weblogic 题（CVE-2018-2894）文件上传漏洞 - 小菜鸟当黑客 - 博客园

> 原文：[`www.cnblogs.com/bflw/p/12726027.html`](https://www.cnblogs.com/bflw/p/12726027.html)

### 0x00 前言

昨天 360 众测遇到的一个题

今天自己搭环境复现一下，希望对大家有帮助

### 0x01 漏洞简介

Weblogic 管理端未授权的两个页面存在任意上传 jsp 文件漏洞，进而获取服务器权限。
Oracle 7 月更新中，修复了 Weblogic Web Service Test Page 中一处任意文件上传漏洞，Web Service Test Page 在 ‘生产模式’ 下默认不开启，所以该漏洞有一定限制。两个页面分别为/ws_utc/begin.do、/ws_utc/config.do。

### 0x02 影响版本

weblogic 10.3.6.0
weblogic 12.1.3.0
weblogic 12.2.1.2
weblogic 12.2.1.3

### 0x03 环境搭建

vulhub 搭建

不会的小伙伴看这：https://www.cnblogs.com/bflw/p/12534401.html

### 0x04 漏洞复现

1.进入 vulhub/weblogic/CVE-2018-2894 目录下，生成靶场

2.执行 docker-compose logs | grep password 可查看管理员密码

3.环境启动之后，访问 http://ip:7001/console，即可看到后台登录页面

4.登录后台页面，点击 base_domain 的配置，在 ‘高级’ 中勾选 ‘启用 Web 服务测试页’ 选项，然后保存配置。

![](img/b68f319063e7761716f9c02c8af6ce93.png)

 ![](img/e45e76dc8a88c0bc821af133fa12c7a7.png)

5.访问链接 http://192.168.2.145:7001/ws_utc/config.do

6.访问`http://your-ip:7001/ws_utc/config.do`，设置 Work Home Dir 为`/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css`。我将目录设置为`ws_utc`应用的静态文件 css 目录，访问这个目录是无需权限的，这一点很重要。

![](img/e0fccc65f1f03e46dd01d3f74b26c897.png)

7.点击   安全-->  然后上传 webshell

  抓包，，可以看到返回得时间戳

![](img/80f58c0be6d160afda560320c379b62e.png)

上传的文件名为：时间戳 + 下划线 + 上传的文件名名称

然后再浏览器访问

像下面

[`ip:7001/ws_utc/css/config/keystore/1587176342376_cmd.jsp`](http://192.168.2.145:7001/ws_utc/css/config/keystore/1587176342376_cmd.jsp)

![](img/5d75259c20a5d61ceb03f4ba513ba7e2.png)

### jsp 码关注公众号，私信领取

### 企鹅群：1045867209

### 欢迎各位表哥

###  博主公众号

![](img/c6c1a4b057b858c88387a767f55d83a4.png)