# GK2020-CVE 签到题 CVE-2020-7066 PHP7.x get_headers(） - Lee-404 - 博客园

> 原文：[`www.cnblogs.com/Lee-404/p/13039614.html`](https://www.cnblogs.com/Lee-404/p/13039614.html)

## 前言

　　来源 https://security-tracker.debian.org/tracker/CVE-2020-7066

　　翻译 [`bugs.php.net/bug.php?id=79329`](https://bugs.php.net/bug.php?id=79329)

## get_headers()

　　get_headers()：可以通过服务器的响应头来判断远程文件是否存在

```
array get_headers ( string $url [, int $format = 0 ] )
```

　　判断网站是否存在例子

```
<?php var_dump( get_headers('https://www.baidu.com')); ?>
```

![](img/54b7261cdd43d19c11dcd6d1224bd93a.png)

 　　get_headers()函数没有设置参数，所以返回的数组中键值都是默认的。

## get_headers()安全

　　get_headers()会截断 URL 中空字符后的内容，这是在 php7.3 中发现的 ，但是一直有这个漏洞，测试脚本显示这会让恶意脚本获取意外域名的 header 。这些 header 可能泄露敏感信息或者意外地包含攻击者控制的数据。

　　在低于 7.2.29 的 PHP 版本 7.2.x，低于 7.3.16 的 7.3.x 和低于 7.4.4 的 7.4.x 中，将 get_headers（）与用户提供的 URL 一起使用时，如果 URL 包含零（\ 0）字符，则 URL 将被静默地截断。这可能会导致某些软件对 get_headers（）的目标做出错误的假设，并可能将某些信息发送到错误的服务器。

```
<?php // user input
$_GET['url'] = "http://localhost\0.example.com"; $host = parse_url($_GET['url'], PHP_URL_HOST); if (substr($host, -12) !== '.example.com') { die();
} $headers = get_headers($_GET['url']); var_dump($headers);
```

　　预期结果

　![](img/4a0f351b0f0b62410dcc449d0859d146.png)

## GK2020-CVE 签到题

　　访问题目，给的提示是 CVE-2020-7066

![](img/887f9cb4e7384d754b17ccbca113d1b5.png)

 　　F12 得到提示，flag 在 localhost，localhost 不是单指 127.0.0.1，而是符合 127.0.0.0/24 这一网段的 IP 地址，比如 127.0.0.100 也可以叫 localhost

　![](img/585bf6798fceb971c08fe5bd1ed29c06.png)

　　再点击链接，发现有传参

![](img/a10790e43afb2df7500474774e99f893.png)

 　　综上，就是参数要是 localhost 且用\0 截断，这里用%00 截断

![](img/e642272eb53ff6947a221920ca6ab7bf.png)

 　　最后需要 123

![](img/c4bb4833617d694c063515330fd13fd1.png)

## 参考链接

　　https://blog.csdn.net/qq_45521281/article/details/106425266