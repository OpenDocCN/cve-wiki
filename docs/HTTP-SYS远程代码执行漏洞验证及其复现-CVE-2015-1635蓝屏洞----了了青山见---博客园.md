# HTTP.SYS 远程代码执行漏洞验证及其复现(CVE-2015-1635 蓝屏洞) - 了了青山见 - 博客园

> 原文：[`www.cnblogs.com/Pengj/p/17602177.html`](https://www.cnblogs.com/Pengj/p/17602177.html)

# HTTP.SYS 远程代码执行漏洞验证及其复现(CVE-2015-1635 蓝屏洞)

@

目录

*   HTTP.SYS 远程代码执行漏洞验证及其复现(CVE-2015-1635 蓝屏洞)
    *   *   漏洞概述
        *   http.sys 介绍
        *   漏洞成因
        *   漏洞危害
        *   影响版本
        *   漏洞复现环境部署
        *   漏洞验证
        *   防护措施

### 漏洞概述

### http.sys 介绍

HTTP.sys 是 Microsoft Windows 处理 HTTP 请求的内核驱动程序，为了优化 IIS 服务器性能，从 IIS6.0 引入，IIS 服务进程依赖 HTTP.sys。HTTP.sys 远程代码执行漏洞实质是 HTTP.sys 的整数溢出漏洞

### 漏洞成因

远程执行代码漏洞存在于 HTTP 协议堆栈 (HTTP.sys) 中，当 HTTP.sys 未正确分析经特殊设计的 HTTP 请求时会导致此漏洞

### 漏洞危害

攻击者只需要发送恶意的 http 请求数据包，就可能远程读取 IIS 服务器的内存数据，或使服务器系统蓝屏崩溃。

### 影响版本

任何安装了微软 IIS 6.0 以上的的 Windows 7、Windows Server 2008 R2、 Windows Server 2012 R2 、Windows Server 2012、Windows 8、2、Windows 8.1 系统

### 漏洞复现环境部署

windows7 环境下部署 IIS 服务
控制面板-->程序-->程序和功能-->Internet 信息服务
![在这里插入图片描述](img/fdf27362e6174c8da0e932dffccc6ef7.png)
打开 IIS 管理器
控制面板-->系统和安全-->管理工具
![在这里插入图片描述](img/4819218ce9ccf04b6d81894365bbf474.png)
查看默认网站首页是否启动
![在这里插入图片描述](img/51daefb6fe5e536ba181cc23330ab5c8.png)
访问本地回环地址，查看 IIS 版本是否为 6 版本及以上
![在这里插入图片描述](img/88725d091f3cf3911e49945d2e42fd71.png)

### 漏洞验证

win7 靶机 IP:192.168.147.162
kali 攻击机:192.168.247.164
使用攻击机访问靶机查看网络是否互通
![在这里插入图片描述](img/d481cfe14f90c4fa1a50578c2bdf4e2c.png)
使用 curl 命令查看漏洞是否存在

```
curl http://192.168.247.162 -H "Host: 192.168.247.162" -H "Range: bytes=0-18446744073709551615" 
```

返回状态码为 416 即证明该系统漏洞存在
![在这里插入图片描述](img/98e9f3e52244ad38d8524c4b774eb48f.png)
使用 msfconsole 搜索 ms15_034
![在这里插入图片描述](img/dfe37282d8aabc160777ce5ad5a96a57.png)
使用模块 0 进行 dos 攻击，查看选项设置，端口默认 80 不用设置
![在这里插入图片描述](img/747c21fbbe5eb5b66126b67759e1ddd6.png)
设置目标主机地址，并开始进行 dos 攻击
![在这里插入图片描述](img/02b686787e70c4acaded52f0f5bdba11.png)

攻击成功，靶机蓝屏重启
![在这里插入图片描述](img/d2824339cef7f1a2989b99a4924a276c.png)

### 防护措施

1.  打补丁
    [`learn.microsoft.com/zh-cn/security-updates/Securitybulletins/2015/ms15-034`](https://learn.microsoft.com/zh-cn/security-updates/Securitybulletins/2015/ms15-034)
2.  禁用 IIS 内核缓存
    ![在这里插入图片描述](img/4c6b8ec0ff058b2214b1078f4266f2fb.png)
    ![在这里插入图片描述](img/b064f1d83e15c9ffa59722904f8c7008.png)