# CVE-2016-3348 漏洞分析 - 紅人 - 博客园

> 原文：[`www.cnblogs.com/feizianquan/p/17191893.html`](https://www.cnblogs.com/feizianquan/p/17191893.html)

### 0x00 漏洞信息

漏洞影响：本地提权

漏洞文件：win32kfull.sys

漏洞函数：GreDoBanding

漏洞原因：释放重引用

漏洞日期： 2016 年 9 月 13 日

### [【漏洞分析合集】](https://www.cnblogs.com/feizianquan/p/10882161.html)

### 0x01 漏洞分析

win32kfull!GreDoBanding 函数调用 UMPDDrvNextBand 函数时，UMPDDrvNextBand 可以触发一个用户模式回调到 Ring3 代码并释放表面对象，这导致当返回内核时用户释放后的条件。

![](img/561634ad6ace4b9bcbefb88f0972fe9f.png)

 第 60 行 会执行到用户层 进行 hook 此时调用 enddoc  释放 对象 回到内核没有验证对象是否被释放就使用 导致漏洞

### 0x02poc

# [CVE-2016-3310 漏洞分析](https://www.cnblogs.com/feizianquan/p/16461838.html)

漏洞原理相同 只限于更改 hook 函数