# linux本地内核提权之CVE-2019-13272（鸡肋） - 木讷 - 博客园

> 原文：[https://www.cnblogs.com/iamver/p/11720111.html](https://www.cnblogs.com/iamver/p/11720111.html)

**CVE-2019-13272**

**发布时间**：

　　　　　　2019月7月17日

**影响内核版本**：

　　　　　　Linux Kernel < 5.1.17

**漏洞描述**：

　　　![](../Images/7f98c74313153532abc629888fc6ce04.png)

**译文**

**　　kernel 5.1.17之前版本中存在安全漏洞，该漏洞源于kernel/ptrace.c文件的ptrace_link没有正确处理对凭证的记录。攻击者可利用该漏洞获取root访问权限。由于　　PTRACE_TRACEME允许的borked权限，利用bug在概念上很有趣。对象生命周期处理问题可能会导致内存损坏，但它需要以精确的方式进行代码竞争。事实PTRACE_TRACEME证明，除了父进程之外，内核还记录了跟踪器的凭据。研究人员概述的方案涉及一个父进程，该进程创建一个子进程，这个子进程会创建子进程。第一个子进程使用命令pkexec（用于以root身份运行程序），第二个子进程运行PTRACE_TRACEME，然后第一个子进程丢弃其权限。最终结果是父进程可以使用ptrace来控制第一个子进程，后者可以使用ptrace来控制第二个子进程 - 从而让攻击者获得对两个进程的控制权。　　　　　**

**漏洞复现**：

　　　　　　![](../Images/07230c315531014e483ded97e92f83ab.png) 

　　　　　　![](../Images/df3511e0362b2615fb21111dbfcfc786.png)

　　　　　　![](../Images/bbd0b26df3e44e3d27eb47c15e3fd10a.png)

　　　　　　![](../Images/1498aa4d56733704e0d74d9cbd72201d.png)　　

**作者已测试成功的版本：　　**

**　　　　　　![](../Images/f50d279a6bd1255f5dc7458d3571f3af.png)**

**局限**：　　

　　　　![](../Images/6961298cddccf0d28eaf74f37f016664.png)

　　　　　　![](../Images/0bf065accfbdbbc76c9c567bb4bf444e.png)

我尝试在ssh登录时去复现，未能成功。　　

　　　　　　![](../Images/796fc73a6394117d458277287c2c83b3.png)

**相关链接**：

　　　　　　[https://nvd.nist.gov/vuln/detail/CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

　　　　　　[https://www.cvedetails.com/cve/CVE-2019-13272/](https://www.cvedetails.com/cve/CVE-2019-13272/)

　　　　　　[https://github.com/bcoles/kernel-exploits/tree/master/CVE-2019-13272](https://github.com/bcoles/kernel-exploits/tree/master/CVE-2019-13272)

　　　　　　[https://bugs.chromium.org/p/project-zero/issues/detail?id=1903](https://bugs.chromium.org/p/project-zero/issues/detail?id=1903)

　　　　　　[https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2019-13272/poc.c](https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2019-13272/poc.c) [](https://raw.githubusercontent.com/CrisWang/Exploit-Virtual-Machine/master/Linux/01-CVE-2019-13272.c) 

　　　　　　[https://github.com/torvalds/linux/commit/6994eefb0053799d2e07cd140df6c2ea106c41ee](https://github.com/torvalds/linux/commit/6994eefb0053799d2e07cd140df6c2ea106c41ee)

　　　　　　[https://asciinema.org/a/6HFa1zk4bZKFjXDcr5LKnyiH1](https://asciinema.org/a/6HFa1zk4bZKFjXDcr5LKnyiH1)

　　　　　　[https://www.anquanke.com/post/id/183438](https://www.anquanke.com/post/id/183438)

　　　　　　[https://www.anquanke.com/post/id/183528](https://www.anquanke.com/post/id/183528)

**补丁地址**：

　　　　　　https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=6994eefb0053799d2e07cd140df6c2ea106c41e