# CVE-2019-1388 UAC提权复现 - Sylon - 博客园

> 原文：[https://www.cnblogs.com/Sylon/p/11941276.html](https://www.cnblogs.com/Sylon/p/11941276.html)

## 0x01 前言

该漏洞位于Windows的UAC（User Account Control，用户帐户控制）机制中。默认情况下，Windows会在一个单独的桌面上显示所有的UAC提示——Secure Desktop。这些提示是由名为consent.exe的可执行文件产生的，该可执行文件以NT AUTHORITY\SYSTEM权限运行，完整性级别为System。因为用户可以与该UI交互，因此对UI来说紧限制是必须的。否则，低权限的用户可能可以通过UI操作的循环路由以SYSTEM权限执行操作。即使隔离状态的看似无害的UI特征都可能会成为引发任意控制的动作链的第一步。事实上，UAC会话中含有尽可能少的点击操作选项。
利用该漏洞很容易就可以提升权限到SYSTEM

## 0x02 危害范围

# 根绝gayhub的exp文档所说 支持如下（但 本机win10没成功 可能是补丁打过了吧 ）
exp 详情
[https://github.com/jas502n/CVE-2019-1388](https://github.com/jas502n/CVE-2019-1388)
SERVER

Windows 2008r2 7601 ** link OPENED AS SYSTEM **
Windows 2012r2 9600 ** link OPENED AS SYSTEM **
Windows 2016 14393 ** link OPENED AS SYSTEM **
Windows 2019 17763 link NOT opened

# WORKSTATION

Windows 7 SP1 7601 ** link OPENED AS SYSTEM **
Windows 8 9200 ** link OPENED AS SYSTEM **
Windows 8.1 9600 ** link OPENED AS SYSTEM **
Windows 10 1511 10240 ** link OPENED AS SYSTEM **
Windows 10 1607 14393 ** link OPENED AS SYSTEM **
Windows 10 1703 15063 link NOT opened
Windows 10 1709 16299 link NOT opened

## 0x03复现详情

win7：
![](../Images/ee5aff5713445daceebbc41360563959.png)
![](../Images/4b0a500f55865c4d5b38724ee428fc84.png)
win2012：
![](../Images/b55eb11379e0b907e666079f6139022b.png)

## 0x04 修复方案

关注微软官网