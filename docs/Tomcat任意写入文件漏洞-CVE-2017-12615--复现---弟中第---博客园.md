# Tomcat任意写入文件漏洞(CVE-2017-12615) 复现 - 弟中第 - 博客园

> 原文：[https://www.cnblogs.com/dizhongdi/p/13222137.html](https://www.cnblogs.com/dizhongdi/p/13222137.html)

**漏洞概述**

如果Tomcat开启了PUT方法(默认关闭，有点鸡肋，但是有些页面需要PUT，无法关闭)，则有可能存在远程命令执行漏洞，攻击者可以利用PUT方法上传jsp文件，从而造成远程命令执行，getshell等。

**影响版本**

7.0.0~7.0.79

**漏洞原理**

由于conf/web.xml里readonly设置为false

**靶场地址**

[http://vulfocus.fofa.so/](http://vulfocus.fofa.so/)(靶机为8.5.19请忽视,漏洞存在7.0.0~7.0.79)

![](../Images/2f0abd7cb43bfc4aa8a8935249e8800b.png)

**漏洞复现**

使用：/，由于Tomcat存在去掉最后的 / 的特性，此方法影响所有的Apache Tomcat 版本。

 ![](../Images/43e605cd21b2f65b1e4545b9bbbdcc45.png)

访问3.jsp

![](../Images/f11a74bb006fbc6c6b2e405cb942dddf.png)

接下来，上传jsp木马后门。

![](../Images/a065921a23c926bd9ea82108635976d9.png)

使用冰蝎连接后门，即可成功getshell。

![](../Images/60157a5394c10e6d6886b9ad8796ef28.png)

 **另外两种上传方式**

%20

![](../Images/f32265cafc59c0defbd3d1145bc83a09.png)

 ::$DATA

![](../Images/065f77a7924f7ce3b4a7a1defd391e1c.png)