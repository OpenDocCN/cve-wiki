# Weblogic 任意文件上传漏洞（CVE-2018-2894）复现 - micr067 - 博客园

> 原文：[`www.cnblogs.com/micr067/p/11609967.html`](https://www.cnblogs.com/micr067/p/11609967.html)

使用 docker 搭建漏洞测试环境 micr067@test:~/vulhub/weblogic/CVE-2018-2894$ sudo docker-compose buildweblogic uses an image, skippingmicr067@test:~/vulhub/weblogic/CVE-2018-2894$ sudo docker-compose up -d[`192.168.190.135:7001/console`](http://192.168.190.135:7001/console) 登录控制台![](img/3d39e5329f100500668cb7af296cf027.png)sudo docker-compose logs | grep password 查看环境账号密码用户名：weblogic 密 码：cWkt0VPA![](img/cabb7e2cbec05a4d77ff166fc38e9745.png)点击 [base_domain](http://192.168.190.135:7001/console/console.portal?_nfpb=true&_pageLabel=DomainConfigGeneralPage&DomainConfigGeneralPortlethandle=com.bea.console.handles.JMXHandle%28%22com.bea%3AName%3Dbase_domain%2CType%3DDomain%22%29)，的配置![](img/7481f6153d26d97e0138e1870925acce.png)在高级中开启 ”启用 Web 服务测试页“选项，保存。T3 也称为丰富套接字，是 BEA 内部协议，功能丰富，可扩展性好。T3 是多工双向和异步协议，经过高度优化，只使用一个套接字和一条线程。借助这种方法，基于 Java 的客户端可以根据服务器方需求使用多种 RMI 对象，但仍使用一个套接字和一条线程。![](img/fe1127bd2df90ae6744dac2df061fd88.png)[`192.168.190.135:7001/ws_utc/config.do`](http://192.168.190.135:7001/ws_utc/config.do)设置 Work Home Dir 为/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css 将目录设置为 ws_utc 应用的静态文件 css 目录，访问这个目录是无需权限的，然后提交。![](img/2ed5706e3ba8c87dccac050daed7ebd0.png)然后点击“安全”，添加 ，弹出登录框，点击“浏览”上传 webshell 并抓包。![](img/b9f47d9d292e5ec83602a1760413623a.png)![](img/f349415e70a49f65dc02d90773c131b0.png)可以看到已经成功上传。![](img/83a8e886beb045988f0b3d565a14f4d4.png)访问 http://your-ip:7001/ws_utc/css/config/keystore/[时间戳]_[文件名]，即可执行 webshell[`192.168.190.135:7001/ws_utc/css/config/keystore/1569757334193_111.jsp`](http://192.168.190.135:7001/ws_utc/css/config/keystore/1569757334193_111.jsp)可以访问。![](img/a551980d4236cc8769610eaf154502e8.png)使用蚁剑和菜刀连接失败，换用冰蝎的 shell 使用冰蝎成功连接。![](img/cfe699a1e60dd76d485a52f23274c63f.png)![](img/74979d1b3eae423452b65c2daac9fb3e.png)