# Linux本地内核提权CVE-2019-13272 - zpchcbd - 博客园

> 原文：[https://www.cnblogs.com/zpchcbd/p/11813615.html](https://www.cnblogs.com/zpchcbd/p/11813615.html)

前言：Linux本地内核提权CVE-2019-13272复现笔记

参考文章：[https://www.secpulse.com/archives/110052.html](https://www.secpulse.com/archives/110052.html)

# 提权简介：当调用PTRACE_TRACEME时，ptrace_link函数将获得对父进程凭据的RCU引用，然后将该指针指向get_cred函数。但是，对象struct cred的生存周期规则不允许无条件地将RCU引用转换为稳定引用。

PTRACE_TRACEME获取父进程的凭证，使其能够像父进程一样执行父进程能够执行的各种操作。如果恶意低权限子进程使用PTRACE_TRACEME并且该子进程的父进程具有高权限，该子进程可获取其父进程的控制权并且使用其父进程的权限调用execve函数创建一个新的高权限进程。

## 影响版本

目前受影响的Linux内核版本：Linux Kernel < 5.1.17

# 漏洞利用

当前用户是adexx,当前系统版本`uname -a`

![](../Images/202561587ca25e0602a4a7cb3364f3d7.png)

利用脚本：[https://github.com/bcoles/kernel-exploits/tree/master/CVE-2019-13272](https://github.com/bcoles/kernel-exploits/tree/master/CVE-2019-13272)

*   使用gcc编译c文件，生成exp文件

`gcc poc.c -o exp`

*   执行脚本

`./exp`

发现提权成功，结果如下图所示

![](../Images/65d713eb37772e00ea108c01ccaacd66.png)