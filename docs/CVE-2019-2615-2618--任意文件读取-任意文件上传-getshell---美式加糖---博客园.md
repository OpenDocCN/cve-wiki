# CVE-2019-2615[2618] ä»»æ„æ–‡ä»¶è¯»å–,ä»»æ„æ–‡ä»¶ä¸Šä¼ -getshell - ç¾å¼åŠ ç³– - åšå®¢å›­

> åŸæ–‡ï¼š[`www.cnblogs.com/peace-and-romance/p/15747427.html`](https://www.cnblogs.com/peace-and-romance/p/15747427.html)

### 0X00-å¼•è¨€

* * *

ä¹°äº†ä¸¤æœ¬ä¹¦ï¼Œä¸€ç™¾å¤šï¼Œä¸ºçŸ¥è¯†ä»˜è´¹æˆ‘å¼€å¿ƒğŸ˜­

### 0X01-ç¯å¢ƒæ­å»º

* * *

é¶æœºï¼šCentOS Linux 7

æ”»å‡»æœºï¼šwindows server 2016 && Kail

ç¯å¢ƒï¼švulhub

é¡¹ç›®åœ°å€ï¼š[`github.com/vulhub/vulhub`](https://github.com/vulhub/vulhub)

æ­å»º vulhub è¯·è®¿é—®ï¼š[ç©ºç™½ centos7 64 æ­å»º vulhub(è¯¦ç»†)](https://www.cnblogs.com/peace-and-romance/p/15621658.html)

### 0X02-æ¼æ´æè¿°

* * *

å®˜æ–¹æè¿°æ²¡æ‰¾åˆ°

æ¯”è¾ƒå…¸å‹ä»»æ„æ–‡ä»¶è¯»å–ï¼Œæ–‡ä»¶ä¸Šä¼ 

### 0X03-æ¼æ´å¤ç°

* * *

`http://192.168.234.128:7001/console/login/LoginForm.jsp`

![image-20211229144157381](img/6bdddc3b8d65da4a0e2a678e6d59a1e4.png)

##### 01-è¯»å–ç™»å½•å¯†ç 

è®¿é—®`http://your-ip:7001/hello/file.jsp?path=/etc/passwd`å¯ä»¥æˆåŠŸè·å– passwd æ–‡ä»¶

![image-20211229144514041](img/c599b40329e7b29a7a5cef38cf04a45e.png)

weblogic å¯†ç ä½¿ç”¨ AES åŠ å¯†ï¼Œå¯¹ç§°åŠ å¯†å¯è§£å¯†ï¼Œåªè¦æ‰¾åˆ°åŠ å¯†çš„å¯†æ–‡å’Œç§˜é’¥å³å¯

è¿™ä¸¤ä¸ªæ–‡ä»¶å‡ä½äº base_domain ä¸‹ï¼Œåä¸º`SerializedSystemIni.dat`å’Œ`config.xml`ï¼Œåœ¨æœ¬ç¯å¢ƒä¸­ä¸º`./security/SerializedSystemIni.dat`å’Œ`./config/config.xml`ï¼ˆåŸºäºå½“å‰ç›®å½•`/root/Oracle/Middleware/user_projects/domains/base_domain`ï¼‰

SerializedSystemIni.dat æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”¨ burp ä¿å­˜æˆä¸€ä¸ª.dat æ–‡ä»¶å³å¯

![image-20211229145732275](img/740942f25568e0c4eadb78fbf1c0ab37.png)

è·å–åŠ å¯†å¯†æ–‡-`config.xml`æ˜¯ base_domain çš„å…¨å±€é…ç½®æ–‡ä»¶

`<node-manager-password-encrypted>`çš„å€¼ï¼Œå³ä¸ºåŠ å¯†åçš„ç®¡ç†å‘˜å¯†ç 

![image-20211229145851624](img/6b2a0b13c12278891de40e4007fa7dcb.png)

å·¥å…·è§£å¯†ï¼šå·¥å…·åœ¨é¶åœºå†…

![image-20211229153740440](img/30cc30293e09dbc355bd0299f3bae3db.png)

![image-20211229153809246](img/497375a417018ae4f9d307e3bb801321.png)

è‹¥æ˜¯å‡ºç°æŠ¥é”™-æ˜¯äºŒè¿›åˆ¶ç§˜é’¥å­˜åœ¨é—®é¢˜ç§˜é’¥

burp è®¿é—®`/root/Oracle/Middleware/user_projects/domains/base_domain/security/SerializedSystemIni.dat`å†å¯¼å‡ºä¸€æ¬¡ç§˜é’¥

è‹¥è¿˜æ˜¯å‡ºç°é—®é¢˜-è¿™é‡Œæœ‰ç¯‡[æ–‡ç« ](https://github.com/TideSec/Decrypt_Weblogic_Password)å…³äº weblogic è§£å¯†çš„

![image-20211229153924714](img/eeef1569973509395bd98e65822aba06.png)

å¯†ç çŸ¥é“-ç”¨æˆ·åçŸ¥é“-ç™»å½•

```
usernameï¼šweblogic
passwordï¼šOracle@123 
```

![image-20211229155308886](img/c3bc6f074476aa38c667f27b774faf8e.png)

##### 02-ä¸Šä¼ é©¬(getshell)

ç‚¹å‡»

![image-20211229160051126](img/94ab3a55c3f861192cff3226cb46cec7.png)

war åŒ…å­˜åœ¨é¶åœºä¸­-ä¿®æ”¹ war åŒ…-å…ˆè§£å‹

ä¿®æ”¹ war åŒ…ä¸­ WEB-INF ä¸‹çš„ weblogic.xml æ–‡ä»¶-ç›®å½•ä¿®æ”¹ä¸º shell

![image-20211229171022676](img/415f293b5847dc5c0d857021e0e9a764.png)

è¦ä¼ çš„é©¬æ”¾è¿› war åŒ…(æˆ‘çš„æ˜¯å“¥æ–¯æ‹‰çš„é©¬)

![image-20211229171113380](img/e0fb710b92ca1d9405556349bc353682.png)

ä¸Šä¼ 

![image-20211229170057871](img/4595aea2c8072449978f0088fa02ebc1.png)

![image-20211229171241049](img/509f641bf59c26888bbf11ce8240e5da.png)

ä¸€è·¯ä¸‹ä¸€æ­¥ç›´åˆ°å‘½åæ­¤éƒ¨ç½²-ä¿®æ”¹ä¸º shell-é˜²æ­¢ç›®å½•é‡åˆ

![image-20211229171413724](img/c9e819a3bb213e73cf835a599713d399.png)

ç„¶åä¸‹ä¸€æ­¥ç›´åˆ°å®Œæˆ

ä¸Šä¼ çš„è·¯å¾„ä¸º`http://192.168.234.128:7001/shell/shell.jsp`

å“¥æ–¯æ‹‰è¿æ¥

![image-20211229171631500](img/9100280e56716dd3ae8d1701655d65a0.png)

![image-20211229171650019](img/bf8d8906a1139b4c5580a3b73229e856.png)

### 0X04-å·¥å…·æ£€æµ‹

* * *

å·¥å…·åœ°å€ï¼š[`github.com/Liqunkit/LiqunKit_`](https://github.com/Liqunkit/LiqunKit_)

![image-20211229172453760](img/1c064edb9c2c006cb1709c608184eb49.png)

### 0X05-æ¼æ´é˜²å¾¡

* * *

å‡çº§ç‰ˆæœ¬

### 0X06-å…è´£å£°æ˜

* * *

ä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œåˆ‡å‹¿ç”¨äºéæ³•ç”¨é€”

### 0X07-å‚è€ƒ

* * *

[`vulhub.org/#/environments/weblogic/weak_password/`](https://vulhub.org/#/environments/weblogic/weak_password/)