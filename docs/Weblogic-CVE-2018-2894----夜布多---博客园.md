# Weblogic（CVE-2018-2894） - 夜布多 - 博客园

> 原文：[https://www.cnblogs.com/tac2664/p/14525939.html](https://www.cnblogs.com/tac2664/p/14525939.html)

# 漏洞叙述

Oracle 7月更新中，修复了Weblogic Web Service Test Page中一处任意文件上传漏洞，Web Service Test Page 在“生产模式”下默认不开启，所以该漏洞有一定限制。

利用该漏洞，可以上传任意jsp文件，进而获取服务器权限。

# 影响范围

Oracle WebLogic Server，版本10.3.6.0，12.1.3.0，12.2.1.2，12.2.1.3。

# 漏洞环境

我用的是vulhub+docker搭建的

环境启动后，访问`http://your-ip:7001/console`，即可看到后台登录页面。

![](../Images/4d9bce90bcac8754bbbcfd1d7b316ee1.png)

执行docker-compose logs | grep password可查看管理员密码

![](../Images/d19a05ad225c0066351ab66fbaa79ea7.png)

登录

 ![](../Images/1625440040043366df0f4cf7bb1c0dc8.png)

点击`base_domain`的配置，在 ‘高级’ 中勾选 ‘启用 Web 服务测试页’ 选项，然后保存配置。

 ![](../Images/506d0295a1fc38e94b619485b99643f8.png)

# 漏洞复现

访问`http://your-ip:7001/ws_utc/config.do`，

设置Work Home Dir为

```
/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css
```

将目录设置为`ws_utc`应用的静态文件css目录，访问这个目录是无需权限的

然后点击 ‘安全’→ ‘添加’ ，上传jsp文件，我用的是冰蝎码

![](../Images/506f050430e57a996088674817a0dea6.png)

 抓包看时间戳，或者右击F12检查查看

![](../Images/3d512e1696102143feb4f32c2ddb9d74.png)

访问http://192.168.6.130:7001/ws_utc/css/config/keystore/[时间戳]_[文件名]，即可执行webshell,只要没报404就上传成功

冰蝎连一下

![](../Images/b8e29f13823af27ae0d3148992724c4f.png)

# 漏洞防御

1、 设置config.do,begin.do页面登录授权后访问；

2、 IPS等防御产品可以加入相应的特征；

3、 升级到官方的最新版本。