# polkit pkexec 本地提权漏洞（CVE-2021-4034） - 刘俊涛的博客 - 博客园

> 原文：[`www.cnblogs.com/lovebing/p/16263073.html`](https://www.cnblogs.com/lovebing/p/16263073.html)

#### 服务器提示 polkit pkexec 本地提权漏洞（CVE-2021-4034）

该漏洞 EXP 已公开传播，漏洞利用成本极低，建议您立即关注并修复。

如何修复呢？

![image-20220512163422865](img/df19c7dde9e72fe8e9ac5f1e77a73551.png)

###### 解决建议

1、无法升级软件修复包的，可使用以下命令删除 pkexec 的 SUID-bit 权限来规避漏洞风险：
chmod 0755 /usr/bin/pkexec

```
示例：
# ll /usr/bin/pkexec
-rwsr-xr-x 1 root root  /usr/bin/pkexec
# chmod 0755 /usr/bin/pkexec
# ll /usr/bin/pkexec
-rwxr-xr-x 1 root root  /usr/bin/pkexec
执行前权限一般为-rwsr-xr-x ，删除 SUID-bit 权限后一般为-rwxr-xr-x 
```

2、CentOS 7 的用户可通过 yum update polkit 升级修复（云安全中心 Linux 软件漏洞已支持检测修复），Centos 5、6、8 官方已终止生命周期 (EOL)维护，建议停止使用；

3、RedHat 用户建议联系红帽官方获取安全修复源后执行`yum update polkit`升级修复（云安全中心 Linux 软件漏洞已支持检测修复）；

4、Alibaba Cloud Linux 的用户可通过`yum update polkit`升级修复（云安全中心 Linux 软件漏洞已支持检测修复）；

5、Anolis OS（龙蜥）的用户可通过 yum update polkit 升级修复（云安全中心 Linux 软件漏洞已支持检测修复）；

6、Ubuntu 18.04 LTS、Ubuntu 20.04 LTS 的用户可通过 apt update policykit-1 升级修复，Ubuntu 14.04、16.04、12.04 官方已终止生命周期 (EOL)维护，修复需要额外付费购买 Ubuntu ESM（扩展安全维护）服务，建议停止使用；

7、其他 Linux 发行版操作系统 OS 建议联系官方寻求软件包修复源。

CentOS8 修复时提示：

```
CentOS-8 - AppStream 46 B/s | 38 B 00:00
Error: Failed to download metadata for repo 'AppStream': Cannot prepare internal mirrorlist: No URLs in mirrorlist 
```

#### 错误原因：

自 2022 年 1 月 31 日起，CentOS 团队从官方镜像中移除 CentOS 8 的所有包，但软件包仍在官方镜像上保留一段时间。现在被转移到 https://vault.centos.org。如需继续运行旧 CentOS 8，可以在/etc/yum.repos 中更新 repos.d，使用 vault.centos.org 代替 mirror.centos.org；

```
sudo sed -i 's/mirrorlist/#mirrorlist/g' /etc/yum.repos.d/CentOS-*
sudo sed -i 's|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g' /etc/yum.repos.d/CentOS-* 
```

文章来源：[刘俊涛的博客](http://www.cnblogs.com/lovebing) 欢迎关注公众号、留言、评论，一起学习。

* * *

若有帮助到您，欢迎捐赠支持，您的支持是对我坚持最好的肯定(*^_*)