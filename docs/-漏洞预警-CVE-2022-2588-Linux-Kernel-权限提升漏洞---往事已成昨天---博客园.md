# 【漏洞预警】CVE-2022-2588：Linux Kernel 权限提升漏洞 - 往事已成昨天 - 博客园

> 原文：[`www.cnblogs.com/cherishthepresent/p/16767382.html`](https://www.cnblogs.com/cherishthepresent/p/16767382.html)

# 【漏洞预警】CVE-2022-2588：Linux Kernel 权限提升漏洞

原创 yuanfan2012 WalkingCloud 2022-09-24 12:57 发表于浙江收录于合集#linux kernel1 个#linux5 个#网络安全 35 个#运维安全 25 个#Linux 学习笔记 279 个

【漏洞预警】CVE-2022-2588：Linux Kernel 权限提升漏洞(Dirtycred)

![图片](img/2df44d579167ef1a7ae520b53d418bde.png)

### 漏洞说明：

Linux kernel 是开源操作系统 Linux 所使用的内核。在 Linux 内核的 net/sched/cls_route.c 实现的 route4_change 中发现了一个存在 use-after-free 缺陷漏洞，该漏洞源于释放后重用，本地攻击者利用该漏洞会导致系统崩溃，可能会造成本地特权升级问题。

*   公开时间：2022/09/22

*   CVE 编号：CVE-2022-2588

*   漏洞类型：UAF

*   漏洞等级：高 

*   利用可能性：高 

*   攻击向量：- 

*   攻击成本：中 

*   影响范围：一般

*   有无 PoC/EXP：有

### 影响组件：

Linux_Kernel@2.6.12-rc2, 5.19)

![图片(图片点击放大查看)### 排查方式：获取 Linux_Kernel 版本，判断其版本在 2.6.12-rc2, 5.19)范围内### 修复方案：升级 Linux_Kernel 到 5.19 或更高版本### 参考链接：```https://www.oscs1024.com/hd/MPS-2022-52796https://seclists.org/oss-sec/2022/q3/132https://access.redhat.com/security/cve/cve-2022-2588https://ubuntu.com/security/CVE-2022-2588https://security-tracker.debian.org/tracker/CVE-2022-2588https://sensorstechforum.com/cve-2022-2588-linux-kernel/https://thehackernews.com/2022/08/as-nasty-as-dirty-pipe-8-year-old-linux.html ```![图片(图片点击放大查看)## POC 验证下面为在 CentOS8 下和 Ubuntu 22.04 LTS 下使用漏洞 PoC 工具进行普通用户提权到 root 的过程![图片](img/0436183baa4d3140795b97b4c32de27e.png)

(图片点击放大查看)

```
工具来源地址 https://github.com/Markakd/CVE-2022-2588 
```

## CentOS8 下 POC 验证测试

```
su  - yuanfan
chmod 755 exp_file_credential
./exp_file_credential
head -n5 /etc/passwd
su user
密码也为 user
id 
```

![图片](img/639b3db23559aaddbdb265723def02c6.png)

![图片](img/8a386f6676db146b2dad0d906429d8a9.png)

(图片点击放大查看)

## Ubuntu22.04 下 POC 验证测试

![图片](img/1bead01953c04ce3d89db868edc2e921.png)

(图片点击放大查看)

![图片](img/f70aa381243201a5b6787f3dea0641ba.png)

(图片点击放大查看)

* * *

**免责声明:**

请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。请遵守网络安全法。

![](img/1dd94c74e56a6839207f6f9811e94945.png)yuanfan2012

给小编加鸡腿！😂

![赞赏二维码](img/4b87c5492ec4aa09b8c45bc53ade752c.png)[喜欢作者](https://mp.weixin.qq.com/s?__biz=MzU2MjU1OTE0MA==&mid=2247496221&idx=1&sn=244dee477cce5c4135917f528cc29501&chksm=fc6513d6cb129ac0af88b22a65284bee95cc454f487a51f55f673e7d651a7bfa6576e23c8555&mpshare=1&scene=24&srcid=0924VmNyYKmYjYptFdKXUiCF&sharer_sharetime=1663996001736&sharer_shareid=eac23f5277a91604635a35bcf9bf3742&key=5259d4d79015e64447b4619be1c33a0f8d58a0c15f190cf572907d06baca9c9daba61a9ddd9796c5b20c6a2ef776aced01080bafdd6c55775df55dc435301b7aa52edacb5c608cff32bd48becf8efa4029361cccc6646f0d797b773606274ba874bce7ddd7ee2b189c82bc081ffc2297f8ccf42b7ae0d55f4b76b3d58af3d75f&ascene=14&uin=NDEyMzkyNjg%3D&devicetype=Windows+10+x64&version=63070517&lang=zh_CN&exportkey=AdUBDGpW8hl3Hi9IB%2FOLpsM%3D&acctmode=0&pass_ticket=vciHGBX%2FTTzPSTvkMfna4uEMVRh30gK0850EBUoC8ghhvkNnFmLG0h%2FhJctQWlkE&wx_header=0&fontgear=2##)

阅读 450