# ã€æ¼æ´é¢„è­¦ã€‘CVE-2022-2588ï¼šLinux Kernel æƒé™æå‡æ¼æ´ - å¾€äº‹å·²æˆæ˜¨å¤© - åšå®¢å›­

> åŸæ–‡ï¼š[`www.cnblogs.com/cherishthepresent/p/16767382.html`](https://www.cnblogs.com/cherishthepresent/p/16767382.html)

# ã€æ¼æ´é¢„è­¦ã€‘CVE-2022-2588ï¼šLinux Kernel æƒé™æå‡æ¼æ´

åŸåˆ›Â yuanfan2012Â WalkingCloudÂ 2022-09-24 12:57Â å‘è¡¨äºæµ™æ±Ÿæ”¶å½•äºåˆé›†#linux kernel1 ä¸ª#linux5 ä¸ª#ç½‘ç»œå®‰å…¨ 35 ä¸ª#è¿ç»´å®‰å…¨ 25 ä¸ª#Linux å­¦ä¹ ç¬”è®° 279 ä¸ª

ã€æ¼æ´é¢„è­¦ã€‘CVE-2022-2588ï¼šLinux Kernel æƒé™æå‡æ¼æ´(Dirtycred)

![å›¾ç‰‡](img/2df44d579167ef1a7ae520b53d418bde.png)

### æ¼æ´è¯´æ˜ï¼š

Linux kernel æ˜¯å¼€æºæ“ä½œç³»ç»Ÿ Linux æ‰€ä½¿ç”¨çš„å†…æ ¸ã€‚åœ¨ Linux å†…æ ¸çš„ net/sched/cls_route.c å®ç°çš„ route4_change ä¸­å‘ç°äº†ä¸€ä¸ªå­˜åœ¨ use-after-free ç¼ºé™·æ¼æ´ï¼Œè¯¥æ¼æ´æºäºé‡Šæ”¾åé‡ç”¨ï¼Œæœ¬åœ°æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒï¼Œå¯èƒ½ä¼šé€ æˆæœ¬åœ°ç‰¹æƒå‡çº§é—®é¢˜ã€‚

*   å…¬å¼€æ—¶é—´ï¼š2022/09/22

*   CVE ç¼–å·ï¼šCVE-2022-2588

*   æ¼æ´ç±»å‹ï¼šUAF

*   æ¼æ´ç­‰çº§ï¼šé«˜Â 

*   åˆ©ç”¨å¯èƒ½æ€§ï¼šé«˜Â 

*   æ”»å‡»å‘é‡ï¼š-Â 

*   æ”»å‡»æˆæœ¬ï¼šä¸­Â 

*   å½±å“èŒƒå›´ï¼šä¸€èˆ¬

*   æœ‰æ—  PoC/EXPï¼šæœ‰

### å½±å“ç»„ä»¶ï¼š

Linux_Kernel@2.6.12-rc2, 5.19)

![å›¾ç‰‡(å›¾ç‰‡ç‚¹å‡»æ”¾å¤§æŸ¥çœ‹)### æ’æŸ¥æ–¹å¼ï¼šè·å– Linux_Kernel ç‰ˆæœ¬ï¼Œåˆ¤æ–­å…¶ç‰ˆæœ¬åœ¨ 2.6.12-rc2, 5.19)èŒƒå›´å†…### ä¿®å¤æ–¹æ¡ˆï¼šå‡çº§ Linux_Kernel åˆ° 5.19 æˆ–æ›´é«˜ç‰ˆæœ¬### å‚è€ƒé“¾æ¥ï¼š```https://www.oscs1024.com/hd/MPS-2022-52796https://seclists.org/oss-sec/2022/q3/132https://access.redhat.com/security/cve/cve-2022-2588https://ubuntu.com/security/CVE-2022-2588https://security-tracker.debian.org/tracker/CVE-2022-2588https://sensorstechforum.com/cve-2022-2588-linux-kernel/https://thehackernews.com/2022/08/as-nasty-as-dirty-pipe-8-year-old-linux.html ```![å›¾ç‰‡(å›¾ç‰‡ç‚¹å‡»æ”¾å¤§æŸ¥çœ‹)## POC éªŒè¯ä¸‹é¢ä¸ºåœ¨ CentOS8 ä¸‹å’Œ Ubuntu 22.04 LTS ä¸‹ä½¿ç”¨æ¼æ´ PoC å·¥å…·è¿›è¡Œæ™®é€šç”¨æˆ·ææƒåˆ° root çš„è¿‡ç¨‹![å›¾ç‰‡](img/0436183baa4d3140795b97b4c32de27e.png)

(å›¾ç‰‡ç‚¹å‡»æ”¾å¤§æŸ¥çœ‹)

```
å·¥å…·æ¥æºåœ°å€ https://github.com/Markakd/CVE-2022-2588 
```

## CentOS8 ä¸‹ POC éªŒè¯æµ‹è¯•

```
suÂ Â -Â yuanfan
chmodÂ 755Â exp_file_credential
./exp_file_credential
headÂ -n5Â /etc/passwd
suÂ user
å¯†ç ä¹Ÿä¸º user
id 
```

![å›¾ç‰‡](img/639b3db23559aaddbdb265723def02c6.png)

![å›¾ç‰‡](img/8a386f6676db146b2dad0d906429d8a9.png)

(å›¾ç‰‡ç‚¹å‡»æ”¾å¤§æŸ¥çœ‹)

## Ubuntu22.04 ä¸‹ POC éªŒè¯æµ‹è¯•

![å›¾ç‰‡](img/1bead01953c04ce3d89db868edc2e921.png)

(å›¾ç‰‡ç‚¹å‡»æ”¾å¤§æŸ¥çœ‹)

![å›¾ç‰‡](img/f70aa381243201a5b6787f3dea0641ba.png)

(å›¾ç‰‡ç‚¹å‡»æ”¾å¤§æŸ¥çœ‹)

* * *

**å…è´£å£°æ˜:**

è¯·å‹¿åˆ©ç”¨æ–‡ç« å†…çš„ç›¸å…³æŠ€æœ¯ä»äº‹éæ³•æµ‹è¯•ï¼Œç”±äºä¼ æ’­ã€åˆ©ç”¨æ­¤æ–‡æ‰€æä¾›çš„ä¿¡æ¯è€Œé€ æˆçš„ä»»ä½•ç›´æ¥æˆ–è€…é—´æ¥çš„åæœåŠæŸå¤±ï¼Œå‡ç”±ä½¿ç”¨è€…æœ¬äººè´Ÿè´£ï¼Œä½œè€…ä¸ä¸ºæ­¤æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚è¯·éµå®ˆç½‘ç»œå®‰å…¨æ³•ã€‚

![](img/1dd94c74e56a6839207f6f9811e94945.png)yuanfan2012

ç»™å°ç¼–åŠ é¸¡è…¿ï¼ğŸ˜‚

![èµèµäºŒç»´ç ](img/4b87c5492ec4aa09b8c45bc53ade752c.png)[å–œæ¬¢ä½œè€…](https://mp.weixin.qq.com/s?__biz=MzU2MjU1OTE0MA==&mid=2247496221&idx=1&sn=244dee477cce5c4135917f528cc29501&chksm=fc6513d6cb129ac0af88b22a65284bee95cc454f487a51f55f673e7d651a7bfa6576e23c8555&mpshare=1&scene=24&srcid=0924VmNyYKmYjYptFdKXUiCF&sharer_sharetime=1663996001736&sharer_shareid=eac23f5277a91604635a35bcf9bf3742&key=5259d4d79015e64447b4619be1c33a0f8d58a0c15f190cf572907d06baca9c9daba61a9ddd9796c5b20c6a2ef776aced01080bafdd6c55775df55dc435301b7aa52edacb5c608cff32bd48becf8efa4029361cccc6646f0d797b773606274ba874bce7ddd7ee2b189c82bc081ffc2297f8ccf42b7ae0d55f4b76b3d58af3d75f&ascene=14&uin=NDEyMzkyNjg%3D&devicetype=Windows+10+x64&version=63070517&lang=zh_CN&exportkey=AdUBDGpW8hl3Hi9IB%2FOLpsM%3D&acctmode=0&pass_ticket=vciHGBX%2FTTzPSTvkMfna4uEMVRh30gK0850EBUoC8ghhvkNnFmLG0h%2FhJctQWlkE&wx_header=0&fontgear=2##)

é˜…è¯»Â 450