# Ubuntu 16.04 漏洞复现(CVE-2017-16995) - 小小小怪将军 - 博客园

> 原文：[`www.cnblogs.com/SeanGyy/p/15709712.html`](https://www.cnblogs.com/SeanGyy/p/15709712.html)

# 前言

　　Ubuntu 16.04 版本存在本地提权漏洞，该漏洞存在于 Linux 内核带有的 eBPF bpf(2)系统调用中，当用户提供恶意 BPF 程序使 eBPF 验证器模块产生计算错误，导致任意内存读写问题。 

　　攻击者（普通用户）可以利用该漏洞进行提权攻击，获取 root 权限，危害极大。

　　目前，主要是 Debian 和 Ubuntu 版本受影响，Redhat 和 CentOS 不受影响。

**　　影响版本： **

　　Linux 内核：Linux Kernel Version 4.4 ~ 4.14

　　Ubuntu 版本：16.04.01~ 16.04.04

　　靶场地址：[`www.mozhe.cn/bug/detail/T3ZEbFljRmFKQTVjVitoV2JxUzVoQT09bW96aGUmozhe`](https://www.mozhe.cn/bug/detail/T3ZEbFljRmFKQTVjVitoV2JxUzVoQT09bW96aGUmozhe)

# 正文

　　开启服务器后获得 ip 和 ssh 账户，使用 ssh 连接

　　查看基本信息

```
#查看⽤户⾝份 
whoami 
#查看内核信息 
uname -a 
#查看系统版本 
cat /etc/issue
```

![](img/070891bd360aff0f1ced1dd46de005ff.png)

 　　Ubuntu 16.04 版本的服务器，符合当前漏洞，在网上找了一下相关配置文件 upstream44.c 

　　百度网盘链接：[`pan.baidu.com/s/14PiB0cmAX5BQSiVSnXYTZQ`](https://pan.baidu.com/s/14PiB0cmAX5BQSiVSnXYTZQ)

　　提取码：vw3z

　　下载完成后使用 scp 命令将 upstream.c 传输到入侵目标

```
scp -P 40836 upstream44.c hack@ip:home/hack
```

![](img/ee639e4e14af0d31225254a0bca80e23.png)

 　　上传成功，再次登录服务器，进入 hack 目录

![](img/61b6d70c3ed50f6c1cf9f2f29f8bfd9c.png)

 　　使用 gcc 编译 upstream44.c

```
gcc upstream44.c -o upstream
```

　　给编译好的 upstream 赋权

```
chmod +x upstream
```

![](img/2a8bec3d309a9e5331c6f83812962713.png)

 　　运行

```
./upstream
```

![](img/2a716b1878f3a7680f2ce28eb33a5694.png)

 　　成功提升权限为 root

　　进入根目录，发现 key.txt

![](img/45e82b26cd132f37b32902ae80a9744d.png)

 　　查看 key

```
cat key.txt
```

![](img/30342d86f0907d0109d6f5fd7cbcc4c1.png)