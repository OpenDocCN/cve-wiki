# CVE-2017-0213 漏洞复现 - kalibb - 博客园

> 原文：[`www.cnblogs.com/lzkalislw/p/12817650.html`](https://www.cnblogs.com/lzkalislw/p/12817650.html)

### CVE-2017-0213 漏洞形成的原因

类型混淆的漏洞通常可以通过内存损坏的方式来进行利用.然而漏洞发现者在利用时，并未采用内存损坏的方式来进行漏洞利用。按照漏洞发现者的说法，内存损坏的利用方式需要对内存进行精心布局，即便如此 ，在 Windows 10 上也可能会触发 CFG(Control Flow Guard)。
漏洞发现者另辟其径，采用了一种基于 LoadTypeLibrary 来利用的方法。

大白话来说就是：Windows COM Aggregate Marshaler 在实现中存在权限提升漏洞，可使远程攻击者以提升的权限执行任意代码。

CVE-2017-0213 Windows COM 特权提升漏洞组件先看看这个漏洞的介绍：
[`www.voidcn.com/article/p-ukjxxpit-boa.html`](http://www.voidcn.com/article/p-ukjxxpit-boa.html)

漏洞影响的版本有：

![](img/5c760c7ffdef26ef630ef3236ae1aa89.png)image.png

漏洞利用工具下载地址：[`github.com/WindowsExploits/Exploits/tree/master/CVE-2017-0213`](https://github.com/WindowsExploits/Exploits/tree/master/CVE-2017-0213)

### 实验步骤

0x01 使用标准用户登陆 win7,下图是查看特权详细信息，并创建用户；

![](img/a89e6ec6ff9af5b2de86d47ae9d71b38.png)image.png

创建用户失败

0x02 双击运行桌面上的漏洞利用 exe 脚本，弹出下面对话框

![](img/d2cab7277beffa42e552b17097c82b25.png)image.png

创建用户成功，提升为 system 权限；