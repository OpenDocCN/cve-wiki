# MS14-064/CVE-2014-6332 漏洞复现（OLE 远程代码执行漏洞、IE 浏览器漏洞） - 冲田总司 cc - 博客园

> 原文：[`www.cnblogs.com/tsimfeiwan/p/11993640.html`](https://www.cnblogs.com/tsimfeiwan/p/11993640.html)

**漏洞介绍：**MS14-064 Microsoft Internet Explorer Windows OLE Automation Array Remote Code Execution，主要利用 IE 浏览器漏洞，Microsoft Windows OLE 远程代码执行漏洞，OLE（对象链接与嵌入）是一种允许应用程序共享数据和功能的技术，远程攻击者利用此漏洞通过构造的网站执行任意代码，用户使用 Internet Explorer 浏览器查看该网站的时允许远程执行代码。

**受影响产品：**Windows server 2003，Windows Vista，Windows server 2008，Windows server 2008 R2，Windows 7，Windows xp，Windows 8，Windows 8.1，Windows Server 2012，Windows server 2012 R2，Windows RT，Windows RT 8.1

**复现过程：**

环境：kali[192.168.86.132]+(win7+IE8)[192.168.86.130]

step1、启动 MSF，搜索 ms14-064 的漏洞信息

![](img/80808546f1f9e79ea64ecba538a5cdaa.png)

![](img/e76f1ccf002bc6a3ad6fd92b839d13cf.png)

利用第一个攻击模块：use exploit/windows/browser/ms14_064_ole_code_execution

设置载荷

 ![](img/7f9379d84c4c61de0d82161581c6560a.png)

 ![](img/e6b2782c9ae17a35d838a772ca046ecb.png)

查看需要设置的地方：show options

![](img/eae6bb151ad19ef53ecd5b8d13d07d3e.png)

 ![](img/ead455e1ea0e096d0d57ed80fd5e67f9.png)

设置好标记的地方（AllowPowershellPrompt  设置为 true，因为 msf 中自带的漏洞利用 exp 调用的是 powershell，所以 msf 中的 exp 代码只对安装 powershell 的系统生效，监听地址设置为自己的本地地址就 ok 了，然后 exploit 就会生成一个恶意网站了）

 ![](img/f790cc54ea0d67c80fbdb2f0bd0a6780.png)

 step2、用 IE 打开上面生成的恶意链接

![](img/9ed4506e85770e1b2581704349c43120.png)

 step3、返回 kali 中看，已经生成一个连接 session 了，那么我们就直接连接它，打开 shell

发现是乱码，我们可以设置一下编码格式

![](img/e68fe3c485d6588994318835c56930c1.png)

 ![](img/9e61a9a461d02d748da695cd9df7b72a.png)

在 win7 上可以看到文件夹存在

 ![](img/0926883afe3de612d7c3d4bcedab5ca9.png)

over！！！（这个是前几天复现的一个漏洞，做个过程笔记）