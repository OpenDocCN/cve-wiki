# CVE-2019-16278：Nostromo Web 服务器的远程命令执行 - Hydraxx - 博客园

> 原文：[`www.cnblogs.com/Hydraxx/p/12148341.html`](https://www.cnblogs.com/Hydraxx/p/12148341.html)

这个漏洞存在于[Nostromo web 服务](http://www.nazgul.ch/dev_nostromo.html)上（又名 nhttpd），这是一个开源的 web 服务，在 Unix 系统上非常流行，例如 FreeBSD, OpenBSD 等等。

Nostromo 由于在验证 URL 安全性方面存在[缺陷](https://www.owasp.org/index.php/Path_Traversal)，导致目录穿越，任何人都可以遍历系统中任何文件。因此未经过身份验证的远程攻击者可以强制服务器指向`/bin/sh`这样的 shell 文件，借此执行任意命令。在我测试时，Nostromo 的所有版本，包括最新的 1.9.6 版本，都存在漏洞。甚至它的开发者网站`[www.nazgul.ch](http://www.nazgul.ch)`也有。

在以前 Nostromo 也出现过目录穿越漏洞，最终也可导致远程命令代码，编号为`CVE-2011-0751`。漏洞原因在于当时的 web 服务在对 URL 进行检查的时机是在 URL 被解码前，因此攻击者只需将`/`转换为`%2f`就可绕过检查，最后 paylaod 如下：

```
/..%2f..%2f..%2fbin/sh 
```

## 利用

在 Shodan 上进行[搜索](https://www.shodan.io/search?query=%22Server%3A+nostromo%22)，你可以在公网上找到大约 2000 个 Nostromo web 服务：`"Server: nostromo"`

```
![](img/1bb73b8116bb1747e1bbd62d162bcfc8.png)
```

 `exp 地址：https://github.com/jas502n/CVE-2019-16278

利用：

![](img/0e52fdc76dc736cf88b45e126c4ddb8f.png)`