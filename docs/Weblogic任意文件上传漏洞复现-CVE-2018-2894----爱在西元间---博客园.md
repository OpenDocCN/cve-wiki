# Weblogic 任意文件上传漏洞复现（CVE-2018-2894） - 爱在西元间 - 博客园

> 原文：[`www.cnblogs.com/jasy/p/17306310.html`](https://www.cnblogs.com/jasy/p/17306310.html)

影响版本：weblogic 10.3.6.0、weblogic 12.1.3.0、weblogic 12.2.1.2、weblogic 12.2.1.3

### 1、搭建靶场

这里是下载所有漏洞靶场`git clone https://github.com/vulhub/vulhub.git`
进入`/vulhub/weblogic/CVE-2018-2894`目录后
启动靶场`docker-compose up -d`

### 2、获取口令

执行下面命令查看管理员账号和口令（随机生成）
`docker-compose logs | grep password`
用户名 weblogic，口令 hRJt5Yis
![image](img/61d97e77a961f2cdf5e46f7a89fb6873.png)

![image](img/73219b8538856b41385b6926b9e1a6bd.png)
使用前面找到的账号口令登录
![image](img/ba15ed99466a6091c93cf0420c6e42d5.png)

### 3、配置 weblogic 并上传木马

找到“启用 web 服务测试页”并勾选拖到下面保存（这里如果一点保存就退到登录页面可能是浏览器问题 chrome 的会退，换浏览器试试火狐没事）
![image](img/21d5b956acb6e9aee3e54a0623eabd76.png)
![image](img/cb09a1605ef53a7d72b2d45533e20ee9.png)
访问：http://***:7001/ws_utc/config.do，将 Work Home Dir: 修改为：/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css 并提交
（将 work home dir 设置为 ws_utc 应用的静态文件 css 目录，访问这个目录是无需权限的）
![image](img/34a66f21ab375ff2d33efb12e317f790.png)
在“安全”-“添加”里上传木马并提交，提交后右键-检查，找到 id 后面的时间戳，后面有用
![image](img/fc22f9d9dfbad10dc3e54700f55d330b.png)
![image](img/20fa720bd9736abe5bfddd39ce4a13d6.png)

### 4、测试木马

访问 http://*:7001/ws_utc/css/config/keystore/1681223026331_shell.jsp 无返回就成功了
![image](img/1139da6b246b4d63045b449dd33cbd51.png)

用冰蝎连接就可以了
![image](img/528b5c5d38fdc702efc50f524369f625.png)
登录的用户是 oracle
![image](img/6227c4a793b1c45a43518c0abb45def2.png)

用 AWVS 扫描也能扫出这个漏洞！！
![image](img/c183f0b5f0ae452337099dd821194041.png)
![image](img/e2ac3cbd5956f9b02aa93b1383b1777e.png)

参考：
[Weblogic 任意文件上传漏洞（CVE-2018-2894）复现 _ 浅浅爱默默的博客-CSDN 博客](https://blog.csdn.net/weixin_43625577/article/details/97001677 "Weblogic 任意文件上传漏洞（CVE-2018-2894）复现 _ 浅浅爱默默的博客-CSDN 博客")