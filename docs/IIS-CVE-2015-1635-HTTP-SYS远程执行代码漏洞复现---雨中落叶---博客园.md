# IIS_CVE-2015-1635-HTTP.SYS 远程执行代码漏洞复现 - 雨中落叶 - 博客园

> 原文：[`www.cnblogs.com/yuzly/p/10891629.html`](https://www.cnblogs.com/yuzly/p/10891629.html)

CVE-2015-1635-HTTP.SYS 远程执行代码漏洞复现

**一、漏洞描述**

远程执行代码漏洞存在于 HTTP 协议堆栈 (HTTP.sys) 中，当 HTTP.sys 未正确分析经特殊设计的 HTTP 请求时会导致此漏洞。 成功利用此漏洞的攻击者可以在系统帐户的上下文中执行任意代码。

微软官方说明:https://docs.microsoft.com/zh-cn/security-updates/Securitybulletins/2015/ms15-034

**二、影响版本**

Windows 7、Windows Server 2008 R2、Windows 8、Windows Server 2012、Windows 8.1 和 Windows Server 2012 R2

**三、漏洞利用条件**

安装了 IIS6.0 以上的 Windows 7、Windows Server 2008 R2、Windows 8、Windows Server 2012、Windows 8.1 和 Windows Server 2012 R2 版本

**四、  漏洞复现环境搭建**

1.  windows 2008 R2 安装 IIS 服务
2.  burp suit
3.  kali

**五、  漏洞复现**

1.测试 IIS 服务是否搭建成功

　　![](img/3c1ccbcb72742a9f6e4a2c15a0428362.png)

2.burp 抓包测试 http.sys 是否存在漏洞, 当出现 Requested Range Not Satisfiable 时说明存在漏洞

　　![](img/8f7e193d4d02eb6d5bb82c643cd552a1.png)

3.利用 ms15-034 漏洞读取服务器内存数据

　　![](img/52f3b28dd9b03521bfd1ab3a350846c2.png)

4.利用 ms15-034 漏洞进行 ddos 攻击

　　![](img/9c005bb07d7b24ba78de1489a188cfa0.png)

5.攻击开始后，目标瞬间蓝屏然后自动重启

　　![](img/601834c553da0430c532aff269bb4df9.png)

**六、漏洞修复**

禁用 IIS 内核缓存（可能降低 IIS 性能）,此时再次测试,无法造成目标蓝屏

　　![](img/6eeeebabd1eae7459f0e4cf6971087fe.png)

　　![](img/d86408ff87addfa805afe77b974e2d5b.png)

-------------------------------------------------------------------------------------

http.sys 概念参考资料:https://baike.baidu.com/item/http.sys/4749540?fr=aladdin