# [漏洞复现] CVE-2019-11043 PHP-FPM RCE - mark-zh - 博客园

> 原文：[`www.cnblogs.com/mark-zh/p/11732766.html`](https://www.cnblogs.com/mark-zh/p/11732766.html)

### 漏洞详情

PHP-FPM(PHP FastCGI Process Manager)：PHP FastCGI 进程管理器。php-fastcgi 用于解析 php 请求，php-fpm 管理 php-fastcgi。

**利用前提**

当 Nginx + PHP-FPM 的环境存在以下配置，可导致 RCE。

```
location ~ [^/]\.php(/|$) {
  ...
  fastcgi_split_path_info ^(.+?\.php)(/.*)$;
  fastcgi_param PATH_INFO       $fastcgi_path_info;
  fastcgi_pass   php:9000;
  ...
} 
```

### 漏洞复现

![](img/eddc5af14c6283643d5f9986716af45a.png)

![](img/2d03b7696ec41da7e56d0aa912df9130.png)

**参考**

[`github.com/neex/phuip-fpizdam/`](https://github.com/neex/phuip-fpizdam/)
[`github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043`](https://github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043)