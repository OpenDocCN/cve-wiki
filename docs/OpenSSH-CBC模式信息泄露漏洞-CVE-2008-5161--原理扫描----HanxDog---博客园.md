# OpenSSH CBC 模式信息泄露漏洞(CVE-2008-5161)【原理扫描】 - HanxDog - 博客园

> 原文：[`www.cnblogs.com/xinj/p/15787646.html`](https://www.cnblogs.com/xinj/p/15787646.html)

处理：使用 man sshd_config 查看 Ciphers 项可以看到 sshd 支持的算法（如下图所示）

 ![](img/67456615414ad14c3dd3f40fc8d2172a.png)

处理办法是在 sshd_config 中配置 Ciphers 项，添加以下配置，然后重启 sshd 即可。

# vim /etc/ssh/sshd_config

Ciphers aes128-ctr,aes192-ctr,aes256-ctr,arcfour256,arcfour128,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,arcfour

 ![](img/2f16d8e0bb660f638d4aa94a90f6e535.png)

使用 SSH 针对 CBC 分组类型的加密算法进行检查，若最后出现如图的内容，则证明成功

#ssh -vv -oCiphers=aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,aes192-cbc,aes256-cbc 127.0.0.1

![](img/00d51d0350b94c18c8f0da9eeb2c2409.png)